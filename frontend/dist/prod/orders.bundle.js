webpackJsonp([6],[function(e,t,n){e.exports=n(174)},,function(e,t){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var s=n(23),a=r(s);t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,a.default)(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()},,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports={default:n(25),__esModule:!0}},,function(e,t,n){n(31);var r=n(4).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},,,,,,function(e,t,n){var r=n(9);r(r.S+r.F*!n(8),"Object",{defineProperty:n(11).f})},,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=s(t),this.reject=s(n)}var s=n(36);e.exports.f=function(e){return new r(e)}},,,,,,,,,,,,,,,,,,function(e,t,n){var r;(function(e,s){(function(){function a(e,t){return e.set(t[0],t[1]),e}function i(e,t){return e.add(t),e}function o(e,t,n){var r=n?n.length:0;switch(r){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function l(e,t){for(var n=-1,r=e.length,s=-1,a=t.length,i=Array(r+a);++n<r;)i[n]=e[n];for(;++s<a;)i[n++]=t[s];return i}function d(e,t){for(var n=-1,r=e.length;++n<r&&t(e[n],n,e)!==!1;);return e}function c(e,t){for(var n=e.length;n--&&t(e[n],n,e)!==!1;);return e}function u(e,t){for(var n=-1,r=e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function m(e,t){for(var n=-1,r=e.length,s=-1,a=[];++n<r;){var i=e[n];t(i,n,e)&&(a[++s]=i)}return a}function p(e,t){return!!e.length&&S(e,t,0)>-1}function f(e,t,n){for(var r=-1,s=e.length;++r<s;)if(n(t,e[r]))return!0;return!1}function _(e,t){for(var n=-1,r=e.length,s=Array(r);++n<r;)s[n]=t(e[n],n,e);return s}function v(e,t){for(var n=-1,r=t.length,s=e.length;++n<r;)e[s+n]=t[n];return e}function g(e,t,n,r){var s=-1,a=e.length;for(r&&a&&(n=e[++s]);++s<a;)n=t(n,e[s],s,e);return n}function h(e,t,n,r){var s=e.length;for(r&&s&&(n=e[--s]);s--;)n=t(n,e[s],s,e);return n}function b(e,t){for(var n=-1,r=e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function y(e,t,n){for(var r=-1,s=e.length;++r<s;){var a=e[r],i=t(a);if(null!=i&&(o===K?i===i:n(i,o)))var o=i,l=a}return l}function w(e,t,n,r){var s;return n(e,function(e,n,a){if(t(e,n,a))return s=r?n:e,!1}),s}function C(e,t,n){for(var r=e.length,s=n?r:-1;n?s--:++s<r;)if(t(e[s],s,e))return s;return-1}function S(e,t,n){if(t!==t)return N(e,n);for(var r=n-1,s=e.length;++r<s;)if(e[r]===t)return r;return-1}function O(e,t,n,r,s){return s(e,function(e,s,a){n=r?(r=!1,e):t(n,e,s,a)}),n}function k(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function D(e,t){for(var n,r=-1,s=e.length;++r<s;){var a=t(e[r]);a!==K&&(n=n===K?a:n+a)}return n}function E(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function x(e,t){return _(t,function(t){return[t,e[t]]})}function A(e){return function(t){return e(t)}}function q(e,t){return _(t,function(t){return e[t]})}function T(e,t){for(var n=-1,r=e.length;++n<r&&S(t,e[n],0)>-1;);return n}function R(e,t){for(var n=e.length;n--&&S(t,e[n],0)>-1;);return n}function $(e){return e&&e.Object===Object?e:null}function P(e,t){if(e!==t){var n=null===e,r=e===K,s=e===e,a=null===t,i=t===K,o=t===t;if(e>t&&!a||!s||n&&!i&&o||r&&o)return 1;if(e<t&&!n||!o||a&&!r&&s||i&&s)return-1}return 0}function j(e,t,n){for(var r=-1,s=e.criteria,a=t.criteria,i=s.length,o=n.length;++r<i;){var l=P(s[r],a[r]);if(l){if(r>=o)return l;var d=n[r];return l*("desc"==d?-1:1)}}return e.index-t.index}function I(e){return yn[e]}function M(e){return wn[e]}function F(e){return"\\"+On[e]}function N(e,t,n){for(var r=e.length,s=t+(n?0:-1);n?s--:++s<r;){var a=e[s];if(a!==a)return s}return-1}function L(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function U(e,t){return e="number"==typeof e||kt.test(e)?+e:-1,t=null==t?we:t,e>-1&&e%1==0&&e<t}function W(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}function B(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function z(e,t){for(var n=-1,r=e.length,s=-1,a=[];++n<r;)e[n]===t&&(e[n]=Ee,a[++s]=n);return a}function H(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function Q(e){if(!e||!mn.test(e))return e.length;for(var t=un.lastIndex=0;un.test(e);)t++;return t}function V(e){return e.match(un)}function Y(e){return Cn[e]}function G(e){function t(e){if(Ci(e)&&!ec(e)&&!(e instanceof s)){if(e instanceof r)return e;if(kl.call(e,"__wrapped__"))return ws(e)}return new r(e)}function n(){}function r(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=K}function s(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Oe,this.__views__=[]}function $(){var e=new s(this.__wrapped__);return e.__actions__=Dr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Dr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Dr(this.__views__),e}function We(){if(this.__filtered__){var e=new s(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function kt(){var e=this.__wrapped__.value(),t=this.__dir__,n=ec(e),r=t<0,s=n?e.length:0,a=ns(0,s,this.__views__),i=a.start,o=a.end,l=o-i,d=r?o:i-1,c=this.__iteratees__,u=c.length,m=0,p=Yl(l,this.__takeCount__);if(!n||s<fe||s==l&&p==l)return vr(e,this.__actions__);var f=[];e:for(;l--&&m<p;){d+=t;for(var _=-1,v=e[d];++_<u;){var g=c[_],h=g.iteratee,b=g.type,y=h(v);if(b==ve)v=y;else if(!y){if(b==_e)continue e;break e}}f[m++]=v}return f}function At(){}function qt(e,t){return Rt(e,t)&&delete e[t]}function Tt(e,t){if(td){var n=e[t];return n===be?K:n}return kl.call(e,t)?e[t]:K}function Rt(e,t){return td?e[t]!==K:kl.call(e,t)}function $t(e,t,n){e[t]=td&&n===K?be:n}function Pt(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function jt(){this.__data__={hash:new At,map:Zl?new Zl:[],string:new At}}function It(e){var t=this.__data__;return cs(e)?qt("string"==typeof e?t.string:t.hash,e):Zl?t.map.delete(e):Gt(t.map,e)}function Mt(e){var t=this.__data__;return cs(e)?Tt("string"==typeof e?t.string:t.hash,e):Zl?t.map.get(e):Kt(t.map,e)}function Ft(e){var t=this.__data__;return cs(e)?Rt("string"==typeof e?t.string:t.hash,e):Zl?t.map.has(e):Jt(t.map,e)}function Nt(e,t){var n=this.__data__;return cs(e)?$t("string"==typeof e?n.string:n.hash,e,t):Zl?n.map.set(e,t):Xt(n.map,e,t),this}function Lt(e){var t=-1,n=e?e.length:0;for(this.__data__=new Pt;++t<n;)this.push(e[t])}function Ut(e,t){var n=e.__data__;if(cs(t)){var r=n.__data__,s="string"==typeof t?r.string:r.hash;return s[t]===be}return n.has(t)}function Wt(e){var t=this.__data__;if(cs(e)){var n=t.__data__,r="string"==typeof e?n.string:n.hash;r[e]=be}else t.set(e,be)}function Bt(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function zt(){this.__data__={array:[],map:null}}function Ht(e){var t=this.__data__,n=t.array;return n?Gt(n,e):t.map.delete(e)}function Qt(e){var t=this.__data__,n=t.array;return n?Kt(n,e):t.map.get(e)}function Vt(e){var t=this.__data__,n=t.array;return n?Jt(n,e):t.map.has(e)}function Yt(e,t){var n=this.__data__,r=n.array;r&&(r.length<fe-1?Xt(r,e,t):(n.array=null,n.map=new Pt(r)));var s=n.map;return s&&s.set(e,t),this}function Gt(e,t){var n=Zt(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():Ul.call(e,n,1),!0}function Kt(e,t){var n=Zt(e,t);return n<0?K:e[n][1]}function Jt(e,t){return Zt(e,t)>-1}function Zt(e,t){for(var n=e.length;n--;)if(si(e[n][0],t))return n;return-1}function Xt(e,t,n){var r=Zt(e,t);r<0?e.push([t,n]):e[r][1]=n}function en(e,t,n,r){return e===K||si(e,Sl[n])&&!kl.call(r,n)?t:e}function tn(e,t,n){(n===K||si(e[t],n))&&("number"!=typeof t||n!==K||t in e)||(e[t]=n)}function nn(e,t,n){var r=e[t];si(r,n)&&(!si(r,Sl[t])||kl.call(e,t))&&(n!==K||t in e)||(e[t]=n)}function rn(e,t){return e&&Er(t,ao(t),e)}function sn(e,t){for(var n=-1,r=null==e,s=t.length,a=Array(s);++n<s;)a[n]=r?K:to(e,t[n]);return a}function an(e,t,n){return e===e&&(n!==K&&(e=e<=n?e:n),t!==K&&(e=e>=t?e:t)),e}function on(e,t,n,r,s,a){var i;if(n&&(i=s?n(e,r,s,a):n(e)),i!==K)return i;if(!wi(e))return e;var o=ec(e);if(o){if(i=ss(e),!t)return Dr(e,i)}else{var l=ts(e),c=l==$e||l==Pe;if(l!=Me&&l!=xe&&(!c||s))return bn[l]?is(e,l,t):s?e:{};if(L(e))return s?e:{};if(i=as(c?{}:e),!t)return Ar(e,rn(i,e))}a||(a=new Bt);var u=a.get(e);return u?u:(a.set(e,i),(o?d:En)(e,function(r,s){nn(i,s,on(r,t,n,s,e,a))}),o?i:Ar(e,i))}function ln(e){var t=ao(e),n=t.length;return function(r){if(null==r)return!n;for(var s=n;s--;){var a=t[s],i=e[a],o=r[a];if(o===K&&!(a in Object(r))||!i(o))return!1}return!0}}function dn(e,t,n){if("function"!=typeof e)throw new wl(he);return Ll(function(){e.apply(K,n)},t)}function un(e,t,n,r){var s=-1,a=p,i=!0,o=e.length,l=[],d=t.length;if(!o)return l;n&&(t=_(t,A(n))),r?(a=f,i=!1):t.length>=fe&&(a=Ut,i=!1,t=new Lt(t));e:for(;++s<o;){var c=e[s],u=n?n(c):c;if(i&&u===u){for(var m=d;m--;)if(t[m]===u)continue e;l.push(c)}else a(t,u,r)||l.push(c)}return l}function yn(e,t){var n=!0;return cd(e,function(e,r,s){return n=!!t(e,r,s)}),n}function wn(e,t,n,r){var s=e.length;for(n=Li(n),n<0&&(n=-n>s?0:s+n),r=r===K||r>s?s:Li(r),r<0&&(r+=s),r=n>r?0:Ui(r);n<r;)e[n++]=t;return e}function Cn(e,t){var n=[];return cd(e,function(e,r,s){t(e,r,s)&&n.push(e)}),n}function Sn(e,t,n,r){r||(r=[]);for(var s=-1,a=e.length;++s<a;){var i=e[s];di(i)&&(n||ec(i)||oi(i))?t?Sn(i,t,n,r):v(r,i):n||(r[r.length]=i)}return r}function On(e,t){return null==e?e:md(e,t,io)}function En(e,t){return e&&md(e,t,ao)}function xn(e,t){return e&&pd(e,t,ao)}function An(e,t){return m(t,function(t){return hi(e[t])})}function qn(e,t){t=ds(t,e)?[t+""]:mr(t);for(var n=0,r=t.length;null!=e&&n<r;)e=e[t[n++]];return n&&n==r?e:K}function Tn(e,t){return kl.call(e,t)||"object"==typeof e&&t in e&&null===Il(e)}function Rn(e,t){return t in Object(e)}function jn(e,t,n){return e>=Yl(t,n)&&e<Vl(t,n)}function In(e,t,n){for(var r=n?f:p,s=e.length,a=s,i=Array(s),o=[];a--;){var l=e[a];a&&t&&(l=_(l,A(t))),i[a]=!n&&(t||l.length>=120)?new Lt(a&&l):K}l=e[0];var d=-1,c=l.length,u=i[0];e:for(;++d<c;){var m=l[d],v=t?t(m):m;if(!(u?Ut(u,v):r(o,v,n))){for(var a=s;--a;){var g=i[a];if(!(g?Ut(g,v):r(e[a],v,n)))continue e}u&&u.push(v),o.push(m)}}return o}function Mn(e,t,n){ds(t,e)||(t=mr(t),e=vs(e,t),t=Ns(t));var r=null==e?e:e[t];return null==r?K:o(r,e,n)}function Fn(e,t,n,r,s){return e===t||(null==e||null==t||!wi(e)&&!Ci(t)?e!==e&&t!==t:Nn(e,t,Fn,n,r,s))}function Nn(e,t,n,r,s,a){var i=ec(e),o=ec(t),l=Ae,d=Ae;i||(l=ts(e),l==xe?l=Me:l!=Me&&(i=ji(e))),o||(d=ts(t),d==xe?d=Me:d!=Me&&(o=ji(t)));var c=l==Me&&!L(e),u=d==Me&&!L(t),m=l==d;if(m&&!i&&!c)return Gr(e,t,l,n,r,s);var p=s&de;if(!p){var f=c&&kl.call(e,"__wrapped__"),_=u&&kl.call(t,"__wrapped__");if(f||_)return n(f?e.value():e,_?t.value():t,r,s,a)}return!!m&&(a||(a=new Bt),(i?Yr:Kr)(e,t,n,r,s,a))}function Ln(e,t,n,r){var s=n.length,a=s,i=!r;if(null==e)return!a;for(e=Object(e);s--;){var o=n[s];if(i&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++s<a;){o=n[s];var l=o[0],d=e[l],c=o[1];if(i&&o[2]){if(d===K&&!(l in e))return!1}else{var u=new Bt,m=r?r(d,c,l,e,t,u):K;if(!(m===K?Fn(c,d,r,le|de,u):m))return!1}}return!0}function Un(e){var t=typeof e;return"function"==t?e:null==e?Go:"object"==t?ec(e)?Qn(e[0],e[1]):Hn(e):rl(e)}function Wn(e){return Ql(Object(e))}function Bn(e){e=null==e?e:Object(e);var t=[];for(var n in e)t.push(n);return t}function zn(e,t){var n=-1,r=li(e)?Array(e.length):[];return cd(e,function(e,s,a){r[++n]=t(e,s,a)}),r}function Hn(e){var t=Xr(e);if(1==t.length&&t[0][2]){var n=t[0][0],r=t[0][1];return function(e){return null!=e&&(e[n]===r&&(r!==K||n in Object(e)))}}return function(n){return n===e||Ln(n,e,t)}}function Qn(e,t){return function(n){var r=to(n,e);return r===K&&r===t?ro(n,e):Fn(t,r,K,le|de)}}function Vn(e,t,n,r,s){if(e!==t){var a=ec(t)||ji(t)?K:io(t);d(a||t,function(i,o){if(a&&(o=i,i=t[o]),wi(i))s||(s=new Bt),Yn(e,t,o,n,Vn,r,s);else{var l=r?r(e[o],i,o+"",e,t,s):K;l===K&&(l=i),tn(e,o,l)}})}}function Yn(e,t,n,r,s,a,i){var o=e[n],l=t[n],d=i.get(l)||i.get(o);if(d)return void tn(e,n,d);var c=a?a(o,l,n+"",e,t,i):K,u=c===K;u&&(c=l,ec(l)||ji(l)?c=ec(o)?r?Dr(o):o:di(o)?Dr(o):on(l):qi(l)||oi(l)?c=oi(o)?Bi(o):!wi(o)||r&&hi(o)?on(l):r?on(o):o:u=!1),i.set(l,c),u&&s(c,l,r,a,i),tn(e,n,c)}function Gn(e,t,n){var r=-1,s=Zr();t=_(t.length?t:Array(1),function(e){return s(e)});var a=zn(e,function(e,n,s){var a=_(t,function(t){return t(e)});return{criteria:a,index:++r,value:e}});return k(a,function(e,t){return j(e,t,n)})}function Kn(e,t){return e=Object(e),g(t,function(t,n){return n in e&&(t[n]=e[n]),t},{})}function Jn(e,t){var n={};return On(e,function(e,r){t(e,r)&&(n[r]=e)}),n}function Zn(e){return function(t){return null==t?K:t[e]}}function Xn(e){return function(t){return qn(t,e)}}function er(e,t){return tr(e,t)}function tr(e,t,n){var r=-1,s=t.length,a=e;for(n&&(a=_(e,function(e){return n(e)}));++r<s;)for(var i=0,o=t[r],l=n?n(o):o;(i=S(a,l,i))>-1;)a!==e&&Ul.call(a,i,1),Ul.call(e,i,1);return e}function nr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var s=t[n];if(r==n||s!=a){var a=s;if(U(s))Ul.call(e,s,1);else if(ds(s,e))delete e[s];else{var i=mr(s),o=vs(e,i);null!=o&&delete o[Ns(i)]}}}return e}function rr(e,t){return e+Bl(Kl()*(t-e+1))}function sr(e,t,n,r){for(var s=-1,a=Vl(Wl((t-e)/(n||1)),0),i=Array(a);a--;)i[r?a:++s]=e,e+=n;return i}function ar(e,t,n,r){t=ds(t,e)?[t+""]:mr(t);for(var s=-1,a=t.length,i=a-1,o=e;null!=o&&++s<a;){var l=t[s];if(wi(o)){var d=n;if(s!=i){var c=o[l];d=r?r(c,l,o):K,d===K&&(d=null==c?U(t[s+1])?[]:{}:c)}nn(o,l,d)}o=o[l]}return e}function ir(e,t,n){var r=-1,s=e.length;t<0&&(t=-t>s?0:s+t),n=n>s?s:n,n<0&&(n+=s),s=t>n?0:n-t>>>0,t>>>=0;for(var a=Array(s);++r<s;)a[r]=e[r+t];return a}function or(e,t){var n;return cd(e,function(e,r,s){return n=t(e,r,s),!n}),!!n}function lr(e,t,n){var r=0,s=e?e.length:r;if("number"==typeof t&&t===t&&s<=De){for(;r<s;){var a=r+s>>>1,i=e[a];(n?i<=t:i<t)&&null!==i?r=a+1:s=a}return s}return dr(e,t,Go,n)}function dr(e,t,n,r){t=n(t);for(var s=0,a=e?e.length:0,i=t!==t,o=null===t,l=t===K;s<a;){var d=Bl((s+a)/2),c=n(e[d]),u=c!==K,m=c===c;if(i)var p=m||r;else p=o?m&&u&&(r||null!=c):l?m&&(r||u):null!=c&&(r?c<=t:c<t);p?s=d+1:a=d}return Yl(a,ke)}function cr(e){return ur(e)}function ur(e,t){for(var n=0,r=e.length,s=e[0],a=t?t(s):s,i=a,o=0,l=[s];++n<r;)s=e[n],a=t?t(s):s,si(a,i)||(i=a,l[++o]=s);return l}function mr(e){return ec(e)?e:hs(e)}function pr(e,t,n){var r=-1,s=p,a=e.length,i=!0,o=[],l=o;if(n)i=!1,s=f;else if(a>=fe){var d=t?null:_d(e);if(d)return H(d);i=!1,s=Ut,l=new Lt}else l=t?[]:o;e:for(;++r<a;){var c=e[r],u=t?t(c):c;if(i&&u===u){for(var m=l.length;m--;)if(l[m]===u)continue e;t&&l.push(u),o.push(c)}else s(l,u,n)||(l!==o&&l.push(u),o.push(c))}return o}function fr(e,t){t=ds(t,e)?[t+""]:mr(t),e=vs(e,t);var n=Ns(t);return null==e||!no(e,n)||delete e[n]}function _r(e,t,n,r){for(var s=e.length,a=r?s:-1;(r?a--:++a<s)&&t(e[a],a,e););return n?ir(e,r?0:a,r?a+1:s):ir(e,r?a+1:0,r?s:a)}function vr(e,t){var n=e;return n instanceof s&&(n=n.value()),g(t,function(e,t){return t.func.apply(t.thisArg,v([e],t.args))},n)}function gr(e,t,n){for(var r=-1,s=e.length;++r<s;)var a=a?v(un(a,e[r],t,n),un(e[r],a,t,n)):e[r];return a&&a.length?pr(a,t,n):[]}function hr(e){var t=e.constructor,n=new t(e.byteLength),r=new $l(n);return r.set(new $l(e)),n}function br(e){var t=e.constructor;return g(B(e),a,new t)}function yr(e){var t=e.constructor,n=new t(e.source,bt.exec(e));return n.lastIndex=e.lastIndex,n}function wr(e){var t=e.constructor;return g(H(e),i,new t)}function Cr(e){return Rl?Object(id.call(e)):{}}function Sr(e,t){var n=e.buffer,r=e.constructor;return new r(t?hr(n):n,e.byteOffset,e.length)}function Or(e,t,n){for(var r=n.length,s=-1,a=Vl(e.length-r,0),i=-1,o=t.length,l=Array(o+a);++i<o;)l[i]=t[i];for(;++s<r;)l[n[s]]=e[s];for(;a--;)l[i++]=e[s++];return l}function kr(e,t,n){for(var r=-1,s=n.length,a=-1,i=Vl(e.length-s,0),o=-1,l=t.length,d=Array(i+l);++a<i;)d[a]=e[a];for(var c=a;++o<l;)d[c+o]=t[o];for(;++r<s;)d[c+n[r]]=e[a++];return d}function Dr(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}function Er(e,t,n){return xr(e,t,n)}function xr(e,t,n,r){n||(n={});for(var s=-1,a=t.length;++s<a;){var i=t[s],o=r?r(n[i],e[i],i,n,e):e[i];nn(n,i,o)}return n}function Ar(e,t){return Er(e,hd(e),t)}function qr(e,t){return function(n,r){var s=t?t():{};if(r=Zr(r),ec(n))for(var a=-1,i=n.length;++a<i;){var o=n[a];e(s,o,r(o),n)}else cd(n,function(t,n,a){e(s,t,r(t),a)});return s}}function Tr(e){return Ga(function(t,n){var r=-1,s=n.length,a=s>1?n[s-1]:K,i=s>2?n[2]:K;for(a="function"==typeof a?(s--,a):K,i&&ls(n[0],n[1],i)&&(a=s<3?K:a,s=1),t=Object(t);++r<s;){var o=n[r];o&&e(t,o,r,a)}return t})}function Rr(e,t){return function(n,r){if(null==n)return n;if(!li(n))return e(n,r);for(var s=n.length,a=t?s:-1,i=Object(n);(t?a--:++a<s)&&r(i[a],a,i)!==!1;);return n}}function $r(e){return function(t,n,r){for(var s=-1,a=Object(t),i=r(t),o=i.length;o--;){var l=i[e?o:++s];if(n(a[l],l,a)===!1)break}return t}}function Pr(e,t,n){function r(){var t=this&&this!==$n&&this instanceof r?a:e;return t.apply(s?n:this,arguments)}var s=t&Z,a=Mr(e);return r}function jr(e){return function(t){t=Hi(t);var n=mn.test(t)?V(t):K,r=n?n[0]:t.charAt(0),s=n?n.slice(1).join(""):t.slice(1);return r[e]()+s}}function Ir(e){return function(t){return g(Ho(ko(t)),e,"")}}function Mr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=dd(e.prototype),r=e.apply(n,t);return wi(r)?r:n}}function Fr(e,t,n){function r(){for(var a=arguments.length,i=a,l=Array(a),d=this&&this!==$n&&this instanceof r?s:e,c=r.placeholder;i--;)l[i]=arguments[i];var u=a<3&&l[0]!==c&&l[a-1]!==c?[]:z(l,c);return a-=u.length,a<n?Hr(e,t,Lr,c,K,l,u,K,K,n-a):o(d,this,l)}var s=Mr(e);return r}function Nr(e){return Ga(function(t){t=Sn(t);var n=t.length,s=n,a=r.prototype.thru;for(e&&t.reverse();s--;){var i=t[s];if("function"!=typeof i)throw new wl(he);if(a&&!o&&"wrapper"==Jr(i))var o=new r([],!0)}for(s=o?s:n;++s<n;){i=t[s];var l=Jr(i),d="wrapper"==l?vd(i):K;o=d&&us(d[0])&&d[1]==(ae|te|re|ie)&&!d[4].length&&1==d[9]?o[Jr(d[0])].apply(o,d[3]):1==i.length&&us(i)?o[l]():o.thru(i)}return function(){var e=arguments,r=e[0];if(o&&1==e.length&&ec(r)&&r.length>=fe)return o.plant(r).value();for(var s=0,a=n?t[s].apply(this,e):r;++s<n;)a=t[s].call(this,a);return a}})}function Lr(e,t,n,r,s,a,i,o,l,d){function c(){for(var h=arguments.length,b=h,y=Array(h);b--;)y[b]=arguments[b];if(r&&(y=Or(y,r,s)),a&&(y=kr(y,a,i)),f||_){var w=c.placeholder,C=z(y,w);if(h-=C.length,h<d)return Hr(e,t,Lr,w,n,y,C,o,l,d-h)}var S=m?n:this,O=p?S[e]:e;return o?y=gs(y,o):v&&y.length>1&&y.reverse(),u&&l<y.length&&(y.length=l),this&&this!==$n&&this instanceof c&&(O=g||Mr(O)),O.apply(S,y)}var u=t&ae,m=t&Z,p=t&X,f=t&te,_=t&ne,v=t&oe,g=p?K:Mr(e);return c}function Ur(e){return Ga(function(t){return t=_(Sn(t),Zr()),Ga(function(n){var r=this;return e(t,function(e){return o(e,r,n)})})})}function Wr(e,t,n){t=Li(t);var r=Q(e);if(!t||r>=t)return"";var s=t-r;n=n===K?" ":n+"";var a=$o(n,Wl(s/Q(n)));return mn.test(n)?V(a).slice(0,s).join(""):a.slice(0,s)}function Br(e,t,n,r){function s(){for(var t=-1,l=arguments.length,d=-1,c=r.length,u=Array(c+l),m=this&&this!==$n&&this instanceof s?i:e;++d<c;)u[d]=r[d];for(;l--;)u[d++]=arguments[++t];return o(m,a?n:this,u)}var a=t&Z,i=Mr(e);return s}function zr(e){return function(t,n,r){return r&&"number"!=typeof r&&ls(t,n,r)&&(n=r=K),t=Wi(t),t=t===t?t:0,n===K?(n=t,t=0):n=Wi(n)||0,r=r===K?t<n?1:-1:Wi(r)||0,sr(t,n,r,e)}}function Hr(e,t,n,r,s,a,i,o,l,d){var c=t&te,u=o?Dr(o):K,m=c?i:K,p=c?K:i,f=c?a:K,_=c?K:a;t|=c?re:se,t&=~(c?se:re),t&ee||(t&=~(Z|X));var v=[e,t,s,f,m,_,p,u,l,d],g=n.apply(K,v);return us(e)&&bd(g,v),g.placeholder=r,g}function Qr(e){var t=bl[e];return function(e,n){if(e=Wi(e),n=Li(n)){var r=(Hi(e)+"e").split("e"),s=t(r[0]+"e"+(+r[1]+n));return r=(Hi(s)+"e").split("e"),+(r[0]+"e"+(+r[1]-n))}return t(e)}}function Vr(e,t,n,r,s,a,i,o){var l=t&X;if(!l&&"function"!=typeof e)throw new wl(he);var d=r?r.length:0;if(d||(t&=~(re|se),r=s=K),i=i===K?i:Vl(Li(i),0),o=o===K?o:Li(o),d-=s?s.length:0,t&se){var c=r,u=s;r=s=K}var m=l?K:vd(e),p=[e,t,n,r,s,c,u,a,i,o];if(m&&fs(p,m),e=p[0],t=p[1],n=p[2],r=p[3],s=p[4],o=p[9]=null==p[9]?l?0:e.length:Vl(p[9]-d,0),!o&&t&(te|ne)&&(t&=~(te|ne)),t&&t!=Z)f=t==te||t==ne?Fr(e,t,o):t!=re&&t!=(Z|re)||s.length?Lr.apply(K,p):Br(e,t,n,r);else var f=Pr(e,t,n);var _=m?fd:bd;return _(f,p)}function Yr(e,t,n,r,s,a){var i=-1,o=s&de,l=s&le,d=e.length,c=t.length;if(d!=c&&!(o&&c>d))return!1;var u=a.get(e);if(u)return u==t;var m=!0;for(a.set(e,t);++i<d;){var p=e[i],f=t[i];if(r)var _=o?r(f,p,i,t,e,a):r(p,f,i,e,t,a);if(_!==K){if(_)continue;m=!1;break}if(l){if(!b(t,function(e){return p===e||n(p,e,r,s,a)})){m=!1;break}}else if(p!==f&&!n(p,f,r,s,a)){m=!1;break}}return a.delete(e),m}function Gr(e,t,n,r,s,a){switch(n){case Be:return!(e.byteLength!=t.byteLength||!r(new $l(e),new $l(t)));case qe:case Te:return+e==+t;case Re:return e.name==t.name&&e.message==t.message;case Ie:return e!=+e?t!=+t:e==+t;case Fe:case Le:return e==t+"";case je:var i=B;case Ne:var o=a&de;return i||(i=H),(o||e.size==t.size)&&r(i(e),i(t),s,a|le);case Ue:return!!Rl&&id.call(e)==id.call(t)}return!1}function Kr(e,t,n,r,s,a){var i=s&de,o=ao(e),l=o.length,d=ao(t),c=d.length;if(l!=c&&!i)return!1;for(var u=l;u--;){var m=o[u];if(!(i?m in t:Tn(t,m)))return!1}var p=a.get(e);if(p)return p==t;var f=!0;a.set(e,t);for(var _=i;++u<l;){m=o[u];var v=e[m],g=t[m];if(r)var h=i?r(g,v,m,t,e,a):r(v,g,m,e,t,a);if(!(h===K?v===g||n(v,g,r,s,a):h)){f=!1;break}_||(_="constructor"==m)}if(f&&!_){var b=e.constructor,y=t.constructor;b!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof b&&b instanceof b&&"function"==typeof y&&y instanceof y)&&(f=!1)}return a.delete(e),f}function Jr(e){for(var t=e.name+"",n=ld[t],r=kl.call(ld,t)?n.length:0;r--;){var s=n[r],a=s.func;if(null==a||a==e)return s.name}return t}function Zr(){var e=t.iteratee||Ko;return e=e===Ko?Un:e,arguments.length?e(arguments[0],arguments[1]):e}function Xr(e){for(var t=_o(e),n=t.length;n--;)t[n][2]=ps(t[n][1]);return t}function es(e,t){var n=null==e?K:e[t];return Di(n)?n:K}function ts(e){return xl.call(e)}function ns(e,t,n){for(var r=-1,s=n.length;++r<s;){var a=n[r],i=a.size;switch(a.type){case"drop":e+=i;break;case"dropRight":t-=i;break;case"take":t=Yl(t,e+i);break;case"takeRight":e=Vl(e,t-i)}}return{start:e,end:t}}function rs(e,t,n){if(null==e)return!1;var r=n(e,t);return r||ds(t)||(t=mr(t),e=vs(e,t),null!=e&&(t=Ns(t),r=n(e,t))),r||yi(e&&e.length)&&U(t,e.length)&&(ec(e)||$i(e)||oi(e))}function ss(e){var t=e.length,n=e.constructor(t);return t&&"string"==typeof e[0]&&kl.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function as(e){var t=e.constructor;return dd(hi(t)?t.prototype:K)}function is(e,t,n){var r=e.constructor;switch(t){case Be:return hr(e);case qe:case Te:return new r(+e);case ze:case He:case Qe:case Ve:case Ye:case Ge:case Ke:case Je:case Ze:return Sr(e,n);case je:return br(e);case Ie:case Le:return new r(e);case Fe:return yr(e);case Ne:return wr(e);case Ue:return Cr(e)}}function os(e){var t=e?e.length:K;return yi(t)&&(ec(e)||$i(e)||oi(e))?E(t,String):null}function ls(e,t,n){if(!wi(n))return!1;var r=typeof t;return!!("number"==r?li(n)&&U(t,n.length):"string"==r&&t in n)&&si(n[t],e)}function ds(e,t){return"number"==typeof e||!ec(e)&&(ct.test(e)||!dt.test(e)||null!=t&&e in Object(t))}function cs(e){var t=typeof e;return"number"==t||"boolean"==t||"string"==t&&"__proto__"!==e||null==e}function us(e){var n=Jr(e),r=t[n];if("function"!=typeof r||!(n in s.prototype))return!1;if(e===r)return!0;var a=vd(r);return!!a&&e===a[0]}function ms(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||Sl;return e===n}function ps(e){return e===e&&!wi(e)}function fs(e,t){var n=e[1],r=t[1],s=n|r,a=s<(Z|X|ae),i=r==ae&&n==te||r==ae&&n==ie&&e[7].length<=t[8]||r==(ae|ie)&&t[7].length<=t[8]&&n==te;if(!a&&!i)return e;r&Z&&(e[2]=t[2],s|=n&Z?0:ee);var o=t[3];if(o){var l=e[3];e[3]=l?Or(l,o,t[4]):Dr(o),e[4]=l?z(e[3],Ee):Dr(t[4])}return o=t[5],o&&(l=e[5],e[5]=l?kr(l,o,t[6]):Dr(o),e[6]=l?z(e[5],Ee):Dr(t[6])),o=t[7],o&&(e[7]=Dr(o)),r&ae&&(e[8]=null==e[8]?t[8]:Yl(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=s,e}function _s(e,t,n,r,s,a){return wi(e)&&wi(t)&&(a.set(t,e),Vn(e,t,K,_s,a)),e}function vs(e,t){return 1==t.length?e:to(e,ir(t,0,-1))}function gs(e,t){for(var n=e.length,r=Yl(t.length,n),s=Dr(e);r--;){var a=t[r];e[r]=U(a,n)?s[a]:K}return e}function hs(e){var t=[];return Hi(e).replace(ut,function(e,n,r,s){t.push(r?s.replace(gt,"$1"):n||e)}),t}function bs(e){return di(e)?e:[]}function ys(e){return"function"==typeof e?e:Go}function ws(e){if(e instanceof s)return e.clone();var t=new r(e.__wrapped__,e.__chain__);return t.__actions__=Dr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function Cs(e,t){t=Vl(Li(t),0);var n=e?e.length:0;if(!n||t<1)return[];for(var r=0,s=-1,a=Array(Wl(n/t));r<n;)a[++s]=ir(e,r,r+=t);return a}function Ss(e){for(var t=-1,n=e?e.length:0,r=-1,s=[];++t<n;){var a=e[t];a&&(s[++r]=a)}return s}function Os(e,t,n){var r=e?e.length:0;return r?(t=n||t===K?1:Li(t),ir(e,t<0?0:t,r)):[]}function ks(e,t,n){var r=e?e.length:0;return r?(t=n||t===K?1:Li(t),t=r-t,ir(e,0,t<0?0:t)):[]}function Ds(e,t){return e&&e.length?_r(e,Zr(t,3),!0,!0):[]}function Es(e,t){return e&&e.length?_r(e,Zr(t,3),!0):[]}function xs(e,t,n,r){var s=e?e.length:0;return s?(n&&"number"!=typeof n&&ls(e,t,n)&&(n=0,r=s),wn(e,t,n,r)):[]}function As(e,t){return e&&e.length?C(e,Zr(t,3)):-1}function qs(e,t){return e&&e.length?C(e,Zr(t,3),!0):-1}function Ts(e,t){var n=e?e.length:0;return n?Sn(_(e,Zr(t,3))):[]}function Rs(e){var t=e?e.length:0;return t?Sn(e):[]}function $s(e){var t=e?e.length:0;return t?Sn(e,!0):[]}function Ps(e){for(var t=-1,n=e?e.length:0,r={};++t<n;){var s=e[t];r[s[0]]=s[1]}return r}function js(e){return e?e[0]:K}function Is(e,t,n){var r=e?e.length:0;return r?(n=Li(n),n<0&&(n=Vl(r+n,0)),S(e,t,n)):-1}function Ms(e){return ks(e,1)}function Fs(e,t){return e?Hl.call(e,t):""}function Ns(e){var t=e?e.length:0;return t?e[t-1]:K}function Ls(e,t,n){var r=e?e.length:0;if(!r)return-1;var s=r;if(n!==K&&(s=Li(n),s=(s<0?Vl(r+s,0):Yl(s,r-1))+1),t!==t)return N(e,s,!0);for(;s--;)if(e[s]===t)return s;return-1}function Us(e,t){return e&&e.length&&t&&t.length?er(e,t):e}function Ws(e,t,n){return e&&e.length&&t&&t.length?tr(e,t,Zr(n)):e}function Bs(e,t){var n=[];if(!e||!e.length)return n;var r=-1,s=[],a=e.length;for(t=Zr(t,3);++r<a;){var i=e[r];t(i,r,e)&&(n.push(i),s.push(r))}return nr(e,s),n}function zs(e){return e?Jl.call(e):e}function Hs(e,t,n){var r=e?e.length:0;return r?(n&&"number"!=typeof n&&ls(e,t,n)?(t=0,n=r):(t=null==t?0:Li(t),n=n===K?r:Li(n)),ir(e,t,n)):[]}function Qs(e,t){return lr(e,t)}function Vs(e,t,n){return dr(e,t,Zr(n))}function Ys(e,t){var n=e?e.length:0;if(n){var r=lr(e,t);if(r<n&&si(e[r],t))return r}return-1}function Gs(e,t){return lr(e,t,!0)}function Ks(e,t,n){return dr(e,t,Zr(n),!0)}function Js(e,t){var n=e?e.length:0;if(n){var r=lr(e,t,!0)-1;if(si(e[r],t))return r}return-1}function Zs(e){return e&&e.length?cr(e):[]}function Xs(e,t){return e&&e.length?ur(e,Zr(t)):[]}function ea(e){return Os(e,1)}function ta(e,t,n){return e&&e.length?(t=n||t===K?1:Li(t),ir(e,0,t<0?0:t)):[]}function na(e,t,n){var r=e?e.length:0;return r?(t=n||t===K?1:Li(t),t=r-t,ir(e,t<0?0:t,r)):[]}function ra(e,t){return e&&e.length?_r(e,Zr(t,3),!1,!0):[]}function sa(e,t){return e&&e.length?_r(e,Zr(t,3)):[]}function aa(e){return e&&e.length?pr(e):[]}function ia(e,t){return e&&e.length?pr(e,Zr(t)):[]}function oa(e,t){return e&&e.length?pr(e,K,t):[]}function la(e){if(!e||!e.length)return[];var t=0;return e=m(e,function(e){if(di(e))return t=Vl(e.length,t),!0}),E(t,function(t){return _(e,Zn(t))})}function da(e,t){if(!e||!e.length)return[];var n=la(e);return null==t?n:_(n,function(e){return o(t,K,e)})}function ca(e,t){for(var n=-1,r=e?e.length:0,s=t?t.length:0,a={};++n<r;)ar(a,e[n],n<s?t[n]:K);return a}function ua(e){var n=t(e);return n.__chain__=!0,n}function ma(e,t){return t(e),e}function pa(e,t){return t(e)}function fa(){return ua(this)}function _a(){return new r(this.value(),this.__chain__)}function va(e){return this.map(e).flatten()}function ga(){this.__values__===K&&(this.__values__=Ni(this.value()));var e=this.__index__>=this.__values__.length,t=e?K:this.__values__[this.__index__++];return{done:e,value:t}}function ha(){return this}function ba(e){for(var t,r=this;r instanceof n;){var s=ws(r);s.__index__=0,s.__values__=K,t?a.__wrapped__=s:t=s;var a=s;r=r.__wrapped__}return a.__wrapped__=e,t}function ya(){var e=this.__wrapped__;if(e instanceof s){var t=e;return this.__actions__.length&&(t=new s(this)),t=t.reverse(),t.__actions__.push({func:pa,args:[zs],thisArg:K}),new r(t,this.__chain__)}return this.thru(zs)}function wa(){return vr(this.__wrapped__,this.__actions__)}function Ca(e,t,n){var r=ec(e)?u:yn;return n&&ls(e,t,n)&&(t=K),r(e,Zr(t,3))}function Sa(e,t){var n=ec(e)?m:Cn;return n(e,Zr(t,3))}function Oa(e,t){if(t=Zr(t,3),ec(e)){var n=C(e,t);return n>-1?e[n]:K}return w(e,t,cd)}function ka(e,t){if(t=Zr(t,3),ec(e)){var n=C(e,t,!0);return n>-1?e[n]:K}return w(e,t,ud)}function Da(e,t){return"function"==typeof t&&ec(e)?d(e,t):cd(e,ys(t))}function Ea(e,t){return"function"==typeof t&&ec(e)?c(e,t):ud(e,ys(t))}function xa(e,t,n,r){e=li(e)?e:bo(e),n=n&&!r?Li(n):0;var s=e.length;return n<0&&(n=Vl(s+n,0)),$i(e)?n<=s&&e.indexOf(t,n)>-1:!!s&&S(e,t,n)>-1}function Aa(e,t){var n=ec(e)?_:zn;return n(e,Zr(t,3))}function qa(e,t,n,r){return null==e?[]:(ec(t)||(t=null==t?[]:[t]),n=r?K:n,ec(n)||(n=null==n?[]:[n]),Gn(e,t,n))}function Ta(e,t,n){var r=ec(e)?g:O,s=arguments.length<3;return r(e,Zr(t,4),n,s,cd)}function Ra(e,t,n){var r=ec(e)?h:O,s=arguments.length<3;return r(e,Zr(t,4),n,s,ud)}function $a(e,t){var n=ec(e)?m:Cn;return t=Zr(t,3),n(e,function(e,n,r){return!t(e,n,r)})}function Pa(e){var t=li(e)?e:bo(e),n=t.length;return n>0?t[rr(0,n-1)]:K}function ja(e,t){var n=-1,r=Ni(e),s=r.length,a=s-1;for(t=an(Li(t),0,s);++n<t;){var i=rr(n,a),o=r[i];r[i]=r[n],r[n]=o}return r.length=t,r}function Ia(e){return ja(e,Oe)}function Ma(e){if(null==e)return 0;if(li(e)){var t=e.length;return t&&$i(e)?Q(e):t}return ao(e).length}function Fa(e,t,n){var r=ec(e)?b:or;return n&&ls(e,t,n)&&(t=K),r(e,Zr(t,3))}function Na(e,t){if("function"!=typeof t)throw new wl(he);return e=Li(e),function(){if(--e<1)return t.apply(this,arguments)}}function La(e,t,n){return t=n?K:t,t=e&&null==t?e.length:t,Vr(e,ae,K,K,K,K,t)}function Ua(e,t){var n;if("function"!=typeof t)throw new wl(he);return e=Li(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=K),n}}function Wa(e,t,n){t=n?K:t;var r=Vr(e,te,K,K,K,K,K,t);return r.placeholder=Wa.placeholder,r}function Ba(e,t,n){t=n?K:t;var r=Vr(e,ne,K,K,K,K,K,t);return r.placeholder=Ba.placeholder,r}function za(e,t,n){function r(){f&&Pl(f),c&&Pl(c),v=0,d=c=p=f=_=K}function s(t,n){n&&Pl(n),c=f=_=K,t&&(v=Hd(),u=e.apply(p,d),f||c||(d=p=K))}function a(){var e=t-(Hd()-m);e<=0||e>t?s(_,c):f=Ll(a,e)}function i(){return(f&&_||c&&b)&&(u=e.apply(p,d)),r(),u}function o(){s(b,f)}function l(){if(d=arguments,m=Hd(),p=this,_=b&&(f||!g),h===!1)var n=g&&!f;else{c||g||(v=m);var r=h-(m-v),s=r<=0||r>h;s?(c&&(c=Pl(c)),v=m,u=e.apply(p,d)):c||(c=Ll(o,r))}return s&&f?f=Pl(f):f||t===h||(f=Ll(a,t)),n&&(s=!0,u=e.apply(p,d)),!s||f||c||(d=p=K),u}var d,c,u,m,p,f,_,v=0,g=!1,h=!1,b=!0;
if("function"!=typeof e)throw new wl(he);return t=Wi(t)||0,wi(n)&&(g=!!n.leading,h="maxWait"in n&&Vl(Wi(n.maxWait)||0,t),b="trailing"in n?!!n.trailing:b),l.cancel=r,l.flush=i,l}function Ha(e){return Vr(e,oe)}function Qa(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new wl(he);var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],a=n.cache;if(a.has(s))return a.get(s);var i=e.apply(this,r);return n.cache=a.set(s,i),i};return n.cache=new Qa.Cache,n}function Va(e){if("function"!=typeof e)throw new wl(he);return function(){return!e.apply(this,arguments)}}function Ya(e){return Ua(2,e)}function Ga(e,t){if("function"!=typeof e)throw new wl(he);return t=Vl(t===K?e.length-1:Li(t),0),function(){for(var n=arguments,r=-1,s=Vl(n.length-t,0),a=Array(s);++r<s;)a[r]=n[t+r];switch(t){case 0:return e.call(this,a);case 1:return e.call(this,n[0],a);case 2:return e.call(this,n[0],n[1],a)}var i=Array(t+1);for(r=-1;++r<t;)i[r]=n[r];return i[t]=a,o(e,this,i)}}function Ka(e){if("function"!=typeof e)throw new wl(he);return function(t){return o(e,this,t)}}function Ja(e,t,n){var r=!0,s=!0;if("function"!=typeof e)throw new wl(he);return wi(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),za(e,t,{leading:r,maxWait:t,trailing:s})}function Za(e){return La(e,1)}function Xa(e,t){return t=null==t?Go:t,Jd(t,e)}function ei(e){return on(e)}function ti(e,t){return on(e,!1,t)}function ni(e){return on(e,!0)}function ri(e,t){return on(e,!0,t)}function si(e,t){return e===t||e!==e&&t!==t}function ai(e,t){return e>t}function ii(e,t){return e>=t}function oi(e){return di(e)&&kl.call(e,"callee")&&(!Nl.call(e,"callee")||xl.call(e)==xe)}function li(e){return null!=e&&!("function"==typeof e&&hi(e))&&yi(gd(e))}function di(e){return Ci(e)&&li(e)}function ci(e){return e===!0||e===!1||Ci(e)&&xl.call(e)==qe}function ui(e){return Ci(e)&&xl.call(e)==Te}function mi(e){return!!e&&1===e.nodeType&&Ci(e)&&!qi(e)}function pi(e){return!Ci(e)||hi(e.splice)?!Ma(e):!ao(e).length}function fi(e,t){return Fn(e,t)}function _i(e,t,n){n="function"==typeof n?n:K;var r=n?n(e,t):K;return r===K?Fn(e,t,n):!!r}function vi(e){return Ci(e)&&"string"==typeof e.message&&xl.call(e)==Re}function gi(e){return"number"==typeof e&&zl(e)}function hi(e){var t=wi(e)?xl.call(e):"";return t==$e||t==Pe}function bi(e){return"number"==typeof e&&e==Li(e)}function yi(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=we}function wi(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Ci(e){return!!e&&"object"==typeof e}function Si(e,t){return e===t||Ln(e,t,Xr(t))}function Oi(e,t,n){return n="function"==typeof n?n:K,Ln(e,t,Xr(t),n)}function ki(e){return Ai(e)&&e!=+e}function Di(e){return null!=e&&(hi(e)?ql.test(Ol.call(e)):Ci(e)&&(L(e)?ql:St).test(e))}function Ei(e){return null===e}function xi(e){return null==e}function Ai(e){return"number"==typeof e||Ci(e)&&xl.call(e)==Ie}function qi(e){if(!Ci(e)||xl.call(e)!=Me||L(e))return!1;var t=Sl;if("function"==typeof e.constructor&&(t=Il(e)),null===t)return!0;var n=t.constructor;return"function"==typeof n&&n instanceof n&&Ol.call(n)==El}function Ti(e){return wi(e)&&xl.call(e)==Fe}function Ri(e){return bi(e)&&e>=-we&&e<=we}function $i(e){return"string"==typeof e||!ec(e)&&Ci(e)&&xl.call(e)==Le}function Pi(e){return"symbol"==typeof e||Ci(e)&&xl.call(e)==Ue}function ji(e){return Ci(e)&&yi(e.length)&&!!hn[xl.call(e)]}function Ii(e){return e===K}function Mi(e,t){return e<t}function Fi(e,t){return e<=t}function Ni(e){if(!e)return[];if(li(e))return $i(e)?V(e):Dr(e);if(Fl&&e[Fl])return W(e[Fl]());var t=ts(e),n=t==je?B:t==Ne?H:bo;return n(e)}function Li(e){if(!e)return 0===e?e:0;if(e=Wi(e),e===ye||e===-ye){var t=e<0?-1:1;return t*Ce}var n=e%1;return e===e?n?e-n:e:0}function Ui(e){return e?an(Li(e),0,Oe):0}function Wi(e){if(wi(e)){var t=hi(e.valueOf)?e.valueOf():e;e=wi(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(ft,"");var n=Ct.test(e);return n||Ot.test(e)?Dn(e.slice(2),n?2:8):wt.test(e)?Se:+e}function Bi(e){return Er(e,io(e))}function zi(e){return an(Li(e),-we,we)}function Hi(e){if("string"==typeof e)return e;if(null==e)return"";if(Pi(e))return Rl?od.call(e):"";var t=e+"";return"0"==t&&1/e==-ye?"-0":t}function Qi(e,t){var n=dd(e);return t?rn(n,t):n}function Vi(e,t){return w(e,Zr(t,3),En,!0)}function Yi(e,t){return w(e,Zr(t,3),xn,!0)}function Gi(e,t){return null==e?e:md(e,ys(t),io)}function Ki(e,t){return null==e?e:pd(e,ys(t),io)}function Ji(e,t){return e&&En(e,ys(t))}function Zi(e,t){return e&&xn(e,ys(t))}function Xi(e){return null==e?[]:An(e,ao(e))}function eo(e){return null==e?[]:An(e,io(e))}function to(e,t,n){var r=null==e?K:qn(e,t);return r===K?n:r}function no(e,t){return rs(e,t,Tn)}function ro(e,t){return rs(e,t,Rn)}function so(e,t,n){return g(ao(e),function(r,s){var a=e[s];return t&&!n?kl.call(r,a)?r[a].push(s):r[a]=[s]:r[a]=s,r},{})}function ao(e){var t=ms(e);if(!t&&!li(e))return Wn(e);var n=os(e),r=!!n,s=n||[],a=s.length;for(var i in e)!Tn(e,i)||r&&("length"==i||U(i,a))||t&&"constructor"==i||s.push(i);return s}function io(e){for(var t=-1,n=ms(e),r=Bn(e),s=r.length,a=os(e),i=!!a,o=a||[],l=o.length;++t<s;){var d=r[t];i&&("length"==d||U(d,l))||"constructor"==d&&(n||!kl.call(e,d))||o.push(d)}return o}function oo(e,t){var n={};return t=Zr(t,3),En(e,function(e,r,s){n[t(e,r,s)]=e}),n}function lo(e,t){var n={};return t=Zr(t,3),En(e,function(e,r,s){n[r]=t(e,r,s)}),n}function co(e,t){return t=Zr(t,2),Jn(e,function(e,n){return!t(e,n)})}function uo(e,t){return null==e?{}:Jn(e,Zr(t,2))}function mo(e,t,n){if(ds(t,e))r=null==e?K:e[t];else{t=mr(t);var r=to(e,t);e=vs(e,t)}return r===K&&(r=n),hi(r)?r.call(e):r}function po(e,t,n){return null==e?e:ar(e,t,n)}function fo(e,t,n,r){return r="function"==typeof r?r:K,null==e?e:ar(e,t,n,r)}function _o(e){return x(e,ao(e))}function vo(e){return x(e,io(e))}function go(e,t,n){var r=ec(e)||ji(e);if(t=Zr(t,4),null==n)if(r||wi(e)){var s=e.constructor;n=r?ec(e)?new s:[]:dd(hi(s)?s.prototype:K)}else n={};return(r?d:En)(e,function(e,r,s){return t(n,e,r,s)}),n}function ho(e,t){return null==e||fr(e,t)}function bo(e){return e?q(e,ao(e)):[]}function yo(e){return null==e?q(e,io(e)):[]}function wo(e,t,n){return n===K&&(n=t,t=K),n!==K&&(n=Wi(n),n=n===n?n:0),t!==K&&(t=Wi(t),t=t===t?t:0),an(Wi(e),t,n)}function Co(e,t,n){return t=Wi(t)||0,n===K?(n=t,t=0):n=Wi(n)||0,e=Wi(e),jn(e,t,n)}function So(e,t,n){if(n&&"boolean"!=typeof n&&ls(e,t,n)&&(t=n=K),n===K&&("boolean"==typeof t?(n=t,t=K):"boolean"==typeof e&&(n=e,e=K)),e===K&&t===K?(e=0,t=1):(e=Wi(e)||0,t===K?(t=e,e=0):t=Wi(t)||0),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var s=Kl();return Yl(e+s*(t-e+kn("1e-"+((s+"").length-1))),t)}return rr(e,t)}function Oo(e){return gc(Hi(e).toLowerCase())}function ko(e){return e=Hi(e),e&&e.replace(Dt,I).replace(cn,"")}function Do(e,t,n){e=Hi(e),t="string"==typeof t?t:t+"";var r=e.length;return n=n===K?r:an(Li(n),0,r),n-=t.length,n>=0&&e.indexOf(t,n)==n}function Eo(e){return e=Hi(e),e&&at.test(e)?e.replace(rt,M):e}function xo(e){return e=Hi(e),e&&pt.test(e)?e.replace(mt,"\\$&"):e}function Ao(e,t,n){e=Hi(e),t=Li(t);var r=Q(e);if(!t||r>=t)return e;var s=(t-r)/2,a=Bl(s),i=Wl(s);return Wr("",a,n)+e+Wr("",i,n)}function qo(e,t,n){return e=Hi(e),e+Wr(e,t,n)}function To(e,t,n){return e=Hi(e),Wr(e,t,n)+e}function Ro(e,t,n){return n||null==t?t=0:t&&(t=+t),e=Hi(e).replace(ft,""),Gl(e,t||(yt.test(e)?16:10))}function $o(e,t){e=Hi(e),t=Li(t);var n="";if(!e||t<1||t>we)return n;do t%2&&(n+=e),t=Bl(t/2),e+=e;while(t);return n}function Po(){var e=arguments,t=Hi(e[0]);return e.length<3?t:t.replace(e[1],e[2])}function jo(e,t,n){return Hi(e).split(t,n)}function Io(e,t,n){return e=Hi(e),n=an(Li(n),0,e.length),e.lastIndexOf(t,n)==n}function Mo(e,n,r){var s=t.templateSettings;r&&ls(e,n,r)&&(n=K),e=Hi(e),n=rc({},n,s,en);var a,i,o=rc({},n.imports,s.imports,en),l=ao(o),d=q(o,l),c=0,u=n.interpolate||Et,m="__p += '",p=yl((n.escape||Et).source+"|"+u.source+"|"+(u===lt?ht:Et).source+"|"+(n.evaluate||Et).source+"|$","g"),f="//# sourceURL="+("sourceURL"in n?n.sourceURL:"lodash.templateSources["+ ++gn+"]")+"\n";e.replace(p,function(t,n,r,s,o,l){return r||(r=s),m+=e.slice(c,l).replace(xt,F),n&&(a=!0,m+="' +\n__e("+n+") +\n'"),o&&(i=!0,m+="';\n"+o+";\n__p += '"),r&&(m+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=l+t.length,t}),m+="';\n";var _=n.variable;_||(m="with (obj) {\n"+m+"\n}\n"),m=(i?m.replace(Xe,""):m).replace(et,"$1").replace(tt,"$1;"),m="function("+(_||"obj")+") {\n"+(_?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+m+"return __p\n}";var v=wc(function(){return Function(l,f+"return "+m).apply(K,d)});if(v.source=m,vi(v))throw v;return v}function Fo(e){return Hi(e).toLowerCase()}function No(e){return Hi(e).toUpperCase()}function Lo(e,t,n){if(e=Hi(e),!e)return e;if(n||t===K)return e.replace(ft,"");if(t+="",!t)return e;var r=V(e),s=V(t);return r.slice(T(r,s),R(r,s)+1).join("")}function Uo(e,t,n){if(e=Hi(e),!e)return e;if(n||t===K)return e.replace(vt,"");if(t+="",!t)return e;var r=V(e);return r.slice(0,R(r,V(t))+1).join("")}function Wo(e,t,n){if(e=Hi(e),!e)return e;if(n||t===K)return e.replace(_t,"");if(t+="",!t)return e;var r=V(e);return r.slice(T(r,V(t))).join("")}function Bo(e,t){var n=ce,r=ue;if(wi(t)){var s="separator"in t?t.separator:s;n="length"in t?Li(t.length):n,r="omission"in t?Hi(t.omission):r}e=Hi(e);var a=e.length;if(mn.test(e)){var i=V(e);a=i.length}if(n>=a)return e;var o=n-Q(r);if(o<1)return r;var l=i?i.slice(0,o).join(""):e.slice(0,o);if(s===K)return l+r;if(i&&(o+=l.length-o),Ti(s)){if(e.slice(o).search(s)){var d,c=l;for(s.global||(s=yl(s.source,Hi(bt.exec(s))+"g")),s.lastIndex=0;d=s.exec(c);)var u=d.index;l=l.slice(0,u===K?o:u)}}else if(e.indexOf(s,o)!=o){var m=l.lastIndexOf(s);m>-1&&(l=l.slice(0,m))}return l+r}function zo(e){return e=Hi(e),e&&st.test(e)?e.replace(nt,Y):e}function Ho(e,t,n){return e=Hi(e),t=n?K:t,t===K&&(t=_n.test(e)?fn:pn),e.match(t)||[]}function Qo(e){var t=e?e.length:0,n=Zr();return e=t?_(e,function(e){if("function"!=typeof e[1])throw new wl(he);return[n(e[0]),e[1]]}):[],Ga(function(n){for(var r=-1;++r<t;){var s=e[r];if(o(s[0],this,n))return o(s[1],this,n)}})}function Vo(e){return ln(on(e,!0))}function Yo(e){return function(){return e}}function Go(e){return e}function Ko(e){return Ci(e)&&!ec(e)?Jo(e):Un(e)}function Jo(e){return Hn(on(e,!0))}function Zo(e,t){return Qn(e,on(t,!0))}function Xo(e,t,n){var r=ao(t),s=An(t,r);null!=n||wi(t)&&(s.length||!r.length)||(n=t,t=e,e=this,s=An(t,ao(t)));var a=!(wi(n)&&"chain"in n)||n.chain,i=hi(e);return d(s,function(n){var r=t[n];e[n]=r,i&&(e.prototype[n]=function(){var t=this.__chain__;if(a||t){var n=e(this.__wrapped__),s=n.__actions__=Dr(this.__actions__);return s.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,v([this.value()],arguments))})}),e}function el(){return $n._===this&&($n._=Al),this}function tl(){}function nl(e){return e=Li(e),function(){return arguments[e]}}function rl(e){return ds(e)?Zn(e):Xn(e)}function sl(e){return function(t){return null==e?K:qn(e,t)}}function al(e,t){if(e=Li(e),e<1||e>we)return[];var n=Oe,r=Yl(e,Oe);t=ys(t),e-=Oe;for(var s=E(r,t);++n<e;)t(n);return s}function il(e){return ec(e)?_(e,String):hs(e)}function ol(e){var t=++Dl;return Hi(e)+t}function ll(e,t){var n;return e!==K&&(n=e),t!==K&&(n=n===K?t:n+t),n}function dl(e){return e&&e.length?y(e,Go,ai):K}function cl(e,t){return e&&e.length?y(e,Zr(t),ai):K}function ul(e){return _l(e)/(e?e.length:0)}function ml(e){return e&&e.length?y(e,Go,Mi):K}function pl(e,t){return e&&e.length?y(e,Zr(t),Mi):K}function fl(e,t){var n;return e!==K&&(n=e),t!==K&&(n=n===K?t:n-t),n}function _l(e){return e&&e.length?D(e,Go):K}function vl(e,t){return e&&e.length?D(e,Zr(t)):K}e=e?Pn.defaults({},e,Pn.pick($n,vn)):$n;var gl=e.Date,hl=e.Error,bl=e.Math,yl=e.RegExp,wl=e.TypeError,Cl=e.Array.prototype,Sl=e.Object.prototype,Ol=e.Function.prototype.toString,kl=Sl.hasOwnProperty,Dl=0,El=Ol.call(Object),xl=Sl.toString,Al=$n._,ql=yl("^"+Ol.call(kl).replace(mt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Tl=e.Reflect,Rl=e.Symbol,$l=e.Uint8Array,Pl=e.clearTimeout,jl=Tl?Tl.enumerate:K,Il=Object.getPrototypeOf,Ml=Object.getOwnPropertySymbols,Fl="symbol"==typeof(Fl=Rl&&Rl.iterator)?Fl:K,Nl=Sl.propertyIsEnumerable,Ll=e.setTimeout,Ul=Cl.splice,Wl=bl.ceil,Bl=bl.floor,zl=e.isFinite,Hl=Cl.join,Ql=Object.keys,Vl=bl.max,Yl=bl.min,Gl=e.parseInt,Kl=bl.random,Jl=Cl.reverse,Zl=es(e,"Map"),Xl=es(e,"Set"),ed=es(e,"WeakMap"),td=es(Object,"create"),nd=ed&&new ed,rd=Zl?Ol.call(Zl):"",sd=Xl?Ol.call(Xl):"",ad=Rl?Rl.prototype:K,id=Rl?ad.valueOf:K,od=Rl?ad.toString:K,ld={};t.templateSettings={escape:it,evaluate:ot,interpolate:lt,variable:"",imports:{_:t}};var dd=function(){function e(){}return function(t){if(wi(t)){e.prototype=t;var n=new e;e.prototype=K}return n||{}}}(),cd=Rr(En),ud=Rr(xn,!0),md=$r(),pd=$r(!0);jl&&!Nl.call({valueOf:1},"valueOf")&&(Bn=function(e){return W(jl(e))});var fd=nd?function(e,t){return nd.set(e,t),e}:Go,_d=Xl&&2===new Xl([1,2]).size?function(e){return new Xl(e)}:tl,vd=nd?function(e){return nd.get(e)}:tl,gd=Zn("length"),hd=Ml||function(){return[]};(Zl&&ts(new Zl)!=je||Xl&&ts(new Xl)!=Ne)&&(ts=function(e){var t=xl.call(e),n=t==Me?e.constructor:null,r="function"==typeof n?Ol.call(n):"";if(r){if(r==rd)return je;if(r==sd)return Ne}return t});var bd=function(){var e=0,t=0;return function(n,r){var s=Hd(),a=pe-(s-t);if(t=s,a>0){if(++e>=me)return n}else e=0;return fd(n,r)}}(),yd=Ga(function(e,t){return ec(e)||(e=null==e?[]:[Object(e)]),t=Sn(t),l(e,t)}),wd=Ga(function(e,t){return di(e)?un(e,Sn(t,!1,!0)):[]}),Cd=Ga(function(e,t){var n=Ns(t);return di(n)&&(n=K),di(e)?un(e,Sn(t,!1,!0),Zr(n)):[]}),Sd=Ga(function(e,t){var n=Ns(t);return di(n)&&(n=K),di(e)?un(e,Sn(t,!1,!0),K,n):[]}),Od=Ga(function(e){var t=_(e,bs);return t.length&&t[0]===e[0]?In(t):[]}),kd=Ga(function(e){var t=Ns(e),n=_(e,bs);return t===Ns(n)?t=K:n.pop(),n.length&&n[0]===e[0]?In(n,Zr(t)):[]}),Dd=Ga(function(e){var t=Ns(e),n=_(e,bs);return t===Ns(n)?t=K:n.pop(),n.length&&n[0]===e[0]?In(n,K,t):[]}),Ed=Ga(Us),xd=Ga(function(e,t){t=_(Sn(t),String);var n=sn(e,t);return nr(e,t.sort(P)),n}),Ad=Ga(function(e){return pr(Sn(e,!1,!0))}),qd=Ga(function(e){var t=Ns(e);return di(t)&&(t=K),pr(Sn(e,!1,!0),Zr(t))}),Td=Ga(function(e){var t=Ns(e);return di(t)&&(t=K),pr(Sn(e,!1,!0),K,t)}),Rd=Ga(function(e,t){return di(e)?un(e,t):[]}),$d=Ga(function(e){return gr(m(e,di))}),Pd=Ga(function(e){var t=Ns(e);return di(t)&&(t=K),gr(m(e,di),Zr(t))}),jd=Ga(function(e){var t=Ns(e);return di(t)&&(t=K),gr(m(e,di),K,t)}),Id=Ga(la),Md=Ga(function(e){var t=e.length,n=t>1?e[t-1]:K;return n="function"==typeof n?(e.pop(),n):K,da(e,n)}),Fd=Ga(function(e){e=Sn(e);var t=e.length,n=t?e[0]:0,a=this.__wrapped__,i=function(t){return sn(t,e)};return!(t>1||this.__actions__.length)&&a instanceof s&&U(n)?(a=a.slice(n,+n+(t?1:0)),a.__actions__.push({func:pa,args:[i],thisArg:K}),new r(a,this.__chain__).thru(function(e){return t&&!e.length&&e.push(K),e})):this.thru(i)}),Nd=qr(function(e,t,n){kl.call(e,n)?++e[n]:e[n]=1}),Ld=qr(function(e,t,n){kl.call(e,n)?e[n].push(t):e[n]=[t]}),Ud=Ga(function(e,t,n){var r=-1,s="function"==typeof t,a=ds(t),i=li(e)?Array(e.length):[];return cd(e,function(e){var l=s?t:a&&null!=e?e[t]:K;i[++r]=l?o(l,e,n):Mn(e,t,n)}),i}),Wd=qr(function(e,t,n){e[n]=t}),Bd=qr(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),zd=Ga(function(e,t){if(null==e)return[];var n=t.length;return n>1&&ls(e,t[0],t[1])?t=[]:n>2&&ls(t[0],t[1],t[2])&&(t.length=1),Gn(e,Sn(t),[])}),Hd=gl.now,Qd=Ga(function(e,t,n){var r=Z;if(n.length){var s=z(n,Qd.placeholder);r|=re}return Vr(e,r,t,n,s)}),Vd=Ga(function(e,t,n){var r=Z|X;if(n.length){var s=z(n,Vd.placeholder);r|=re}return Vr(t,r,e,n,s)}),Yd=Ga(function(e,t){return dn(e,1,t)}),Gd=Ga(function(e,t,n){return dn(e,Wi(t)||0,n)}),Kd=Ga(function(e,t){t=_(Sn(t),Zr());var n=t.length;return Ga(function(r){for(var s=-1,a=Yl(r.length,n);++s<a;)r[s]=t[s].call(this,r[s]);return o(e,this,r)})}),Jd=Ga(function(e,t){var n=z(t,Jd.placeholder);return Vr(e,re,K,t,n)}),Zd=Ga(function(e,t){var n=z(t,Zd.placeholder);return Vr(e,se,K,t,n)}),Xd=Ga(function(e,t){return Vr(e,ie,K,K,K,Sn(t))}),ec=Array.isArray,tc=Tr(function(e,t){Er(t,ao(t),e)}),nc=Tr(function(e,t){Er(t,io(t),e)}),rc=Tr(function(e,t,n,r){xr(t,io(t),e,r)}),sc=Tr(function(e,t,n,r){xr(t,ao(t),e,r)}),ac=Ga(function(e,t){return sn(e,Sn(t))}),ic=Ga(function(e){return e.push(K,en),o(rc,K,e)}),oc=Ga(function(e){return e.push(K,_s),o(cc,K,e)}),lc=Ga(Mn),dc=Tr(function(e,t,n){Vn(e,t,n)}),cc=Tr(function(e,t,n,r){Vn(e,t,n,r)}),uc=Ga(function(e,t){return null==e?{}:(t=_(Sn(t),String),Kn(e,un(io(e),t)))}),mc=Ga(function(e,t){return null==e?{}:Kn(e,Sn(t))}),pc=Ir(function(e,t,n){return t=t.toLowerCase(),e+(n?Oo(t):t)}),fc=Ir(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),_c=Ir(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),vc=jr("toLowerCase"),gc=jr("toUpperCase"),hc=Ir(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),bc=Ir(function(e,t,n){return e+(n?" ":"")+Oo(t)}),yc=Ir(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),wc=Ga(function(e,t){try{return o(e,K,t)}catch(e){return vi(e)?e:new hl(e)}}),Cc=Ga(function(e,t){return d(Sn(t),function(t){e[t]=Qd(e[t],e)}),e}),Sc=Nr(),Oc=Nr(!0),kc=Ga(function(e,t){return function(n){return Mn(n,e,t)}}),Dc=Ga(function(e,t){return function(n){return Mn(e,n,t)}}),Ec=Ur(_),xc=Ur(u),Ac=Ur(b),qc=zr(),Tc=zr(!0),Rc=Qr("ceil"),$c=Qr("floor"),Pc=Qr("round");return t.prototype=n.prototype,r.prototype=dd(n.prototype),r.prototype.constructor=r,s.prototype=dd(n.prototype),s.prototype.constructor=s,At.prototype=td?td(null):Sl,Pt.prototype.clear=jt,Pt.prototype.delete=It,Pt.prototype.get=Mt,Pt.prototype.has=Ft,Pt.prototype.set=Nt,Lt.prototype.push=Wt,Bt.prototype.clear=zt,Bt.prototype.delete=Ht,Bt.prototype.get=Qt,Bt.prototype.has=Vt,Bt.prototype.set=Yt,Qa.Cache=Pt,t.after=Na,t.ary=La,t.assign=tc,t.assignIn=nc,t.assignInWith=rc,t.assignWith=sc,t.at=ac,t.before=Ua,t.bind=Qd,t.bindAll=Cc,t.bindKey=Vd,t.chain=ua,t.chunk=Cs,t.compact=Ss,t.concat=yd,t.cond=Qo,t.conforms=Vo,t.constant=Yo,t.countBy=Nd,t.create=Qi,t.curry=Wa,t.curryRight=Ba,t.debounce=za,t.defaults=ic,t.defaultsDeep=oc,t.defer=Yd,t.delay=Gd,t.difference=wd,t.differenceBy=Cd,t.differenceWith=Sd,t.drop=Os,t.dropRight=ks,t.dropRightWhile=Ds,t.dropWhile=Es,t.fill=xs,t.filter=Sa,t.flatMap=Ts,t.flatten=Rs,t.flattenDeep=$s,t.flip=Ha,t.flow=Sc,t.flowRight=Oc,t.fromPairs=Ps,t.functions=Xi,t.functionsIn=eo,t.groupBy=Ld,t.initial=Ms,t.intersection=Od,t.intersectionBy=kd,t.intersectionWith=Dd,t.invert=so,t.invokeMap=Ud,t.iteratee=Ko,t.keyBy=Wd,t.keys=ao,t.keysIn=io,t.map=Aa,t.mapKeys=oo,t.mapValues=lo,t.matches=Jo,t.matchesProperty=Zo,t.memoize=Qa,t.merge=dc,t.mergeWith=cc,t.method=kc,t.methodOf=Dc,t.mixin=Xo,t.negate=Va,t.nthArg=nl,t.omit=uc,t.omitBy=co,t.once=Ya,t.orderBy=qa,t.over=Ec,t.overArgs=Kd,t.overEvery=xc,t.overSome=Ac,t.partial=Jd,t.partialRight=Zd,t.partition=Bd,t.pick=mc,t.pickBy=uo,t.property=rl,t.propertyOf=sl,t.pull=Ed,t.pullAll=Us,t.pullAllBy=Ws,t.pullAt=xd,t.range=qc,t.rangeRight=Tc,t.rearg=Xd,t.reject=$a,t.remove=Bs,t.rest=Ga,t.reverse=zs,t.sampleSize=ja,t.set=po,t.setWith=fo,t.shuffle=Ia,t.slice=Hs,t.sortBy=zd,t.sortedUniq=Zs,t.sortedUniqBy=Xs,t.split=jo,t.spread=Ka,t.tail=ea,t.take=ta,t.takeRight=na,t.takeRightWhile=ra,t.takeWhile=sa,t.tap=ma,t.throttle=Ja,t.thru=pa,t.toArray=Ni,t.toPairs=_o,t.toPairsIn=vo,t.toPath=il,t.toPlainObject=Bi,t.transform=go,t.unary=Za,t.union=Ad,t.unionBy=qd,t.unionWith=Td,t.uniq=aa,t.uniqBy=ia,t.uniqWith=oa,t.unset=ho,t.unzip=la,t.unzipWith=da,t.values=bo,t.valuesIn=yo,t.without=Rd,t.words=Ho,t.wrap=Xa,t.xor=$d,t.xorBy=Pd,t.xorWith=jd,t.zip=Id,t.zipObject=ca,t.zipWith=Md,t.extend=nc,t.extendWith=rc,Xo(t,t),t.add=ll,t.attempt=wc,t.camelCase=pc,t.capitalize=Oo,t.ceil=Rc,t.clamp=wo,t.clone=ei,t.cloneDeep=ni,t.cloneDeepWith=ri,t.cloneWith=ti,t.deburr=ko,t.endsWith=Do,t.eq=si,t.escape=Eo,t.escapeRegExp=xo,t.every=Ca,t.find=Oa,t.findIndex=As,t.findKey=Vi,t.findLast=ka,t.findLastIndex=qs,t.findLastKey=Yi,t.floor=$c,t.forEach=Da,t.forEachRight=Ea,t.forIn=Gi,t.forInRight=Ki,t.forOwn=Ji,t.forOwnRight=Zi,t.get=to,t.gt=ai,t.gte=ii,t.has=no,t.hasIn=ro,t.head=js,t.identity=Go,t.includes=xa,t.indexOf=Is,t.inRange=Co,t.invoke=lc,t.isArguments=oi,t.isArray=ec,t.isArrayLike=li,t.isArrayLikeObject=di,t.isBoolean=ci,t.isDate=ui,t.isElement=mi,t.isEmpty=pi,t.isEqual=fi,t.isEqualWith=_i,t.isError=vi,t.isFinite=gi,t.isFunction=hi,t.isInteger=bi,t.isLength=yi,t.isMatch=Si,t.isMatchWith=Oi,t.isNaN=ki,t.isNative=Di,t.isNil=xi,t.isNull=Ei,t.isNumber=Ai,t.isObject=wi,t.isObjectLike=Ci,t.isPlainObject=qi,t.isRegExp=Ti,t.isSafeInteger=Ri,t.isString=$i,t.isSymbol=Pi,t.isTypedArray=ji,t.isUndefined=Ii,t.join=Fs,t.kebabCase=fc,t.last=Ns,t.lastIndexOf=Ls,t.lowerCase=_c,t.lowerFirst=vc,t.lt=Mi,t.lte=Fi,t.max=dl,t.maxBy=cl,t.mean=ul,t.min=ml,t.minBy=pl,t.noConflict=el,t.noop=tl,t.now=Hd,t.pad=Ao,t.padEnd=qo,t.padStart=To,t.parseInt=Ro,t.random=So,t.reduce=Ta,t.reduceRight=Ra,t.repeat=$o,t.replace=Po,t.result=mo,t.round=Pc,t.runInContext=G,t.sample=Pa,t.size=Ma,t.snakeCase=hc,t.some=Fa,t.sortedIndex=Qs,t.sortedIndexBy=Vs,t.sortedIndexOf=Ys,t.sortedLastIndex=Gs,t.sortedLastIndexBy=Ks,t.sortedLastIndexOf=Js,t.startCase=bc,t.startsWith=Io,t.subtract=fl,t.sum=_l,t.sumBy=vl,t.template=Mo,t.times=al,t.toInteger=Li,t.toLength=Ui,t.toLower=Fo,t.toNumber=Wi,t.toSafeInteger=zi,t.toString=Hi,t.toUpper=No,t.trim=Lo,t.trimEnd=Uo,t.trimStart=Wo,t.truncate=Bo,t.unescape=zo,t.uniqueId=ol,t.upperCase=yc,t.upperFirst=gc,t.each=Da,t.eachRight=Ea,t.first=js,Xo(t,function(){var e={};return En(t,function(n,r){kl.call(t.prototype,r)||(e[r]=n)}),e}(),{chain:!1}),t.VERSION=J,d(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){t[e].placeholder=t}),d(["drop","take"],function(e,t){s.prototype[e]=function(n){var r=this.__filtered__;if(r&&!t)return new s(this);n=n===K?1:Vl(Li(n),0);var a=this.clone();return r?a.__takeCount__=Yl(n,a.__takeCount__):a.__views__.push({size:Yl(n,Oe),type:e+(a.__dir__<0?"Right":"")}),a},s.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),d(["filter","map","takeWhile"],function(e,t){var n=t+1,r=n==_e||n==ge;s.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Zr(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}}),d(["head","last"],function(e,t){var n="take"+(t?"Right":"");s.prototype[e]=function(){return this[n](1).value()[0]}}),d(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");s.prototype[e]=function(){return this.__filtered__?new s(this):this[n](1)}}),s.prototype.compact=function(){return this.filter(Go)},s.prototype.find=function(e){return this.filter(e).head()},s.prototype.findLast=function(e){return this.reverse().find(e)},s.prototype.invokeMap=Ga(function(e,t){return"function"==typeof e?new s(this):this.map(function(n){return Mn(n,e,t)})}),s.prototype.reject=function(e){return e=Zr(e,3),this.filter(function(t){return!e(t)})},s.prototype.slice=function(e,t){e=Li(e);var n=this;return n.__filtered__&&(e>0||t<0)?new s(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==K&&(t=Li(t),n=t<0?n.dropRight(-t):n.take(t-e)),n)},s.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},s.prototype.toArray=function(){return this.take(Oe)},En(s.prototype,function(e,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),i=/^(?:head|last)$/.test(n),o=t[i?"take"+("last"==n?"Right":""):n],l=i||/^find/.test(n);o&&(t.prototype[n]=function(){var n=this.__wrapped__,d=i?[1]:arguments,c=n instanceof s,u=d[0],m=c||ec(n),p=function(e){var n=o.apply(t,v([e],d));return i&&f?n[0]:n};m&&a&&"function"==typeof u&&1!=u.length&&(c=m=!1);var f=this.__chain__,_=!!this.__actions__.length,g=l&&!f,h=c&&!_;if(!l&&m){n=h?n:new s(this);var b=e.apply(n,d);return b.__actions__.push({func:pa,args:[p],thisArg:K}),new r(b,f)}return g&&h?e.apply(this,d):(b=this.thru(p),g?i?b.value()[0]:b.value():b)})}),d(["pop","push","shift","sort","splice","unshift"],function(e){var n=Cl[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",s=/^(?:pop|shift)$/.test(e);t.prototype[e]=function(){var e=arguments;return s&&!this.__chain__?n.apply(this.value(),e):this[r](function(t){return n.apply(t,e)})}}),En(s.prototype,function(e,n){var r=t[n];if(r){var s=r.name+"",a=ld[s]||(ld[s]=[]);a.push({name:n,func:r})}}),ld[Lr(K,X).name]=[{name:"wrapper",func:K}],s.prototype.clone=$,s.prototype.reverse=We,s.prototype.value=kt,t.prototype.at=Fd,t.prototype.chain=fa,t.prototype.commit=_a,t.prototype.flatMap=va,t.prototype.next=ga,t.prototype.plant=ba,t.prototype.reverse=ya,t.prototype.toJSON=t.prototype.valueOf=t.prototype.value=wa,Fl&&(t.prototype[Fl]=ha),t}var K,J="4.0.1",Z=1,X=2,ee=4,te=8,ne=16,re=32,se=64,ae=128,ie=256,oe=512,le=1,de=2,ce=30,ue="...",me=150,pe=16,fe=200,_e=1,ve=2,ge=3,he="Expected a function",be="__lodash_hash_undefined__",ye=1/0,we=9007199254740991,Ce=1.7976931348623157e308,Se=NaN,Oe=4294967295,ke=Oe-1,De=Oe>>>1,Ee="__lodash_placeholder__",xe="[object Arguments]",Ae="[object Array]",qe="[object Boolean]",Te="[object Date]",Re="[object Error]",$e="[object Function]",Pe="[object GeneratorFunction]",je="[object Map]",Ie="[object Number]",Me="[object Object]",Fe="[object RegExp]",Ne="[object Set]",Le="[object String]",Ue="[object Symbol]",We="[object WeakMap]",Be="[object ArrayBuffer]",ze="[object Float32Array]",He="[object Float64Array]",Qe="[object Int8Array]",Ve="[object Int16Array]",Ye="[object Int32Array]",Ge="[object Uint8Array]",Ke="[object Uint8ClampedArray]",Je="[object Uint16Array]",Ze="[object Uint32Array]",Xe=/\b__p \+= '';/g,et=/\b(__p \+=) '' \+/g,tt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,nt=/&(?:amp|lt|gt|quot|#39|#96);/g,rt=/[&<>"'`]/g,st=RegExp(nt.source),at=RegExp(rt.source),it=/<%-([\s\S]+?)%>/g,ot=/<%([\s\S]+?)%>/g,lt=/<%=([\s\S]+?)%>/g,dt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ct=/^\w*$/,ut=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,mt=/[\\^$.*+?()[\]{}|]/g,pt=RegExp(mt.source),ft=/^\s+|\s+$/g,_t=/^\s+/,vt=/\s+$/,gt=/\\(\\)?/g,ht=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,bt=/\w*$/,yt=/^0x/i,wt=/^[-+]0x[0-9a-f]+$/i,Ct=/^0b[01]+$/i,St=/^\[object .+?Constructor\]$/,Ot=/^0o[0-7]+$/i,kt=/^(?:0|[1-9]\d*)$/,Dt=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Et=/($^)/,xt=/['\n\r\u2028\u2029\\]/g,At="\\ud800-\\udfff",qt="\\u0300-\\u036f\\ufe20-\\ufe23",Tt="\\u20d0-\\u20f0",Rt="\\u2700-\\u27bf",$t="a-z\\xdf-\\xf6\\xf8-\\xff",Pt="\\xac\\xb1\\xd7\\xf7",jt="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",It="\\u2018\\u2019\\u201c\\u201d",Mt=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ft="A-Z\\xc0-\\xd6\\xd8-\\xde",Nt="\\ufe0e\\ufe0f",Lt=Pt+jt+It+Mt,Ut="["+At+"]",Wt="["+Lt+"]",Bt="["+qt+Tt+"]",zt="\\d+",Ht="["+Rt+"]",Qt="["+$t+"]",Vt="[^"+At+Lt+zt+Rt+$t+Ft+"]",Yt="\\ud83c[\\udffb-\\udfff]",Gt="(?:"+Bt+"|"+Yt+")",Kt="[^"+At+"]",Jt="(?:\\ud83c[\\udde6-\\uddff]){2}",Zt="[\\ud800-\\udbff][\\udc00-\\udfff]",Xt="["+Ft+"]",en="\\u200d",tn="(?:"+Qt+"|"+Vt+")",nn="(?:"+Xt+"|"+Vt+")",rn=Gt+"?",sn="["+Nt+"]?",an="(?:"+en+"(?:"+[Kt,Jt,Zt].join("|")+")"+sn+rn+")*",on=sn+rn+an,ln="(?:"+[Ht,Jt,Zt].join("|")+")"+on,dn="(?:"+[Kt+Bt+"?",Bt,Jt,Zt,Ut].join("|")+")",cn=RegExp(Bt,"g"),un=RegExp(Yt+"(?="+Yt+")|"+dn+on,"g"),mn=RegExp("["+en+At+qt+Tt+Nt+"]"),pn=/[a-zA-Z0-9]+/g,fn=RegExp([Xt+"?"+Qt+"+(?="+[Wt,Xt,"$"].join("|")+")",nn+"+(?="+[Wt,Xt+tn,"$"].join("|")+")",Xt+"?"+tn+"+",Xt+"+",zt,ln].join("|"),"g"),_n=/[a-z][A-Z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,vn=["Array","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Reflect","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],gn=-1,hn={};hn[ze]=hn[He]=hn[Qe]=hn[Ve]=hn[Ye]=hn[Ge]=hn[Ke]=hn[Je]=hn[Ze]=!0,hn[xe]=hn[Ae]=hn[Be]=hn[qe]=hn[Te]=hn[Re]=hn[$e]=hn[je]=hn[Ie]=hn[Me]=hn[Fe]=hn[Ne]=hn[Le]=hn[We]=!1;var bn={};bn[xe]=bn[Ae]=bn[Be]=bn[qe]=bn[Te]=bn[ze]=bn[He]=bn[Qe]=bn[Ve]=bn[Ye]=bn[je]=bn[Ie]=bn[Me]=bn[Fe]=bn[Ne]=bn[Le]=bn[Ue]=bn[Ge]=bn[Ke]=bn[Je]=bn[Ze]=!0,bn[Re]=bn[$e]=bn[We]=!1;var yn={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss"},wn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Cn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Sn={function:!0,object:!0},On={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},kn=parseFloat,Dn=parseInt,En=Sn[typeof t]&&t&&!t.nodeType?t:null,xn=Sn[typeof e]&&e&&!e.nodeType?e:null,An=$(En&&xn&&"object"==typeof s&&s),qn=$(Sn[typeof self]&&self),Tn=$(Sn[typeof window]&&window),Rn=(xn&&xn.exports===En?En:null,$(Sn[typeof this]&&this)),$n=An||Tn!==(Rn&&Rn.window)&&Tn||qn||Rn||Function("return this")(),Pn=G();(Tn||qn||{})._=Pn,r=function(){return Pn}.call(t,n,t,e),!(r!==K&&(e.exports=r))}).call(this)}).call(t,n(70)(e),function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t,n,r){var s=[],a=!0,i=!1,o=void 0;try{for(var l,d=function(){var e=l.value;switch(e.type_code){case"ADD_EXTRAS":var a=!0,i=!1,o=void 0;try{for(var d,c=(0,p.default)(e.items);!(a=(d=c.next()).done);a=!0){var u=d.value,m=f(u.id,r);if(null!==m&&"options"===m.type){var _=m.item.retail_price;n&&(m.item.retail_price=0,m.item.special_name=n.name);var v={type_code:e.type_code,item:m.item,item_original_retail_price:_,original_item:r.order.items[m.department.id]};s.push(v),r.order.items[m.department.id]=m.item}}}catch(e){i=!0,o=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw o}}break;case"MAKE_SELECTION":var g=e.selection.item,h=f(g.id,r);null!==h&&(s.push({type_code:e.type_code,department:h.department,original_item:r.order.items[h.department.id]}),r.order.items[h.department.id]=h.item,h.department.changed=!0);break;case"PRICE_MULTIPLY":var b=r.priceMultiplyItems(e.item,e.items);t.price_multiply=b.totalQuantity,r.internal.price_multiplies.push(t),s.push({type_code:e.type_code,item:t,rule:e});break;case"MARK_PLAN":if(e.file_upload){var y="rule"+e.id;r.internal.file_uploads[y]={name:e.file_upload.name,percentage:0},r.uploader.upload({url:"/api/orders/rule-plan-upload",data:{order_id:r.order.id,sku_id:t.id,notes:e.file_upload_notes},file:e.file_upload}).then(function(t){delete r.internal.file_uploads[y],s.push({type_code:e.type_code,rule_plan_id:t.data.rule_plan_id})},function(e){console.log("Error status: "+e.status)},function(e){var t=parseInt(100*e.loaded/e.total);r.internal.file_uploads[y].percentage=t})}break;case"FORCE_SELECTION":var w=!0,C=!1,S=void 0;try{for(var O,k=(0,p.default)(e.items);!(w=(O=k.next()).done);w=!0){var D=O.value,E=f(D.id,r);s.push({type_code:e.type_code,department:E.department,original_item:r.order.items[E.department.id]}),null!==E&&(r.order.items[E.department.id]=E.item,E.department.changed=!0)}}catch(e){C=!0,S=e}finally{try{!w&&k.return&&k.return()}finally{if(C)throw S}}break;case"FORCE_UNSELECTION":var x=!0,A=!1,q=void 0;try{for(var T,R=(0,p.default)(e.items);!(x=(T=R.next()).done);x=!0){var $=T.value,P=f($.id,r);null!==P&&(s.push({type_code:e.type_code,department:P.department,original_item:r.order.items[P.department.id]}),delete r.order.items[P.department.id],P.department.changed=!0);
}}catch(e){A=!0,q=e}finally{try{!x&&R.return&&R.return()}finally{if(A)throw q}}}e.applied=!0},c=(0,p.default)(e);!(a=(l=c.next()).done);a=!0)d()}catch(e){i=!0,o=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw o}}return t&&(t.undo_rules=s),s}function a(e,t){if(void 0!==e){var n=!0,r=!1,s=void 0;try{for(var a,i=function(){var e=a.value;switch(e.type_code){case"ADD_EXTRAS":t.order.items[e.item.sku_category]=e.original_item,e.item.retail_price=e.item_original_retail_price,e.item.special_name=void 0;break;case"PRICE_MULTIPLY":delete e.item.price_multiply,t.internal.price_multiplies=t.internal.price_multiplies.filter(function(t){return t.id!==e.item.id});break;case"MARK_PLAN":t.post("rule-plan-remove",{rule_plan_id:e.rule_plan_id});break;case"MAKE_SELECTION":case"FORCE_SELECTION":case"FORCE_UNSELECTION":t.order.items[e.department.id]=e.original_item}},o=(0,p.default)(e);!(n=(a=o.next()).done);n=!0)i()}catch(e){r=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw s}}}}function i(e,t,n){var r=[],s=[],a=0,i=0,o=!0,l=!1,d=void 0;try{for(var c,u=(0,p.default)(t);!(o=(c=u.next()).done);o=!0){var m=c.value,_=f(m.id,n);null!==_&&(n.order.items[found_item.department.id].id===m.id||"options"===_.type&&n.order.items[found_item.department.id])?(r.push(m),i+=m.quantity||1,a+=m.quantity*e.retail_price):s.push(m)}}catch(e){l=!0,d=e}finally{try{!o&&u.return&&u.return()}finally{if(l)throw d}}return{applicableItems:r,otherItems:s,totalPrice:a,totalQuantity:i}}function o(e){if(e.internal){var t=!0,n=!1,r=void 0;try{for(var s,a=(0,p.default)(e.internal.price_multiplies);!(t=(s=a.next()).done);t=!0){var o=s.value,l=0,d=!0,c=!1,u=void 0;try{for(var m,f=(0,p.default)(o.undo_rules.filter(function(e){return"PRICE_MULTIPLY"===e.type_code}));!(d=(m=f.next()).done);d=!0){var _=m.value,v=i(_.rule.item,_.rule.items,e);l+=v.totalQuantity}}catch(e){c=!0,u=e}finally{try{!d&&f.return&&f.return()}finally{if(c)throw u}}o.price_multiply=l}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}}function l(e,t){var n=!0,r=!0,s=!1,a=void 0;try{for(var i,o=(0,p.default)(e);!(r=(i=o.next()).done);r=!0){var l=i.value,d=f(l.id,t);if(null===d||!(t.order.items[found_item.department.id].id===l.id||"options"===d.type&&t.order.items[found_item.department.id])){n=!1;break}}}catch(e){s=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}return n}function d(e){if(e.hasAppliedShowSpecial()){var t=e.order.show_special;t.undo_rules=s(t.rules,null,null,t,e)}}function c(e){if(e.hasAppliedShowSpecial()){var t=e.order.show_special,n=0,r=!0,s=!1,a=void 0;try{for(var i,o=(0,p.default)(t.rules);!(r=(i=o.next()).done);r=!0){var d=i.value;"PRICE_ADJUSTMENT"===d.type_code&&(d.applied=l(d.items,e),d.applied&&(n+=parseFloat(d.price_adjustment||0)))}}catch(e){s=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}t.value=n}}function u(e){o(e)}Object.defineProperty(t,"__esModule",{value:!0});var m=n(1),p=r(m);t.applyRules=s,t.unapplyRules=a,t.priceMultiplyItems=i,t.updatePriceMultiplies=o,t.applyShowSpecialRules=d,t.updateShowSpecialValue=c,t.updateRules=u;var f=function(e,t){var n=!0,r=!1,s=void 0;try{for(var a,i=(0,p.default)(t.info.items);!(n=(a=i.next()).done);n=!0){var o=a.value,l=!0,d=!1,c=void 0;try{for(var u,m=(0,p.default)(o.departments);!(l=(u=m.next()).done);l=!0)for(var f=u.value,_=["selections","upgrades","options"],v=0;v<_.length;v++){var g=_[v],h=!0,b=!1,y=void 0;try{for(var w,C=(0,p.default)(f[g]);!(h=(w=C.next()).done);h=!0){var S=w.value;if(S.id==e)return{category:o,department:f,item:S,type:g}}}catch(e){b=!0,y=e}finally{try{!h&&C.return&&C.return()}finally{if(b)throw y}}}}catch(e){d=!0,c=e}finally{try{!l&&m.return&&m.return()}finally{if(d)throw c}}}}catch(e){r=!0,s=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw s}}return null}},,,,,,,,function(e,t,n){var r=n(21),s=n(7)("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||a[s]===e)}},function(e,t,n){var r=n(12);e.exports=function(e,t,n,s){try{return s?t(r(n)[0],n[1]):t(n)}catch(t){var a=e.return;throw void 0!==a&&r(a.call(e)),t}}},,function(e,t,n){var r=n(7)("iterator"),s=!1;try{var a=[7][r]();a.return=function(){s=!0},Array.from(a,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!s)return!1;var n=!1;try{var a=[7],i=a[r]();i.next=function(){return{done:n=!0}},a[r]=function(){return i},e(a)}catch(e){}return n}},,,,function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(12),s=n(17),a=n(51);e.exports=function(e,t){if(r(e),s(t)&&t.constructor===e)return t;var n=a.f(e),i=n.resolve;return i(t),n.promise}},,function(e,t,n){var r=n(12),s=n(36),a=n(7)("species");e.exports=function(e,t){var n,i=r(e).constructor;return void 0===i||void 0==(n=r(i)[a])?t:s(n)}},function(e,t,n){var r,s,a,i=n(27),o=n(211),l=n(76),d=n(49),c=n(6),u=c.process,m=c.setImmediate,p=c.clearImmediate,f=c.MessageChannel,_=c.Dispatch,v=0,g={},h="onreadystatechange",b=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},y=function(e){b.call(e.data)};m&&p||(m=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return g[++v]=function(){o("function"==typeof e?e:Function(e),t)},r(v),v},p=function(e){delete g[e]},"process"==n(26)(u)?r=function(e){u.nextTick(i(b,e,1))}:_&&_.now?r=function(e){_.now(i(b,e,1))}:f?(s=new f,a=s.port2,s.port1.onmessage=y,r=i(a.postMessage,a,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(r=function(e){c.postMessage(e+"","*")},c.addEventListener("message",y,!1)):r=h in d("script")?function(e){l.appendChild(d("script"))[h]=function(){l.removeChild(this),b.call(e)}}:function(e){setTimeout(i(b,e,1),0)}),e.exports={set:m,clear:p}},,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),i=s(a),o=n(71),l=r(o);t.default=function(e){e.controller("OrderCaravanController",["$http","$log","$q","$scope","$state","$sce","ApiService","AppSettings","OrderService","TestSettings","Upload",function(e,t,n,r,s,a,o,d,c,u,m){r.tabData=[{heading:"Model & Series",route:"order.caravan.modelseries"},{heading:"Weight & Size",route:"order.caravan.weightsize"},{heading:"Features",route:"order.caravan.features"}],r.internal={price_multiplies:[],file_uploads:{}},r.special_features_expanded=!1,r.options_upgrades_expanded=!1,r.uploader=m,r.priceMultiplyItems=function(e,t){return l.priceMultiplyItems(e,t,r)};var p=function(e){var t=!0,n=!1,s=void 0;try{for(var a,o=(0,i.default)(e.options);!(t=(a=o.next()).done);t=!0){var l=a.value,d=r.order.items[e.id];d&&(d.available=!0),l.available=!d||d.id==l.id}}catch(e){n=!0,s=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw s}}};r.onOpenOptions=function(e){r.optionsByDepartment=r.getDepartmentsWithAvailableOptions(e);var t=!0,n=!1,s=void 0;try{for(var a,o=(0,i.default)(r.optionsByDepartment);!(t=(a=o.next()).done);t=!0){var l=a.value;p(l)}}catch(e){n=!0,s=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw s}}$("#options.modal").modal({backdrop:"static"})},r.onOpenTotals=function(){var e=r.calculatePrice().detail;r.totals=e,$("#totals.modal").modal({backdrop:"static"})},r.onOpenSpecials=function(){$("#specials.modal").modal({backdrop:"static"})},r.onPrintPdfClick=function(e){var t=$(e.target).closest("a").attr("href");u.DISABLE_PDF&&(t+=t.indexOf("?")!==-1?"&":"?",t+="is_html=1");var n=u.DISABLE_PDF?"_self":"_blank";e.preventDefault(),r.checkAndConfirmSave().then(function(){window.open(t,n)})},r.onOpenSeriesPhotos=function(){r.view_photos=r.info.series_detail.photos,$("#photos.modal").modal({backdrop:"static"})},r.onOpenSeriesPlans=function(){r.view_photos=r.info.series_detail.plans,$("#photos.modal").modal({backdrop:"static"})},r.onItemSelect=function(e,t){var n=!r.order.items[e.id]||r.order.items[e.id].id!=t.id,s=function(){r.order.items[e.id]=t,e.changed=e.changed||n,l.updateRules(r)};r.post("item-rules",{sku_id:t.id,series_id:r.order.series}).then(function(n){var a=n.data.rules;r.info.rules=a,a.length?(r.cancelRules=function(){},r.acceptRules=function(n){if(n&&n.$valid){var i=r.order.items[e.id];i&&l.unapplyRules(i.undo_rules,r),l.applyRules(a,t,null,r),s(),$("#rules.modal").modal("hide")}},$("#rules.modal").modal({})):s()})},r.onItemPhotoClick=function(e){if("undefined"==typeof e.available){var t=f(e.sku_category);p(t)}e.available!==!1&&(r.view_photos=[{url:e.photo}],r.view_header=e.public_description,$("#photos.modal").modal({backdrop:"static"}))},r.isUpgrade=function(e,t){return"undefined"!=typeof t&&e.upgrades.filter(function(e){return e.id==t.id}).length};var f=function(e){var t=!0,n=!1,s=void 0;try{for(var a,o=(0,i.default)(r.info.items);!(t=(a=o.next()).done);t=!0){var l=a.value,d=!0,c=!1,u=void 0;try{for(var m,p=(0,i.default)(l.departments);!(d=(m=p.next()).done);d=!0){var f=m.value;if(f.id==e)return f}}catch(e){c=!0,u=e}finally{try{!d&&p.return&&p.return()}finally{if(c)throw u}}}}catch(e){n=!0,s=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw s}}};r.onOptionSelect=function(e){var t=f(e.sku_category);"undefined"==typeof e.available&&p(t),!e.special_name&&e.available&&(r.order.items[t.id]?delete r.order.items[t.id]:r.order.items[t.id]=e,t.changed=!0,p(t),l.updateRules(r))},r.getDepartmentsMissingSelection=function(e){var t=[],n=!0,s=!1,a=void 0;try{for(var o,l=(0,i.default)(e.departments);!(n=(o=l.next()).done);n=!0){var d=o.value;(d.selections.length>0||d.upgrades.length>0)&&!r.order.items[d.id]&&t.push(d)}}catch(e){s=!0,a=e}finally{try{!n&&l.return&&l.return()}finally{if(s)throw a}}return t},r.hasSpecialFeatureForDepartment=function(e,t){return!1}}])},e.exports=t.default},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(195),i=s(a),o=n(190),l=s(o),d=n(14),c=s(d),u=n(1),m=s(u),p=n(71),f=r(p);t.default=function(e){n(128)(e),n(123)(e),n(129)(e),n(127)(e),n(126)(e),e.controller("OrderController",["$anchorScroll","$filter","$http","$interval","$location","$log","$q","$rootScope","$sce","$scope","$state","$timeout","$window","ApiService","AppSettings","OrderApiService","OrderService",function(e,t,r,s,a,o,d,u,p,_,v,g,h,b,y,w,C){n(92),_.tabData=[{heading:"Customer Details",route:"order.customer"},{heading:"Caravan Details",route:"order.caravan"},{heading:"Status / Documents / History",route:"order.status"},{heading:"Special Features",route:"order.special_features"},{heading:"Certificates ",route:"order.order_certificates"}],_.choices={departments:[],dealerships:[],models:[],states:[],series:{},delivery_min_date:new Date},_.info={series_detail:{},show_price:!0,rules:{item_description:"",item_rules:[]}},_.chassis_lookup={loading:!1,no_results:!1},_.loading={items:!1,extras:!1,order:!1},_.GST_PERCENT=.1,_.cango=!0,_.stock=0,_.order=C,_.messages=p.trustAsHtml(n(294)),_.editCurrentCustomer=!1,u.$on("$stateChangeStart",function(){u.message=null}),_.post=function(e,t){return b.post("orders/"+e,t)};var S=function(){if(_.order.delivery_date){var e=!0,t=!1,n=void 0;try{for(var r,s=(0,m.default)(_.choices.available_delivery_months);!(e=(r=s.next()).done);e=!0){var a=r.value,i=a.value;if(_.order.delivery_date.getTime()==i.getTime()){_.order.delivery_date=i;break}}}catch(e){t=!0,n=e}finally{try{!e&&s.return&&s.return()}finally{if(t)throw n}}}},O=function(){var e={},t={},n=!0,r=!1,s=void 0;try{for(var a,i=(0,m.default)(_.choices.categories);!(n=(a=i.next()).done);n=!0){var o=a.value;e[o.id]=o;var l=!0,d=!1,c=void 0;try{for(var u,p=(0,m.default)(o.departments);!(l=(u=p.next()).done);l=!0){var f=u.value;t[f.id]={department:f,parent:o}}}catch(e){d=!0,c=e}finally{try{!l&&p.return&&p.return()}finally{if(d)throw c}}}}catch(e){r=!0,s=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw s}}var v=!0,g=!1,h=void 0;try{for(var b,y=(0,m.default)(_.order.special_features);!(v=(b=y.next()).done);v=!0){var w=b.value;if(w.sku_category){var C=e[w.sku_category];C&&(w.selectedCategory=C);var S=t[w.sku_category];S&&(w.selectedDepartment=S.department,w.selectedCategory=S.parent),_.onSpecialFeatureCategorySelect(w),_.onSpecialFeatureDepartmentSelect(w)}}}catch(e){g=!0,h=e}finally{try{!v&&y.return&&y.return()}finally{if(g)throw h}}},k=function(){S(),O()};_.post("initial-data",{order_id:_.order.id,dealership_id:_.order.dealership,customer_id:v.params.customerId}).then(function(e){_.choices.dealerships=e.data.dealerships,_.choices.categories=e.data.categories,_.choices.models=e.data.models,_.choices.states=e.data.states,_.choices.acquisition_source=e.data.acquisition_source,_.choices.source_of_awareness=e.data.source_of_awareness,_.choices.shows=e.data.shows,_.permissions=e.data.permissions,_.choices.available_delivery_months=[];var n=e.data.available_delivery_months;_.permissions.manual_override&&(n=e.data.all_delivery_months);var r=!0,s=!1,a=void 0;try{for(var i,o=(0,m.default)(n);!(r=(i=o.next()).done);r=!0){var l=i.value,d=new Date(Date.parse(l)),c=e.data.available_delivery_months.indexOf(l)!=-1;_.choices.available_delivery_months.push({title:t("date")(d,y.FORMAT_DATE_MONTH_SHORT_JS)+(c?"":" *"),value:d})}}catch(e){s=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}k(),0==_.permissions.create_order&&0==_.permissions.view_order&&(h.location.href="/orders/list"),1==_.choices.dealerships.length&&(_.order.dealership=_.choices.dealerships[0].id),e.data.customer_info&&_.select_customer(e.data.customer_info),_.$watch("order.special_features",function(e,t){angular.equals(e,t)||(_.order.special_features_changed=!0)},!0)}),_.lookupChassis=function(e){return _.chassis_lookup.loading=!0,_.chassis_lookup.no_results=!1,_.post("chassis-lookup",{chassis_string:e}).then(function(e){return e.data.list.length?e.data.list:void(_.chassis_lookup.no_results=!0)})},_.onChassisSelect=function(){_.post("from-chassis",{order_id:_.data.from_chassis}).then(function(e){_.order.series=e.data.data.series,_.order.model=e.data.data.model,_.onModelSelect(),_.onSeriesSelect()})};var D="This will reset the details of the order. Are you sure you want to continue?";_.isModelEditable=function(){return["ORDER_FINALIZED"].indexOf(_.order.order_stage_details.code)==-1&&_.order.isEditable()},_.onModelChange=function(){!_.order.model||confirm(D)?(_.order.model=_.order.modelSelection,_.order.series=null,_.order.resetOrderItems(),_.onModelSelect()):_.order.modelSelection=_.order.model},_.onModelSelect=function(){return _.order.model?void _.post("model-series",{model_id:_.order.model,dealership_id:_.order.dealership}).then(function(e){_.choices.series=e.data.series,_.info.model_detail=e.data.model_detail,_.permissions=e.data.permissions,_.choices.available_delivery_months=[];var n=e.data.available_delivery_months;_.permissions.manual_override&&(n=e.data.all_delivery_months);var r=!0,s=!1,a=void 0;try{for(var i,o=(0,m.default)(n);!(r=(i=o.next()).done);r=!0){var l=i.value,d=new Date(Date.parse(l)),c=e.data.available_delivery_months.indexOf(l)!=-1;_.choices.available_delivery_months.push({title:t("date")(d,y.FORMAT_DATE_MONTH_SHORT_JS)+(c?"":" *"),value:d})}}catch(e){s=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}_.onDeliveryChange()}):void(_.choices.series=[])},_.onSeriesChange=function(){!_.order.series||confirm(D)?(_.order.series=_.order.seriesSelection,_.order.resetOrderItems(),_.onSeriesSelect()):_.order.seriesSelection=_.order.series,_.calculatePrice()},_.onSeriesSelect=function(){return _.order.series?void _.post("series-detail",{series_id:_.order.series,order_id:_.order.id,required_date:_.order.delivery_date}).then(function(e){_.info.series_detail=e.data,_.specials=_.info.series_detail.show_specials,_.all_delivery_months=_.info.series_detail.all_delivery_months;_.all_delivery_months;_.available_delivery_months=_.info.series_detail.available_delivery_months;var n=_.available_delivery_months;_.avg_tare_weight=_.info.series_detail.avg_tare_weight,_.avg_ball_weight=_.info.series_detail.avg_ball_weight,_.permissions=_.info.series_detail.permissions,_.choices.available_delivery_months=[],_.permissions.manual_override&&(n=e.data.all_delivery_months);var r=!0,s=!1,a=void 0;try{for(var i,o=(0,m.default)(n);!(r=(i=o.next()).done);r=!0){var l=i.value,d=new Date(Date.parse(l)),c=e.data.available_delivery_months.indexOf(l)!=-1;_.choices.available_delivery_months.push({title:t("date")(d,y.FORMAT_DATE_MONTH_SHORT_JS)+(c?"":" *"),value:d})}}catch(e){s=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}_.onDeliveryChange(),_.loadFeatures(),_.calculatePrice()}):(_.choices.available_delivery_months=[],void(_.choices.available_delivery_months=[]))},_.orderLookupData=function(){return{dealership:_.order.dealership}},_.onDeliveryChange=function(){if(_.order.delivery_date){var e=!0,t=!1,n=void 0;try{for(var r,s=(0,m.default)(_.choices.available_delivery_months);!(e=(r=s.next()).done);e=!0){var a=r.value,i=a.value;if(_.order.delivery_date.getTime()==i.getTime()){_.order.delivery_date=i;break}}}catch(e){t=!0,n=e}finally{try{!e&&s.return&&s.return()}finally{if(t)throw n}}}},_.onOrderLookupSelect=function(e){_.orderLookupResultId=e.id},_.assignSelectedOrderAndProceed=function(){_.order.loadOrderDetails_duplicate(_.orderLookupResultId,!1).then(function(){C.saveOrder().then(function(){_.onModelSelect(),_.onSeriesSelect(),_.loadFeatures(),v.go("order.caravan.weightsize")})})},_.current_dealership=function(){var e=_.choices.dealerships.filter(function(e){return e.id==_.order.dealership});return e.length?e[0]:null},_.createMessage=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;("undefined"==typeof n?"undefined":(0,c.default)(n))==(0,c.default)("")&&(n=[n]),u.message={type:t,message_list:n},e("message-anchor"),null!==r&&s(function(){u.message=null},r,1)};var E=function(){var e=v.href("order.customer",{orderId:_.order.id}).split("/").slice(1).join("/");a.path(e)};_.proceedDealerOrder=function(e){var t=e&&e.$valid;t&&(_.order.order_type="Stock",_.order.order_stage_details&&"ORDER_FINALIZED"==_.order.order_stage_details.code&&(_.order.update_customer_only=!0),C.saveOrder().then(function(){E(),g(function(){v.go("order.caravan.modelseries",{orderId:_.order.id})})}))},_.proceedCustomerOrder=function(e){var t=e&&e.$valid;if(_.cango=t,t){if(_.order.id&&"Stock"==_.order.order_type)return _.order.is_order_converted=!0,_.stock=1,void(_.order.order_type="Customer");if("Customer"==_.order.order_type&&1==_.order.is_order_converted){if(null==_.order.order_converted&&(alert("Please Enter Sales Date ! "),_.cango=!1),null!=_.order.order_converted){var n=_.order.order_converted,r=n.split("/"),s=new Date(r[1]+"/"+r[0]+"/"+r[2]),a=new Date;if(s>a)return alert(" Sales Date cannot Be greater than today ! "),void(_.cango=!1)}if(0==_.cango)return void(_.stock=1);1==_.cango&&(_.stock=0)}_.cango===!0&&(_.order.order_stage_details&&"ORDER_FINALIZED"==_.order.order_stage_details.code&&(_.order.update_customer_only=!0),_.order.order_type="Customer",C.saveOrder().then(function(){0==_.stock&&(delete _.order.update_customer_only,E(),v.go("order.caravan.modelseries",{orderId:_.order.id})),1==_.stock&&alert("Stock  Customer order converted 1")}))}},_.newOrderForCustomer=function(){C.saveNewOrderForCustomer().then(function(){E(),g(function(){v.go("order.caravan.modelseries",{orderId:_.order.id})})})},_.proceed=function(e){switch(v.current.name){case"order.customer":e&&e.$valid&&v.go("order.caravan.modelseries");break;case"order.caravan.modelseries":_.order.model&&_.order.series&&C.saveOrder().then(function(){v.go("order.caravan.weightsize"),_.onDeliveryChange(),_.loadFeatures()});break;case"order.caravan.weightsize":e&&e.$valid&&C.saveOrder().then(function(){v.go("order.caravan.features")})}},_.toggleWeightDisclaimer=function(){_.order.weight_estimate_disclaimer_time=new Date},_.removeFeatureDocument=function(e){delete e.new_document,delete e.document},_.hasAppliedShowSpecial=function(){return _.order.show_special&&_.order.show_special.applied};var x=function(e){var t=[],n=!0,r=!1,s=void 0;try{for(var a,i=(0,m.default)(e.departments);!(n=(a=i.next()).done);n=!0){var o=a.value;o.selections.length&&t.push(o)}}catch(e){r=!0,s=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw s}}return t};_.getDepartmentsWithAvailableOptions=function(e){var t=x(e);return e.departments.filter(function(e){return t.indexOf(e)==-1&&e.options.length})},_.getAvailableOptions=function(e){var t=[],n=x(e),r=!0,s=!1,a=void 0;try{for(var i,o=(0,m.default)(e.departments);!(r=(i=o.next()).done);r=!0){var l=i.value;n.indexOf(l)==-1&&(t=t.concat(l.options))}}catch(e){s=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}return t},_.hasCategoryOptions=function(e){return _.getAvailableOptions(e).length},_.getSelectedOptions=function(e){var t=[],n=!0,r=!1,s=void 0;try{for(var a,i=(0,m.default)(_.getDepartmentsWithAvailableOptions(e));!(n=(a=i.next()).done);n=!0){var o=a.value;_.order.items[o.id]&&t.push(_.order.items[o.id])}}catch(e){r=!0,s=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw s}}return t},_.isItemSelected=function(e,t){return _.order.items[t.id]&&_.order.items[t.id].id==e.id},_.calculatePrice=function(){if(void 0===_.info.items||void 0===_.info.series_detail.retail_price)return 0;var e={manufacture:{caravan:parseFloat(_.info.series_detail.cost_price||0),upgrades:0,options:0,special_features:0,adjustments:_.order.price_adjustments.cost||0},wholesale:{caravan:parseFloat(_.info.series_detail.wholesale_price||0),upgrades:0,options:0,special_features:0,adjustments:(_.order.price_adjustments.wholesale||0)+(_.order.after_sales.wholesale||0)},retail:{caravan:parseFloat(_.info.series_detail.retail_price||0),upgrades:0,options:0,special_features:0,adjustments:(_.order.price_adjustments.retail||0)+(_.order.after_sales.retail||0)},options_upgrades:[],special_features:[]},t=!0,n=!1,r=void 0;try{for(var s,a=(0,m.default)(_.info.items);!(t=(s=a.next()).done);t=!0){var i=s.value,o=!0,l=!1,d=void 0;try{for(var c,u=(0,m.default)(i.departments);!(o=(c=u.next()).done);o=!0){var p=c.value;if(_.order.items[p.id]){var f=_.order.items[p.id],v=f.price_multiply||1,g=parseFloat(f.cost_price||0)*v,h=parseFloat(f.wholesale_price||0)*v,b=parseFloat(f.retail_price||0)*v;1==f.availability_type||5==f.availability_type||2==f.availability_type&&(e.manufacture.upgrades+=g,e.wholesale.upgrades+=h,e.retail.upgrades+=b,e.options_upgrades.push({name:f.name,manufacture:g,wholesale:h,retail:b}))}}}catch(e){l=!0,d=e}finally{try{!o&&u.return&&u.return()}finally{if(l)throw d}}var y=_.getSelectedOptions(i);if(y.length){var w=!0,C=!1,S=void 0;try{for(var O,k=(0,m.default)(y);!(w=(O=k.next()).done);w=!0){var D=O.value,E=D.price_multiply||1,x=parseFloat(D.cost_price||0)*E,A=parseFloat(D.wholesale_price||0)*E,q=parseFloat(D.retail_price||0)*E;e.options_upgrades.push({name:D.name,manufacture:x,wholesale:A,retail:q}),e.manufacture.options+=x,e.wholesale.options+=A,e.retail.options+=q}}catch(e){C=!0,S=e}finally{try{!w&&k.return&&k.return()}finally{if(C)throw S}}}}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}var T=!0,R=!1,$=void 0;try{for(var P,j=(0,m.default)(_.order.special_features);!(T=(P=j.next()).done);T=!0){var I=P.value,M=parseFloat(I.retail_price||0),F=parseFloat(I.wholesale_price||0);e.retail.special_features+=M,e.wholesale.special_features+=F,e.special_features.push({name:I.customer_description,manufacture:0,wholesale:F,retail:M})}}catch(e){R=!0,$=e}finally{try{!T&&j.return&&j.return()}finally{if(R)throw $}}var N=function(e){return e.caravan+e.upgrades+e.options+e.special_features+e.adjustments};e.retail.total=N(e.retail),e.wholesale.total=N(e.wholesale),e.manufacture.total=N(e.manufacture);var L=0;_.hasAppliedShowSpecial()&&(L=parseFloat(_.order.show_special.price)||0,e.retail.total+=L);var U=function(e){return e.total-e.adjustments};return e.retail.totalNoAdjustment=U(e.retail),e.wholesale.totalNoAdjustment=U(e.wholesale),e.manufacture.totalNoAdjustment=U(e.manufacture),{detail:e,price:e.retail.total}},_.select_customer=function(e){_.order.customer=e,_.editCurrentCustomer=!1},_.select_physical_suburb=function(e){_.order.customer.physical_address.suburb=e},_.select_delivery_suburb=function(e){_.order.customer.delivery_address.suburb=e},_.select_invoice_suburb=function(e){_.order.customer.postal_address.suburb=e};var A=function(){var e=!0,t=!1,n=void 0;try{for(var r,s=(0,m.default)(_.info.items);!(e=(r=s.next()).done);e=!0){var a=r.value,i=!0,o=!1,l=void 0;try{for(var d,c=(0,m.default)(a.departments);!(i=(d=c.next()).done);i=!0){var u=d.value;u.changed=!1}}catch(e){o=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(o)throw l}}}}catch(e){t=!0,n=e}finally{try{!e&&s.return&&s.return()}finally{if(t)throw n}}_.order.special_features_changed=!1,_.order.price_changed=!1},q="Order details will be saved before continuing.";_.checkAndConfirmSave=function(){return new l.default(function(e,t){var n=function(){confirm(q)?_.saveOrder().then(e,t):t()};if(_.order.special_features_changed||_.order.price_changed)return void n();var r=!0,s=!1,a=void 0;try{for(var i,o=(0,m.default)(_.info.items);!(r=(i=o.next()).done);r=!0){var l=i.value,d=!0,c=!1,u=void 0;try{for(var p,f=(0,m.default)(l.departments);!(d=(p=f.next()).done);d=!0){var v=p.value;if(v.changed)return void n()}}catch(e){c=!0,u=e}finally{try{!d&&f.return&&f.return()}finally{if(c)throw u}}}}catch(e){s=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}e()})},_.saveOrder=function(){return"ORDER_FINALIZED"==_.order.order_stage_details.code&&"order.customer"===v.current.name&&(_.order.update_customer_only=!0),_.loading.order=!0,C.saveOrder().then(function(){_.order.update_customer_only?(delete _.order.update_customer_only,_.createMessage("alert-warning","Customer details saved.")):_.createMessage("alert-info","Details Saved."),k(),setTimeout(A,1)}).finally(function(){_.loading.order=!1})},_.requestOrderApproval=function(){_.checkAndConfirmSave().then(function(){_.loading.order=!0,C.requestOrder().then(function(){v.go("order.status",{},{reload:!0})}).finally(function(){_.loading.order=!1})},function(){})},_.rejectOrderApproval=function(){_.checkAndConfirmSave().then(function(){_.loading.order=!0,C.rejectOrder().then(function(){v.go("order.status",{},{reload:!0})}).finally(function(){_.loading.order=!1})},function(){})},_.placeOrder=function(){_.checkAndConfirmSave().then(function(){_.loading.order=!0,C.placeOrder().then(function(){v.go("order.status",{},{reload:!0}),_.order.last_server_error_message&&_.createMessage("alert-danger",_.order.last_server_error_message)}).finally(function(){_.loading.order=!1})},function(){})},_.confirmCancelOrder=function(){_.cancelReason="",$("#cancel_order.modal").modal({backdrop:"static"})},_.confirmPlaceOrder=function(){$("#place_order.modal").modal({backdrop:"static"})},_.cancelOrder=function(){C.cancelOrder(_.cancelReason).then(function(){v.go("order.status",{},{reload:!0})})},_.finalizeOrder=function(){_.checkAndConfirmSave().then(function(){_.loading.order=!0,C.finalizeOrder().then(function(){v.go("order.status",{},{reload:!0})}).finally(function(){_.loading.order=!1})},function(){})},_.canOrderBeSaved=function(){return _.order.isEditable()||_.permissions&&(_.permissions.modify_special_features||_.permissions.approve_special_features)},_.canOrderApprovalBeRejected=function(){return!!_.order.order_stage_details&&("ORDER_REQUESTED"==_.order.order_stage_details.code&&_.order.permissions.approve_order)},_.canOrderBeCancelled=function(){return!!_.order.order_stage_details&&(_.order.permissions.cancel_order&&("ORDER"==_.order.order_stage_details.code||"ORDER_FINALIZED"==_.order.order_stage_details.code))},_.canOrderApprovalBeRequested=function(){return!(!_.order.order_stage_details||_.order.is_expired||_.order.has_missing_selections)&&(("QUOTE"==_.order.order_stage_details.code||"QUOTE_SELECTIONS"==_.order.order_stage_details.code||"ORDER_REJECTED"==_.order.order_stage_details.code)&&_.order.permissions.request_order_approval)},_.canOrderBePlaced=function(){return!(!_.order.order_stage_details||_.order.is_expired||_.order.has_missing_selections)&&("ORDER_REQUESTED"==_.order.order_stage_details.code&&_.order.permissions.approve_order)},_.canOrderBeFinalized=function(){return!(!_.order.order_stage_details||_.order.is_expired||_.order.has_missing_selections||_.order.special_features.length&&!_.order.special_features_approved)&&("ORDER"==_.order.order_stage_details.code&&(_.order.permissions.finalize_order||_.order.permissions.lock_order))},_.canOrderPricesBeSaved=function(){return!!_.order.order_stage_details&&("ORDER_FINALIZED"==_.order.order_stage_details.code&&_.order.permissions.modify_retail_prices_finalized)},_.canCreateOrderForSameCustomer=function(){return _.order.id&&_.permissions&&_.permissions.create_order&&_.order.customer},_.updateSalesforce=function(){_.post("update-salesforce",{order_id:_.order.id}).then(function(){C.retrieveOrder(_.order.id)})},_.applyShowSpecial=function(e){_.order.show_special&&_.order.show_special.applied&&_.unapplyShowSpecial(_.order.show_special),_.order.show_special=e,e.applied=!0,f.applyShowSpecialRules(_),f.updateRules(_)},_.unapplyShowSpecial=function(e){f.unapplyRules(e.undo_rules,_),e.applied=!1,_.order.show_special=null},_.loadFeatures=function(){_.loading.items||(_.loading.items=!0,w.getFeatures(_.order.series,_.order.id,_.order.delivery_date).then(function(e){if(_.info.items=e.categories,T(),_.order.show_special_id){var t=!0,n=!1,r=void 0;try{for(var s,a=(0,m.default)(_.specials);!(t=(s=a.next()).done);t=!0){var i=s.value;if(i.id==_.order.show_special_id){_.order.show_special=i;break}}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}_.applyShowSpecial(_.order.show_special)}}).finally(function(){_.loading.items=!1}))};var T=function(){var e=_.order;if("ORDER_FINALIZED"!=e.order_stage_details.code){var t=!0,n=!1,r=void 0;try{for(var s,a=(0,m.default)(_.info.items);!(t=(s=a.next()).done);t=!0){var i=s.value,o=!0,l=!1,d=void 0;try{for(var c,u=(0,m.default)(i.departments);!(o=(c=u.next()).done);o=!0){var p=c.value,f=e.items[p.id];if(f&&R(f,p))P(f,p)||(p.changed=!0);else if(1==p.selections.length){var v=p.selections[0];f&&f.id==v.id&&f.availability_type==v.availability_type||(p.changed=!0),e.items[p.id]=v}else f&&(p.changed=!0),delete e.items[p.id]}}catch(e){l=!0,d=e}finally{try{!o&&u.return&&u.return()}finally{if(l)throw d}}}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}},R=function(e,t){for(var n=["selections","upgrades","options"],r=0;r<n.length;r++){var s=n[r],a=!0,i=!1,o=void 0;try{for(var l,d=(0,m.default)(t[s]);!(a=(l=d.next()).done);a=!0){var c=l.value;if(c.id==e.id)return!0}}catch(e){i=!0,o=e}finally{try{!a&&d.return&&d.return()}finally{if(i)throw o}}}return!1},P=function(e,t){for(var n=["selections","upgrades","options"],r=0;r<n.length;r++){var s=n[r],a=!0,i=!1,o=void 0;try{for(var l,d=(0,m.default)(t[s]);!(a=(l=d.next()).done);a=!0){var c=l.value;if(c.id==e.id)return c.availability_type==e.availability_type}}catch(e){i=!0,o=e}finally{try{!a&&d.return&&d.return()}finally{if(i)throw o}}}return!1};_.order.validModel()&&_.onModelSelect(),_.order.validSeries()&&_.onSeriesSelect(),_.onOpenTradeInComment=function(){$("#trade_in_comment.modal").modal({backdrop:"static"})},_.onOpenConditions=function(){$("#order_conditions.modal").modal({backdrop:"static"})},_.onOpenAfterMarketNote=function(){$("#after_market_note.modal").modal({backdrop:"static"})},_.isCustomerEditable=function(){return _.order.id&&!_.order.isStockOrder()||!(_.order.customer&&_.order.customer.id)||_.editCurrentCustomer;
},_.clearCustomer=function(){_.order.resetCustomer(),_.search={}},_.editCustomerFields=function(){_.editCurrentCustomer=!0},_.checkdisplayview=function(){if(16===_.order.model||12===_.order.model||2===_.order.model){if(1===_.permissions.user_details)return 0;if(0===_.permissions.user_details)return 1}else{if(1===_.permissions.user_details)return 1;if(0===_.permissions.user_details)return 1}},_.replaceItem="",_.workcenter="",_.catname="",_.getCategory=function(e){var t={},n={};_.replaceItem="",_.workcenter="";var r=!0,s=!1,a=void 0;try{for(var i,o=(0,m.default)(_.choices.categories);!(r=(i=o.next()).done);r=!0){var l=i.value;t[l.id]=l;var d=!0,c=!1,u=void 0;try{for(var p,f=(0,m.default)(l.departments);!(d=(p=f.next()).done);d=!0){var v=p.value;n[v.id]={department:v,parent:l}}}catch(e){c=!0,u=e}finally{try{!d&&f.return&&f.return()}finally{if(c)throw u}}}}catch(e){s=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}var g=t[e.sku_category];g&&(_.catname=g.title);var h=n[e.sku_category];return h&&(e.selectedDepartment=h.department,e.selectedCategory=h.parent,_.workcenter=h.parent.title,_.replaceItem=h.department.title),_.workcenter||(_.workcenter=_.catname,_.replaceItem=e.factory_description,e.selectedCategory=_.workcenter,e.selectedDepartment=_.replaceItem),_.workcenter},_.onSpecialFeatureCategorySelect=function(e){e.departmentList=_.generateDepartmentsForCategory(e.selectedCategory),e.sku_category=e.selectedCategory?e.selectedCategory.id:null},_.onSpecialFeatureDepartmentSelect=function(e){e.selectedDepartment?e.sku_category=e.selectedDepartment.id:e.sku_category=e.selectedCategory.id},_.generateDepartmentsForCategory=function(e){var t=[];if(!e)return onFeatureDetailChange,t;var n=!0,r=!1,s=void 0;try{for(var a,o=(0,m.default)(e.departments);!(n=(a=o.next()).done);n=!0){var l=a.value,d=_.order.items[l.id];d&&t.push({id:l.id,title:d.public_description})}}catch(e){r=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw s}}var c=e.departments.filter(function(e){return 0==t.filter(function(t){return t.id==e.id}).length});return[].concat(t,[{id:null,title:"--------------------------------------------------"}],(0,i.default)(c))},_.addSpecialFeature=function(){var e={};_.onFeatureDetailChange(e),_.order.special_features.push(e)},_.removeSpecialFeature=function(e){_.order.special_features.splice(e,1)},_.onFeatureDetailChange=function(e){e.approved=null},_.onPrintAutocad=function(){_.checkAndConfirmSave().then(function(){window.open("/orders/autocad/"+_.order.id+"/","_blank")})}}])},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("datetimepickerNeutralTimezone",function(){return{restrict:"A",priority:1,require:"ngModel",link:function(e,t,n,r){r.$formatters.push(function(e){if(e){var t=new Date(Date.parse(e));return t=new Date(t.getTime()+6e4*t.getTimezoneOffset())}}),r.$parsers.push(function(e){if(e){var t=new Date(e.getTime()-6e4*e.getTimezoneOffset());return t}return null})}}}),e.directive("statusRow",["AppSettings",function(e){return{restrict:"E",transclude:!0,template:n(305),scope:{stage:"=",title:"@",permission:"="},link:function(t){t.AppSettings=e,t.statusClass=function(e){if(e)switch(e.status){case"Complete":return"complete";case"Optional":return"optional";case"Requires Action":return"requires-action";case"Rejected":return"rejected"}}}}}])},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(2),a=r(s),i=n(3),o=r(i);t.default=function(e){e.factory("OrderApiService",["ApiService",function(e){var t=function(){function t(){(0,a.default)(this,t)}return(0,o.default)(t,[{key:"getFeatures",value:function(t,n,r){return e.getData("orders/series-items",{series_id:t,order_id:n,required_date:r})}}]),t}();return new t}])},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(64),a=r(s),i=n(276),o=r(i),l=n(2),d=r(l),c=n(3),u=r(c);t.default=function(e){e.factory("OrderService",["ApiService","AppSettings","Upload","$q",function(e,t,n,r){var s=function(){function s(){(0,d.default)(this,s),this.resetOrder()}return(0,u.default)(s,[{key:"resetOrder",value:function(){this.resetOrderExceptCustomer(),this.resetCustomer(),this.resetPermissions()}},{key:"resetOrderExceptCustomer",value:function(){this.resetOrderMainData(),this.resetOrderItems()}},{key:"resetOrderMainData",value:function(){this.id=null,this.model=null,this.series=null,this.custom_series_name=null,this.custom_series_code=null,this.series_description=null,this.series_code=null,this.production_month=null,this.production_start_date=null,this.modelSelection=null,this.seriesSelection=null,this.chassis=null,this.appretail_opportunity_no=null,this.order_type=null,this.delivery_date=null,this.dealership=null,this.dealer_sales_rep_name=null,this.customer_manager_name=null,this.order_stage_details=null,this.dealership_name=null,this.original={},this.show_id=null,this.is_expired=!1,this.base_order=null,this.customer_plans_approved=!1,this.is_order_converted=!1,this.order_converted=null,this.salesforce_sync_error=null}},{key:"resetOrderItems",value:function(){this.weight_estimate_disclaimer=!1,this.custom_tare_weight=null,this.custom_ball_weight=null,this.show_special_id=null,this.price_adjustments={cost:0,wholesale:0,wholesale_comment:0,retail:0},this.after_sales={wholesale:0,retail:0,description:""},this.dealer_load=0,this.trade_in_write_back=0,this.trade_in_comment=null,this.price_comment=null,this.show_special=null,this.orderconditions={},this.aftermarketnote={},this.has_missing_selections=!0,this.items={},this.special_features=[],this.special_features_approved=!1,this.special_features_changed=!1,this.price_changed=!1}},{key:"resetCustomer",value:function(){this.customer={physical_address:{},delivery_address:{},postal_address:{}}}},{key:"resetPermissions",value:function(){this.permissions=null}},{key:"isStageQuote",value:function(){return void 0===this.order_stage_details||null===this.order_stage_details||this.order_stage_details.number<=t.STAGE_QUOTE_SELECTIONS}},{key:"isStageQuoteEditable",value:function(){return null==this.permissions||this.isStageQuote()&&this.permissions.modify_order}},{key:"isCustomerVisible",value:function(){return null==this.id||this.permissions.list_customer}},{key:"isStageOrder",value:function(){return!this.isStageQuote()}},{key:"isStockOrder",value:function(){return"Stock"==this.order_type}},{key:"isEditable",value:function(){return!(this.order_stage_details&&!this.isStockOrder())||(!("QUOTE"!=this.order_stage_details.code&&"QUOTE_SELECTIONS"!=this.order_stage_details.code&&"ORDER_REJECTED"!=this.order_stage_details.code||!this.permissions.modify_order)||(!("ORDER_REQUESTED"!=this.order_stage_details.code&&"ORDER"!=this.order_stage_details.code||!this.permissions.modify_order_requested)||!("ORDER_FINALIZED"!=this.order_stage_details.code||!this.permissions.modify_order_finalized)))}},{key:"validCustomer",value:function(){return null!==this.type}},{key:"validModel",value:function(){return(0,o.default)(this.model)}},{key:"validSeries",value:function(){return(0,o.default)(this.series)}},{key:"validModelSeries",value:function(){return this.validModel()&&this.validSeries()}},{key:"validWeightSize",value:function(){var e=this.weight_estimate_disclaimer===!0;return e}},{key:"updateAddress",value:function(e,t){e.name=(0,a.default)(t,"name"),e.street=(0,a.default)(t,"address"),e.suburb=(0,a.default)(t,"suburb.name"),e.post_code=(0,a.default)(t,"suburb.post_code.number"),e.state=(0,a.default)(t,"suburb.post_code.state.id")}},{key:"updateOrder",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.model=e.model,this.series=e.series,this.custom_series_name=e.custom_series_name,this.custom_series_code=e.custom_series_code,this.series_description=e.series_description,this.series_code=e.series_code,this.production_month=e.production_month,this.production_start_date=e.production_start_date,this.modelSelection=e.model,this.seriesSelection=e.series,this.chassis=e.chassis,this.appretail_opportunity_no=e.appretail_opportunity_no,this.order_stage_details=e.order_stage_details,this.permissions=e.permissions,this.weight_estimate_disclaimer=e.weight_estimate_disclaimer_checked,this.custom_tare_weight=e.custom_tare_weight_kg,this.custom_ball_weight=e.custom_ball_weight_kg,this.price_adjustments.cost=parseFloat(e.price_adjustment_cost),this.price_adjustments.wholesale=parseFloat(e.price_adjustment_wholesale),this.price_adjustments.wholesale_comment=e.price_adjustment_wholesale_comment,this.price_adjustments.retail=parseFloat(e.price_adjustment_retail),this.dealer_load=parseFloat(e.dealer_load),this.trade_in_write_back=parseFloat(e.trade_in_write_back),this.trade_in_comment=e.trade_in_comment,this.after_sales.wholesale=parseFloat(e.after_sales_wholesale),this.after_sales.retail=parseFloat(e.after_sales_retail),this.after_sales.description=e.after_sales_description,this.price_comment=e.price_comment,this.orderconditions=e.orderconditions,this.aftermarketnote=e.aftermarketnote,this.is_expired=e.is_expired,this.base_order=e.id,this.has_missing_selections=e.has_missing_selections,this.items=e.items,this.price_changed=!1,this.customer_plans_approved=e.customer_plans_approved,this.special_features_approved=e.special_features_approved,this.salesforce_sync_error=e.salesforce_sync_error,t&&(console.log("full Updated "+this.delivery_date+" : "+e.delivery_date+" : "+new Date(Date.parse(e.delivery_date))),this.id=e.id,this.customer=e.customer,this.show_id=e.show,this.show_special_id=e.show_special_id,this.delivery_date=e.delivery_date?new Date(Date.parse(e.delivery_date)):"",this.special_features=e.special_features,this.special_features_changed=!1,this.is_order_converted=e.is_order_converted,this.order_converted=e.order_converted,this.last_server_error_message=e.last_server_error_message,this.order_type=e.order_type,this.dealership=e.dealership,this.dealer_sales_rep_name=e.dealer_sales_rep_name,this.customer_manager_name=e.customer_manager_name,this.dealership_name=e.dealership_name,this.appretail_opportunity_no=e.appretail_opportunity_no)}},{key:"updateOrder_duplicate",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.model=e.model,this.series=e.series,this.custom_series_name=e.custom_series_name,this.custom_series_code=e.custom_series_code,this.series_description=e.series_description,this.series_code=e.series_code,this.production_month=e.production_month,this.production_start_date=e.production_start_date,this.modelSelection=e.model,this.seriesSelection=e.series,this.chassis=e.chassis,this.appretail_opportunity_no=e.appretail_opportunity_no,this.order_stage_details=e.order_stage_details,this.permissions=e.permissions,this.weight_estimate_disclaimer=e.weight_estimate_disclaimer_checked,this.custom_tare_weight=e.custom_tare_weight_kg,this.custom_ball_weight=e.custom_ball_weight_kg,this.price_comment=e.price_comment,this.orderconditions=e.orderconditions,this.aftermarketnote=e.aftermarketnote,this.is_expired=e.is_expired,this.base_order=e.id,this.has_missing_selections=e.has_missing_selections,this.items=e.items,this.price_changed=!1,this.customer_plans_approved=e.customer_plans_approved,this.special_features_approved=e.special_features_approved,this.salesforce_sync_error=e.salesforce_sync_error,t&&(this.id=e.id,this.customer=e.customer,this.show_id=e.show,this.show_special_id=e.show_special_id,this.delivery_date=e.delivery_date?new Date(Date.parse(e.delivery_date)):"",this.special_features=e.special_features,this.special_features_changed=!1,this.is_order_converted=e.is_order_converted,this.order_converted=e.order_converted,this.last_server_error_message=e.last_server_error_message,this.order_type=e.order_type,this.dealership=e.dealership,this.dealer_sales_rep_name=e.dealer_sales_rep_name,this.customer_manager_name=e.customer_manager_name,this.dealership_name=e.dealership_name)}},{key:"loadOrderDetails",value:function(t){var n=this;return e.post("orders/retrieve-order",{order_id:t}).then(function(e){n.updateOrder(e.data,!1)})}},{key:"loadOrderDetails_duplicate",value:function(t){var n=this;return e.post("orders/retrieve-order",{order_id:t}).then(function(e){n.updateOrder_duplicate(e.data,!1)})}},{key:"retrieveOrder",value:function(t){var n=this,s=function(e){n.updateOrder(e.data)},a=function(e){return console.log("There was an error retrieving this order"),r.reject(e)};return e.post("orders/retrieve-order",{order_id:t}).then(s,a)}},{key:"saveOrder",value:function(){var e=this,t=function(t){return e.updateOrder(t.data),r.resolve(t)},s=function(e){return console.log("There was an error saving this order"),r.reject(e)},a={},i=1;return this.special_features.forEach(function(e){e.new_document&&(e.file_id=i++,a[e.file_id]=e.new_document)}),n.upload({method:"POST",url:"/api/orders/save-order",data:{order:this},file:a}).then(t,s)}},{key:"saveNewOrderForCustomer",value:function(){var e=this.dealership;return this.resetOrderExceptCustomer(),this.dealership=e,this.order_type="Customer",this.saveOrder()}},{key:"requestOrder",value:function(){var t=this,n=function(e){t.updateOrder(e.data)},s=function(e){return r.reject(e)};return e.post("orders/request-order",{order:this}).then(n,s)}},{key:"rejectOrder",value:function(){var t=this,n=function(e){t.updateOrder(e.data)},s=function(e){return r.reject(e)};return e.post("orders/reject-order",{order:this}).then(n,s)}},{key:"placeOrder",value:function(){var t=this,n=function(e){t.updateOrder(e.data)},s=function(e){return r.reject(e)};return e.post("orders/place-order",{order:this}).then(n,s)}},{key:"cancelOrder",value:function(t){var n=this,s=function(e){n.updateOrder(e.data)},a=function(e){return r.reject(e)};return e.post("orders/cancel-order",{order:this,cancel_reason:t}).then(s,a)}},{key:"finalizeOrder",value:function(){var t=this,n=function(e){t.updateOrder(e.data)},s=function(e){return r.reject(e)};return e.post("orders/finalize-order",{order:this}).then(n,s)}}]),s}();return new s}])},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),a=r(s);t.default=function(e){e.controller("ShowroomController",["$filter","$scope","$state","$timeout","ApiService","AppSettings","OrderService",function(e,t,r,s,i,o,l){n(92),t.order=l,window.location.href.indexOf("showroom")>-1&&$("#lnk_help").attr("href","/help/showroom"),t.post=function(e,t){return i.post("orders/"+e,t)},"showroom"===r.current.name&&r.go("showroom.splash"),t.createQuote=function(){r.go("showroom.customer")},t.current={model:null,series:null,slider:0},t.choices={models:[],series:[],states:[],referrals:[],dealerships:[]},t.info={model_detail:null,series_detail:null},t.modal={photo:null,plan_view:!1},t.errors={series_select:null},t.editCurrentCustomer=!1,t.post("showroom-data").then(function(n){t.choices.model_series=n.data.models,t.choices.states=n.data.states,t.choices.acquisition_source=n.data.acquisition_source,t.choices.source_of_awareness=n.data.source_of_awareness,t.choices.shows=n.data.shows,t.choices.dealerships=n.data.dealerships,t.choices.available_delivery_months=[];var r=!0,s=!1,i=void 0;try{for(var l,d=(0,a.default)(n.data.available_delivery_months);!(r=(l=d.next()).done);r=!0){var c=l.value,u=new Date(Date.parse(c));t.choices.available_delivery_months.push({title:e("date")(u,o.FORMAT_DATE_MONTH_SHORT_JS),value:u}),t.order.delivery_date&&t.order.delivery_date.getTime()==u.getTime()&&(t.order.delivery_date=u)}}catch(e){s=!0,i=e}finally{try{!r&&d.return&&d.return()}finally{if(s)throw i}}1==t.choices.dealerships.length&&(t.order.dealership=t.choices.dealerships[0].id)}),t.customerProceed=function(e){e&&e.$valid&&(t.order.order_type="Customer",t.choices.series=[],r.go("showroom.model"))},t.onModelClick=function(e){t.current.model=e,t.order.model=e.id,r.go("showroom.series")},t.selectSeries=function(e){t.current.series=e,t.order.series=e.id},t.onViewSeriesPhotoClick=function(e){t.selectSeries(e),r.go("showroom.seriesphotos")},t.onStartQuoteClick=function(e){t.selectSeries(e),t.onSeriesSelect()},t.onSeriesSelect=function(){t.errors.series_select=null;var e=function(e){s(function(){r.go("order.caravan.features",{orderId:e.data.id})})},n=function(e){400==e.status?t.errors.series_select=e.data:t.errors.series_select="An unexpected error has occurred"};l.saveOrder().then(e,n)},t.select_physical_suburb=function(e){t.order.customer.physical_address.suburb=e},t.select_customer=function(e){t.order.customer=e},t.clearCustomer=function(){t.order.resetCustomer(),t.search={}},t.editCustomerFields=function(){t.editCurrentCustomer=!0},t.hasModelAvailableSeries=function(e){var n=e.series.filter(t.isSeriesAvailableForDealership);return n.length},t.isSeriesAvailableForDealership=function(e){return e.dealerships.indexOf(t.order.dealership)!=-1}}])},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(193),a=r(s),i=n(35),o=r(i),l=n(1),d=r(l);t.default=function(e){n(125)(e),e.controller("OrderStatusController",["$scope","$state","ApiService","Upload",function(e,t,n,r){e.history={},e.new_customer_manager_id=null,e.new_sales_rep_id=null,e.loading=!1,e.cert_loading=!1,e.test_date=new Date,e.chassis_variable=!0,e.chassis_date_control=new Date,e.production_date_control=new Date,e.building_date_control=new Date;var s=function(t,n){e.status[t]&&e.status[t][n]&&e.status[t][n].data&&(e.status[t][n].data=new Date(e.status[t][n].data))},i=function(){e.post("status",{order_id:e.order.id}).then(function(t){e.status=t.data,s("delivery","delivery_date_set"),s("delivery","warranty_date"),s("delivery","pickup_date"),e.status.approval.deposit_paid.data=parseFloat(e.status.approval.deposit_paid.data),e.status.approval.senior_designer_verfied_date.data?e.senior_designer_date_control=f(e.status.approval.senior_designer_verfied_date.data):e.senior_designer_date_control="",e.status.approval.purchase_order_raised_date.data?e.purchase_order_date_control=f(e.status.approval.purchase_order_raised_date.data):e.purchase_order_date_control="",e.status.delivery.actual_production_date.data?e.production_date_control=f(e.status.delivery.actual_production_date.data):e.production_date_control="",e.status.delivery.chassis_section.data?e.chassis_date_control=f(e.status.delivery.chassis_section.data):e.chassis_date_control="",e.status.delivery.building.data?e.building_date_control=f(e.status.delivery.building.data):e.building_date_control="",e.status.delivery.prewire_section.data?e.prewire_date_control=f(e.status.delivery.prewire_section.data):e.prewire_date_control="",e.status.delivery.plumbing_date.data?e.plumbing_date_control=f(e.status.delivery.plumbing_date.data):e.plumbing_date_control="",e.status.delivery.aluminium.data?e.aluminium_date_control=f(e.status.delivery.aluminium.data):e.aluminium_date_control="",e.status.delivery.finishing.data?e.finishing_date_control=f(e.status.delivery.finishing.data):e.finishing_date_control="",e.status.delivery.detailing_date.data?e.detailing_date_control=f(e.status.delivery.detailing_date.data):e.detailing_date_control="",e.status.delivery.watertest_date.data?e.watertest_date_control=f(e.status.delivery.watertest_date.data):e.watertest_date_control="",e.status.delivery.final_qc_date.data?e.final_qc_date_control=f(e.status.delivery.final_qc_date.data):e.final_qc_date_control="",e.status.delivery.dispatch_date_planned.data?e.dispatch_date_planned_control=f(e.status.delivery.dispatch_date_planned.data):e.dispatch_date_planned_control="",e.status.delivery.collection_date.data?e.collection_date_control=f(e.status.delivery.collection_date.data):e.collection_date_control="",e.status.delivery.dispatch_date_actual.data?e.dispatch_date_actual_control=f(e.status.delivery.dispatch_date_actual.data):e.dispatch_date_actual_control="",e.status.delivery.received_date_dealership.data?e.received_date_dealership_control=f(e.status.delivery.received_date_dealership.data):e.received_date_dealership_control="",e.status.delivery.delivery_date_customer.data?e.delivery_date_customer_control=f(e.status.delivery.delivery_date_customer.data.delivery_date_customer):e.delivery_date_customer_control="",e.loading=!1}),e.post("status-history",{order_id:e.order.id}).then(function(t){e.status_history=t.data.history})},l=function(){e.loading=!1,e.post("status-docs",{order_id:e.order.id}).then(function(t){e.status_docs=t.data.docs_data})};i(),l(),e.sectionComplete=function(e){if(e){var t=!0,n=!1,r=void 0;try{for(var s,a=(0,d.default)((0,o.default)(e));!(t=(s=a.next()).done);t=!0){var i=s.value;if("Complete"!==e[i].status&&"Optional"!==e[i].status)return!1}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}return!0}};var c=function(t){if(!e.loading)return e.loading=!0,t.order_id=e.order.id,n.post("orders/status-update",t).finally(function(){i(),l()})},u=function(e,t,n){var r={};r[t]=n,c(r)},m=function(t){if(!e.loading)return e.loading=!0,t.order_id=e.order.id,n.post("orders/status-delete",t).finally(function(){i()})},p=function(e,t,n){if(e.$valid){var r={};r[t]=n,m(r)}};e.updateDeposit=function(e,t){u(e,"deposit",t)},e.updateChassis=function(){c({chassis_number:!0})},e.enableChassisEdition=function(){e.editingChassis=!0},e.setChassis=function(){c({chassis_number:e.status.approval.chassis_appointed.data}).then(function(){e.editingChassis=!1})},e.deleteActualProdDate=function(e,t){p(e,"del_actual_production_date",t)},e.deleteChassisSection=function(e,t){p(e,"del_chassis_section",t)},e.deleteBuildingSection=function(e,t){p(e,"del_building",t)},e.deletePrewireSection=function(e,t){p(e,"del_prewire_section",t)},e.deletePlumbingDate=function(e,t){p(e,"del_plumbing_date",t)},e.deleteAluminiumSection=function(e,t){p(e,"del_aluminium",t)},e.deleteFinishing=function(e,t){p(e,"del_finishing",t)},e.deleteWatertestDate=function(e,t){p(e,"del_watertest_date",t)},e.deleteWeighbridgeDate=function(e,t){p(e,"del_weigh_bridge_date",t)},e.deleteDetailingDate=function(e,t){p(e,"del_detailing_date",t)},e.deleteActualQC=function(e,t){p(e,"del_qc_date_actual",t)},e.deleteFinalQC=function(e,t){p(e,"del_final_qc_date",t)},e.deleteActualDispatchDate=function(e,t){p(e,"del_dispatch_date_actual",t)},e.updateActualProductionDate=function(e,t){var n=_(t);u(e,"actual_production_date",n)},e.updateActualProductionComments=function(e,t){u(e,"actual_production_comments",t)},e.updateChassisSectionDate=function(e,t){var n=_(t);u(e,"chassis_section",n)},e.updateChassisSectionComments=function(e,t){u(e,"chassis_section_comments",t)},e.updateBuildingDate=function(e,t){var n=_(t);u(e,"building",n)},e.updateBuildingComments=function(e,t){u(e,"building_comments",t)},e.updatePrewireDate=function(e,t){var n=_(t);u(e,"prewire_section",n)},e.updatePrewireComments=function(e,t){u(e,"prewire_comments",t)},e.updatePlumbingDate=function(e,t){var n=_(t);u(e,"plumbing_date",n)},e.updatePlumbingComments=function(e,t){u(e,"plumbing_comments",t)},e.updateAluminiumDate=function(e,t){var n=_(t);u(e,"aluminium",n)},e.updateAluminiumComments=function(e,t){u(e,"aluminium_comments",t)},e.updateFinishingDate=function(e,t){var n=_(t);u(e,"finishing",n)},e.updateFinishingComments=function(e,t){u(e,"finishing_comments",t)},e.updateWatertestDate=function(e,t){var n=_(t);u(e,"watertest_date",n)},e.updateWatertestComments=function(e,t){u(e,"watertest_comments",t)},e.updateWeighbridgeDate=function(e,t){u(e,"weigh_bridge_date",t)},e.updateWeighbridgeComments=function(e,t){u(e,"weigh_bridge_comments",t)},e.updateDetailingDate=function(e,t){var n=_(t);u(e,"detailing_date",n)},e.updateDetalingComments=function(e,t){u(e,"detailing_comments",t)},e.updatePlannedQcDate=function(e,t){u(e,"qc_date_planned",t)},e.updateActualQcDate=function(e,t){u(e,"qc_date_actual",t)},e.updateQCComments=function(e,t){u(e,"qc_comments",t)},e.updatePlannedWatertestDate=function(e,t){u(e,"planned_watertest_date",t)},e.updateActualWatertestDate=function(e,t){u(e,"actual_watertest_date",t)},e.updateWatertestComments=function(e,t){u(e,"watertest_comments",t)},e.updateFinalQcDate=function(e,t){var n=_(t);u(e,"final_qc_date",n)},e.updateFinalQcComments=function(e,t){u(e,"final_qc_comments",t)},e.updateSeniorDesigner=function(e,t){var n=_(t);u(e,"senior_designer_verfied_date",n)},e.updatePurchaseOrderRaised=function(e,t){var n=_(t);u(e,"purchase_order_raised_date",n)},e.updateVinNumber=function(e,t){u(e,"vin_number",t)},e.updatePlannedDispatchDate=function(e,t){u(e,"dispatch_date_planned",t)},e.updateActualDispatchDate=function(e,t){var n=_(t);u(e,"dispatch_date_actual",n)},e.updateDispatchComments=function(e,t){u(e,"dispatch_comments",t)},e.updateCollectionDate=function(e,t){var n=_(t);u(e,"collection_date",n)},e.updateCollectionComments=function(e,t){u(e,"collection_comments",t)},e.updateDealershipReceivedDate=function(e,t){var n=_(t);u(e,"received_date_dealership",n)},e.updateCustomerDeliveryDate=function(e,t){var n=_(t);u(e,"delivery_date_customer",n)},e.openWeightsModal=function(){e.status.delivery.new_weights={data:(0,a.default)({},e.status.delivery.weights.data)},$("#delivery_weights.modal").modal({backdrop:"static"})},e.saveWeights=function(){c({weights:e.status.delivery.new_weights}).then(function(){$("#delivery_weights.modal").modal("hide")})},e.updateDeliveryDate=function(e,t){var n=_(t);u(e,"delivery_date",n)},e.updateDrafter=function(e,t){u(e,"drafter",t)},e.cancelFinalization=function(){e.order_finalization_cancel_reason="",$("#order_finalization_cancel_reason.modal").modal({backdrop:"static"})},e.processCancelFinalization=function(){e.post("cancel-finalize",{order_id:e.order.id,reason:e.order_finalization_cancel_reason}).then(function(e){t.go("order.status",{},{reload:!0})})},e.approveCustomerPlan=function(){c({review_customer_plan:"approve",customer_plan_disclaimer_checked:e.status.approval.customer_plan_reviewed.customer_plan_disclaimer_checked,weight_estimate_disclaimer_checked:e.status.approval.customer_plan_reviewed.weight_estimate_disclaimer_checked})},e.confirmRejectCustomerPlan=function(){e.customer_plan_reject_reason="",$("#customer_plan_reject_reason.modal").modal({backdrop:"static"})},e.processRejectCustomerPlan=function(){c({review_customer_plan:"reject",reject_reason:e.customer_plan_reject_reason})},e.updateDoc=function(t,n,s){if(!e.cert_loading){switch(e.cert_loading=!0,s){case"customer":s="customer_plan",e.certificate_note="Customer Plan";break;case"factory":s="factory_plan",e.certificate_note="";break;case"chassis":s="chassis_plan",e.certificate_note="";break;case"contract":s="contract",e.certificate_note="";break;case"plumbing":s="plumbing";break;case"electrical":s="electrical";break;case"weighbridge":s="weighbridge";break;case"qualitycontrol":s="qualitycontrol";break;case"others":s="others"}t.$valid&&r.upload({url:"/api/orders/status-update",data:{order_id:e.order.id,certificate_title:e.certificate_note,upload_for:s},file:n}).then(function(e){i(),l()},function(e){}).then(function(){e.cert_loading=!1,e.loading=!1})}},e.updateSalesforce=function(){c()},e.checkcertvalue=function(){return"others"==e.certificate_type};var f=function(e){var t=e,n=t.substring(0,2),r=t.substring(3,5),s=t.substring(6,10),a=new Date(s,r-1,n);return a},_=function(e){var t=e,n=t.getDate(),r=t.getMonth()+1,s=t.getFullYear(),a=n+"/"+r+"/"+s;return a};e.check_date_value=function(){console.log("Date Test"),console.log(e.status.delivery.actual_production_date.data);var t=e.status.delivery.actual_production_date.data,n=t.substring(0,2),r=t.substring(3,5),s=t.substring(6,10),a=new Date(s,r-1,n);return e.test_date=a,!0},e.emptyfun=function(){console.log("Do Nothing ! ")},e.set_date_format=function(){console.log("Selected Date "+e.test_date);var t=e.test_date,n=t.getDate(),r=t.getMonth()+1,s=t.getFullYear(),a=n+"/"+r+"/"+s;console.log("Date Requried : ",a),e.status.delivery.actual_production_date=a,console.log("Date Var Changed : ",e.status.delivery.actual_production_date)},e.populateText=function(){"plumbing"==e.certificate_type&&(e.certificate_note="Plumbing Certificate"),"electrical"==e.certificate_type&&(e.certificate_note="Electrical Certificate"),"weighbridge"==e.certificate_type&&(e.certificate_note="Weigh Bridge Certificate"),"qualitycontrol"==e.certificate_type&&(e.certificate_note="Quality Control Certificate"),"others"==e.certificate_type&&(e.certificate_note="Other Certificates")},e.updateSeparateDoc=function(t,n){t&&t.is_separated?c({add_separate_doc:n}):e.deleteDoc(t.id,n)},e.deleteDoc=function(t,n){e.cert_loading=!0,"customer"==n?c({delete_customer_plan:t}):"factory"==n?c({delete_factory_plan:t}):"chassis"==n?c({delete_chassis_plan:t}):"contract"==n?c({delete_contract:t}):"handover_to_driver_form"==n?c({delete_handover_to_driver_form:t}):"handover_to_dealership_form"==n?c({delete_handover_to_dealership_form:t}):"order_certificate_form"==n&&c({delete_order_certificate_form:t}),e.cert_loading=!1},e.updateHistory=function(t,n){t.$valid&&void 0!==n&&(void 0!==n.file_upload?r.upload({url:"/api/orders/status-history-note",data:{order_id:e.order.id,note:n.note},file:n.file_upload}).then(function(e){i()},function(e){}):n.note&&e.post("status-history-note",{order_id:e.order.id,note:n.note}).then(function(e){i()}),e.history={})},e.updateCertificate=function(t,n){t.$valid&&void 0!==n&&(void 0!==n.file_upload?r.upload({url:"/api/orders/status-history-note",data:{order_id:e.order.id,note:n.note},file:n.file_upload}).then(function(e){i()},function(e){}):n.note&&e.post("status-history-note",{order_id:e.order.id,note:n.note}).then(function(e){i()}),e.history={})},e.onOpenUpdateCustomerManager=function(){$("#update_customer_manager.modal").modal({backdrop:"static"})};var v=function(){e.post("customer_manager",{order_id:e.order.id}).then(function(t){e.customer_manager_list=t.data.customer_manager_list})};v(),e.updateCustomerManager=function(){e.new_customer_manager_id&&e.post("customer_manager",{order_id:e.order.id,customer_manager_id:e.new_customer_manager_id}).then(function(t){e.order.customer_manager_name=t.data.name})},e.canChangeSalesRep=function(){return e.order.permissions&&e.order.permissions.modify_order_sales_rep},e.canDeleteCertificates=function(){return e.status.permissions.can_delete_certificates},e.onOpenUpdateSalesRep=function(){$("#update_sales_rep.modal").modal({backdrop:"static"})};var g=function(){e.canChangeSalesRep()&&e.post("sales_rep",{order_id:e.order.id}).then(function(t){e.sales_rep_list=t.data.sales_rep_list})};g(),e.updateSalesRep=function(){e.new_sales_rep_id&&e.post("sales_rep",{order_id:e.order.id,sales_rep_id:e.new_sales_rep_id}).then(function(t){e.order.dealer_sales_rep_name=t.data.name})}}])},e.exports=t.default},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(10);n(69),n(124)(r),r.config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/customer"),e.state("order",{url:"/:orderId",template:n(296),controller:"OrderController",require:{default_sub_route:["order","order.customer"]},resolve:{FetchExistingOrder:["OrderService","$state","$q","$timeout","$stateParams",function(e,t,n,r,s){var a=s.orderId;if("new"!==a&&isNaN(parseInt(a)))return r(function(){t.go("order.customer",{orderId:"new"})}),n.reject();if("new"!==a){var i=function(){},o=function(){e.constructor(),r(function(){t.go("order.error",{error:"There was an error while retrieving the order.",orderId:"new"})})};return e.retrieveOrder(a).then(i,o)}return e.constructor(),n.resolve()}]}}).state("showroom",{url:"/showroom",template:n(303),controller:"ShowroomController"}).state("showroom.customer",{url:"/customer",template:n(299)}).state("showroom.model",{url:"/model",template:n(300),resolve:{Order:["OrderService","$state","$q","$timeout",function(e,t,n,r){return e.validCustomer()?e:(r(function(){
t.go("showroom.customer")}),n.reject())}]}}).state("showroom.series",{url:"/series",template:n(302),resolve:{Order:["OrderService","$state","$q","$timeout",function(e,t,n,r){return e.validModel()?e:(r(function(){t.go("showroom.model")}),n.reject())}]}}).state("showroom.seriesphotos",{url:"/series-photos",template:n(301),resolve:{Order:["OrderService","$state","$q","$timeout",function(e,t,n,r){return e.validSeries()?e:(r(function(){t.go("showroom.series")}),n.reject())}]}}).state("order.error",{url:"/error",template:n(292),params:{error:""},controller:["$scope","$stateParams",function(e,t){e.params=t}]}).state("order.manage",{url:"/manage/:orderId",controller:["$scope",function(e){e.order.model&&e.onModelSelect(),e.order.series&&e.onSeriesSelect()}],resolve:{Order:["FetchExistingOrder","OrderService","$state","$q","$timeout","$stateParams",function(e,t,n,r,s,a){var i=function(){t.base_order=parseInt(a.orderId),s(function(){n.go("order.customer")})},o=function(){return s(function(){n.go("order.error",{error:"There was an error while retrieving the order."})}),r.reject()};return t.retrieveOrder(a.orderId).then(i,o)}]}}).state("order.customer",{url:"/customer/:customerId",template:n(291),params:{customerId:""}}).state("order.caravan",{url:"/caravan",template:n(290),controller:"OrderCaravanController",require:{default_sub_route:["order.caravan","order.caravan.features"]},resolve:{Order:["FetchExistingOrder","OrderService","$state","$q","$timeout","$stateParams",function(e,t,n,r,s,a){if(!t.validCustomer()){var i=t.id||a.orderId;return s(function(){n.go("order.customer",{orderId:i})}),r.reject()}return t}]}}).state("order.caravan.modelseries",{url:"/model-and-series",template:n(295)}).state("order.caravan.weightsize",{url:"/weight-and-size",template:n(307),resolve:{Order:["FetchExistingOrder","OrderService","$state","$q","$timeout",function(e,t,n,r,s){return t.validModelSeries()?t:(s(function(){n.go("order.caravan.modelseries",{orderId:t.id})}),r.reject())}]}}).state("order.caravan.features",{url:"/features",template:n(293),resolve:{Order:["FetchExistingOrder","OrderService","$state","$q","$timeout",function(e,t,n,r,s){return t.validModelSeries()?t:(s(function(){n.go("order.caravan.modelseries",{orderId:t.id})}),r.reject())}]}}).state("order.caravan.resources",{url:"/resources",template:n(298)}).state("order.status",{url:"/status",template:n(306),controller:"OrderStatusController",resolve:{Order:["FetchExistingOrder","OrderService","$state","$q","$timeout",function(e,t,n,r,s){return t.validModelSeries()?t:(s(function(){n.go("order.caravan.modelseries",{orderId:t.id})}),r.reject())}]}}).state("order.special_features",{url:"/special_features",template:n(304)}).state("order.order_certificates",{url:"/order_certificates",template:n(297),controller:"OrderStatusController"})}])},,,,,,,,,,,,function(e,t,n){e.exports={default:n(196),__esModule:!0}},,,function(e,t,n){e.exports={default:n(200),__esModule:!0}},function(e,t,n){e.exports={default:n(202),__esModule:!0}},,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var s=n(189),a=r(s);t.default=a.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var s=n(186),a=r(s);t.default=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return(0,a.default)(e)}},function(e,t,n){n(32),n(230),e.exports=n(4).Array.from},,,,function(e,t,n){n(232),e.exports=n(4).Object.assign},,function(e,t,n){n(91),n(32),n(39),n(234),n(236),n(237),e.exports=n(4).Promise},,,,function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},,function(e,t,n){"use strict";var r=n(11),s=n(29);e.exports=function(e,t,n){t in e?r.f(e,t,s(0,n)):e[t]=n}},,function(e,t,n){var r=n(27),s=n(80),a=n(79),i=n(12),o=n(57),l=n(61),d={},c={},t=e.exports=function(e,t,n,u,m){var p,f,_,v,g=m?function(){return e}:l(e),h=r(n,u,t?2:1),b=0;if("function"!=typeof g)throw TypeError(e+" is not iterable!");if(a(g)){for(p=o(e.length);p>b;b++)if(v=t?h(i(f=e[b])[0],f[1]):h(e[b]),v===d||v===c)return v}else for(_=g.call(e);!(f=_.next()).done;)if(v=s(_,h,f.value,t),v===d||v===c)return v};t.BREAK=d,t.RETURN=c},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},,,,,function(e,t,n){var r=n(6),s=n(90).set,a=r.MutationObserver||r.WebKitMutationObserver,i=r.process,o=r.Promise,l="process"==n(26)(i);e.exports=function(){var e,t,n,d=function(){var r,s;for(l&&(r=i.domain)&&r.exit();e;){s=e.fn,e=e.next;try{s()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(l)n=function(){i.nextTick(d)};else if(!a||r.navigator&&r.navigator.standalone)if(o&&o.resolve){var c=o.resolve(void 0);n=function(){c.then(d)}}else n=function(){s.call(r,d)};else{var u=!0,m=document.createTextNode("");new a(d).observe(m,{characterData:!0}),n=function(){m.data=u=!u}}return function(r){var s={fn:r,next:void 0};t&&(t.next=s),e||(e=s,n()),t=s}}},function(e,t,n){"use strict";var r=n(8),s=n(18),a=n(52),i=n(22),o=n(30),l=n(78),d=Object.assign;e.exports=!d||n(20)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=d({},e)[n]||Object.keys(d({},t)).join("")!=r})?function(e,t){for(var n=o(e),d=arguments.length,c=1,u=a.f,m=i.f;d>c;)for(var p,f=l(arguments[c++]),_=u?s(f).concat(u(f)):s(f),v=_.length,g=0;v>g;)p=_[g++],r&&!m.call(f,p)||(n[p]=f[p]);return n}:d},,,,,,function(e,t,n){var r=n(16);e.exports=function(e,t,n){for(var s in t)n&&e[s]?e[s]=t[s]:r(e,s,t[s]);return e}},function(e,t,n){"use strict";var r=n(6),s=n(4),a=n(11),i=n(8),o=n(7)("species");e.exports=function(e){var t="function"==typeof s[e]?s[e]:r[e];i&&t&&!t[o]&&a.f(t,o,{configurable:!0,get:function(){return this}})}},,,function(e,t,n){var r=n(6),s=r.navigator;e.exports=s&&s.userAgent||""},,,function(e,t,n){"use strict";var r=n(27),s=n(9),a=n(30),i=n(80),o=n(79),l=n(57),d=n(208),c=n(61);s(s.S+s.F*!n(82)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,s,u,m=a(e),p="function"==typeof this?this:Array,f=arguments.length,_=f>1?arguments[1]:void 0,v=void 0!==_,g=0,h=c(m);if(v&&(_=r(_,f>2?arguments[2]:void 0,2)),void 0==h||p==Array&&o(h))for(t=l(m.length),n=new p(t);t>g;g++)d(n,g,v?_(m[g],g):m[g]);else for(u=h.call(m),n=new p;!(s=u.next()).done;g++)d(n,g,v?i(u,_,[s.value,g],!0):s.value);return n.length=g,n}})},,function(e,t,n){var r=n(9);r(r.S+r.F,"Object",{assign:n(217)})},,function(e,t,n){"use strict";var r,s,a,i,o=n(28),l=n(6),d=n(27),c=n(47),u=n(9),m=n(17),p=n(36),f=n(206),_=n(210),v=n(89),g=n(90).set,h=n(216)(),b=n(51),y=n(86),w=n(227),C=n(87),S="Promise",O=l.TypeError,k=l.process,D=k&&k.versions,E=D&&D.v8||"",x=l[S],A="process"==c(k),q=function(){},T=s=b.f,R=!!function(){try{var e=x.resolve(1),t=(e.constructor={})[n(7)("species")]=function(e){e(q,q)};return(A||"function"==typeof PromiseRejectionEvent)&&e.then(q)instanceof t&&0!==E.indexOf("6.6")&&w.indexOf("Chrome/66")===-1}catch(e){}}(),$=function(e){var t;return!(!m(e)||"function"!=typeof(t=e.then))&&t},P=function(e,t){if(!e._n){e._n=!0;var n=e._c;h(function(){for(var r=e._v,s=1==e._s,a=0,i=function(t){var n,a,i,o=s?t.ok:t.fail,l=t.resolve,d=t.reject,c=t.domain;try{o?(s||(2==e._h&&M(e),e._h=1),o===!0?n=r:(c&&c.enter(),n=o(r),c&&(c.exit(),i=!0)),n===t.promise?d(O("Promise-chain cycle")):(a=$(n))?a.call(n,l,d):l(n)):d(r)}catch(e){c&&!i&&c.exit(),d(e)}};n.length>a;)i(n[a++]);e._c=[],e._n=!1,t&&!e._h&&j(e)})}},j=function(e){g.call(l,function(){var t,n,r,s=e._v,a=I(e);if(a&&(t=y(function(){A?k.emit("unhandledRejection",s,e):(n=l.onunhandledrejection)?n({promise:e,reason:s}):(r=l.console)&&r.error&&r.error("Unhandled promise rejection",s)}),e._h=A||I(e)?2:1),e._a=void 0,a&&t.e)throw t.v})},I=function(e){return 1!==e._h&&0===(e._a||e._c).length},M=function(e){g.call(l,function(){var t;A?k.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})})},F=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),P(t,!0))},N=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw O("Promise can't be resolved itself");(t=$(e))?h(function(){var r={_w:n,_d:!1};try{t.call(e,d(N,r,1),d(F,r,1))}catch(e){F.call(r,e)}}):(n._v=e,n._s=1,P(n,!1))}catch(e){F.call({_w:n,_d:!1},e)}}};R||(x=function(e){f(this,x,S,"_h"),p(e),r.call(this);try{e(d(N,this,1),d(F,this,1))}catch(e){F.call(this,e)}},r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=n(223)(x.prototype,{then:function(e,t){var n=T(v(this,x));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=A?k.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&P(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),a=function(){var e=new r;this.promise=e,this.resolve=d(N,e,1),this.reject=d(F,e,1)},b.f=T=function(e){return e===x||e===i?new a(e):s(e)}),u(u.G+u.W+u.F*!R,{Promise:x}),n(37)(x,S),n(224)(S),i=n(4)[S],u(u.S+u.F*!R,S,{reject:function(e){var t=T(this),n=t.reject;return n(e),t.promise}}),u(u.S+u.F*(o||!R),S,{resolve:function(e){return C(o&&this===i?x:this,e)}}),u(u.S+u.F*!(R&&n(82)(function(e){x.all(e).catch(q)})),S,{all:function(e){var t=this,n=T(t),r=n.resolve,s=n.reject,a=y(function(){var n=[],a=0,i=1;_(e,!1,function(e){var o=a++,l=!1;n.push(void 0),i++,t.resolve(e).then(function(e){l||(l=!0,n[o]=e,--i||r(n))},s)}),--i||r(n)});return a.e&&s(a.v),n.promise},race:function(e){var t=this,n=T(t),r=n.reject,s=y(function(){_(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return s.e&&r(s.v),n.promise}})},,function(e,t,n){"use strict";var r=n(9),s=n(4),a=n(6),i=n(89),o=n(87);r(r.P+r.R,"Promise",{finally:function(e){var t=i(this,s.Promise||a.Promise),n="function"==typeof e;return this.then(n?function(n){return o(t,e()).then(function(){return n})}:e,n?function(n){return o(t,e()).then(function(){throw n})}:e)}})},function(e,t,n){"use strict";var r=n(9),s=n(51),a=n(86);r(r.S,"Promise",{try:function(e){var t=s.f(this),n=a(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){function r(e){return"number"==typeof e&&e==s(e)}var s=n(100);e.exports=r},,,,,,,,,,,,,,function(e,t){e.exports='<tabs data="tabData" type="tabs" class="secondary" />\n<div ng-if="message" class="alert {{ message.type }}">\n    <div ng-repeat="text in message.message_list">{{ text }}</div>\n</div>\n<ui-view></ui-view>'},function(e,t){e.exports='<div ng-if="message" class="alert {{ message.type }}">\n    <div ng-repeat="text in message.message_list">{{ text }}</div>\n</div>\n\n<div class="row" ng-hide="order.isCustomerVisible()">\n    <div class="col-sm-11 col-sm-offset-1">\n        <div class="panel panel-warning">\n            <div class="panel-body">\n                    You do not have the required permissions to view or edit Customer information\n            </div>\n        </div>\n    </div>\n</div>\n\n<div ng-hide="!order.isCustomerVisible()">\n    <div class="row">\n        <div class="col-sm-11 col-sm-offset-1">\n        <h3>Create a stock order</h3>\n\n        <form name="stock_form" class="form top-margin-30">\n            <fieldset>\n\n                <div class="form-group col-sm-6">\n                    <label class="form-label">DEALERSHIP</label>\n                    <select class="form-control"\n                            ng-model="order.dealership"\n                            ng-options="dealer.id as dealer.title for dealer in choices.dealerships"\n                            ng-disabled="!order.isEditable() && !permissions.reassign_stock_orders"\n                            required>\n                        <option value="">\n                            {{ order.isStageQuoteEditable() ? \'Select a dealership\' : order.dealership_name }}\n                        </option>\n                    </select>\n\n                    <br>                \n                \n                 \n                    <button type="submit" class="btn btn-primary" ng-click="proceedDealerOrder(stock_form)">\n                        <span ng-if="!order.id">Create Dealership Order</span>\n                        <span ng-if="order.id && order.order_type==\'Stock\'">Save and Proceed</span>\n                        <span ng-if="order.id && order.order_type!=\'Stock\'">Convert to Dealership Order</span>\n                    </button>\n                </div>\n            </fieldset>\n        </form>\n        </div>\n    </div>\n\n\n    <div class="row">\n        <div class="col-sm-10 col-sm-offset-1">\n            <div class="dashed-divider-horizontal">\n                <span>OR</span>\n                <hr>\n            </div>\n        </div>\n    </div>\n\n\n    <div class="row" ng-if="permissions.can_create_edit_customer_details">\n        <div class="col-sm-10 col-sm-offset-1">\n            <h3>Create a quote/order for a customer</h3>\n\n            <form name="customer_form" novalidate class="form top-margin-30">\n                <fieldset>\n                    <div class="row">\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">DEALERSHIP</label>\n                            <select class="form-control"\n                                    name="dealership"\n                                    ng-model="order.dealership"\n                                    ng-options="dealer.id as dealer.title for dealer in choices.dealerships" required>\n                                <option value="">\n                                    {{ order.isEditable() ? \'Select a dealership\' : order.dealership_name }}\n                                </option>\n                            </select>\n                            <div ng-messages="customer_form.dealership.$error" ng-if="customer_form.dealership.$dirty || customer_form.$submitted">\n                                <p ng-message="required">This field is required.</p>\n                            </div>\n                        </div>\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">SHOW</label>\n                            <select class="form-control"\n                                    ng-model="order.show_id"\n                                    ng-disabled="order.show_id && order.is_expired"\n                                    ng-options="show.id as show.title for show in choices.shows">\n                                <option value="">\n                                    Select a Show\n                                </option>\n                            </select>\n                        </div>\n                    </div>\n\n                    <!-- Customer details -->\n\n                    <div class="row top-margin-40">\n                        <div class="col-sm-6"><h4>Customer Details</h4></div>\n                    </div>\n\n                    <div class="row" ng-if="order.isEditable() || order.is_order_converted">\n                        <div class="col-sm-6" ng-if="!order.isEditable()"></div>\n                        <div class="col-sm-6" ng-if="order.isEditable()">\n                            <label class="form-label">LOOKUP EXISTING CUSTOMER</label>\n                            <lookup result="search.customer" min-length="3" min-wait="100"\n                                    ng-model="order.customer"\n                                    on-select="select_customer" type="customer_lookup" name="customer"\n                                    autocomplete="off"></lookup>\n                        </div>\n                        <div class="form-group col-sm-6" ng-if="order.is_order_converted">\n                            <label class="form-label">\n                                SALES DATE - STOCK ORDER CONVERSION</label>\n                            <input type="text" class="form-control" ng-model="order.order_converted" name="order_converted" placeholder="dd/mm/yyyy" ng-required="order.is_order_converted"/>\n                             <div ng-messages="customer_form.order_converted.$error">\n                             <p ng-message="required">This field is required.</p>  \n                             </div>\n                        </div>\n                    </div>\n\n                    <div class="row top-margin-20">\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">\n                                FIRST NAME</label>\n                            <input type="text" class="form-control" ng-model="order.customer.first_name" name="first_name" required ng-disabled="!isCustomerEditable()" />\n                            <div ng-messages="customer_form.first_name.$error" ng-if="customer_form.first_name.$dirty || customer_form.$submitted">\n                                <p ng-message="required">This field is required.</p>\n                            </div>\n                        </div>\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">\n                                LAST NAME</label>\n                            <input type="text" class="form-control" ng-model="order.customer.last_name" name="last_name" required ng-disabled="!isCustomerEditable()" />\n                            <div ng-messages="customer_form.last_name.$error" ng-if="customer_form.last_name.$dirty || customer_form.$submitted">\n                                <p ng-message="required">This field is required.</p>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="row top-margin-20">\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">\n                                EMAIL</label>\n                            <input type="text" class="form-control" ng-model="order.customer.email" name="email"\n                                   ng-required="!(order.customer.email.length || order.customer.phone1.length)"\n                                   ng-disabled="!isCustomerEditable()" />\n                            <div ng-messages="customer_form.email.$error" ng-if="customer_form.email.$dirty || customer_form.$submitted">\n                                <p ng-message="required">Either the phone number or the email address is required.</p>\n                            </div>\n                        </div>\n\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">OPT IN FOR MAILING LIST\n                                <input type="checkbox" class="form-control form-control-small"\n                                       ng-model="order.customer.mailing_list" name="mailling_list"\n                                       ng-disabled="!isCustomerEditable()" />\n                            </label>\n                        </div>\n                    </div>\n\n                    <div class="row top-margin-20">\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">\n                                PHONE NUMBER</label>\n                            <input type="text" class="form-control" ng-model="order.customer.phone1" name="phone_number"\n                                   ng-required="!(order.customer.email.length || order.customer.phone1.length)"\n                                   ng-disabled="!isCustomerEditable()" />\n                            <div ng-messages="customer_form.phone_number.$error" ng-if="customer_form.phone_number.$dirty || customer_form.$submitted">\n                                <p ng-message="required">Either the phone number or the email address is required.</p>\n                            </div>\n                        </div>\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">PARTNER\'S NAME</label>\n                            <input type="text" class="form-control" ng-model="order.customer.partner_name" name="partner_name" ng-disabled="!isCustomerEditable()"/>\n                        </div>\n\n                    </div>\n\n                    <div class="row top-margin-20">\n                      \n\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">TOW VEHICLE</label>\n                            <input type="text" class="form-control" ng-model="order.customer.tow_vehicle" name="tow_vehicle" required ng-disabled="!isCustomerEditable()" />\n                            <div ng-messages="customer_form.tow_vehicle.$error" ng-if="customer_form.tow_vehicle.$dirty || customer_form.$submitted">\n                                <p ng-message="required">This field is required.</p>\n                            </div>\n                        </div>\n\n                    </div>\n\n                    <div class="row top-margin-20">\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">\n                                WHERE DID YOU HEAR FROM US?</label>\n                            <select class="form-control"\n                                    ng-model="order.customer.source_of_awareness"\n                                    name="referral"\n                                    ng-options="source_of_awareness.id as source_of_awareness.title for source_of_awareness in choices.source_of_awareness" required\n                                    ng-disabled="!isCustomerEditable()">\n                                <option value="">Select an option</option>\n                            </select>\n                            <div ng-messages="customer_form.referral.$error" ng-if="customer_form.referral.$dirty || customer_form.$submitted">\n                                <p ng-message="required">This field is required.</p>\n                            </div>\n                        </div>\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">\n                                METHOD OF CONTACT?</label>\n                            <select class="form-control"\n                                    ng-model="order.customer.acquisition_source"\n                                    name="referral"\n                                    ng-options="acquisition_source.id as acquisition_source.title for acquisition_source in choices.acquisition_source" required\n                                    ng-disabled="!isCustomerEditable()">\n                                <option value="">Select an option</option>\n                            </select>\n                            <div ng-messages="customer_form.referral.$error" ng-if="customer_form.referral.$dirty || customer_form.$submitted">\n                                <p ng-message="required">This field is required.</p>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div ng-if="!isCustomerEditable()" class="row">\n                        <div class="col-sm-offset-6 col-sm-3">\n                            <button type="button" class="btn btn-primary" ng-click="clearCustomer()">Create new customer</button>\n                        </div>\n                        <div class="col-sm-3">\n                            <button type="button" class="btn btn-primary" ng-click="editCustomerFields()">Edit customer details</button>\n                        </div>\n                    </div>\n\n\n                    <!-- Address -->\n\n\n                    <div class="row top-margin-40">\n                        <div class="col-sm-6"><h4>Address</h4></div>\n                    </div>\n\n                    <div class="row top-margin-20">\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">REGISTERED OWNER</label>\n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.name"\n                                   name="registered_owner" required\n                                   ng-disabled="!isCustomerEditable()"/>\n                            <div ng-messages="customer_form.registered_owner.$error" ng-if="customer_form.registered_owner.$dirty || customer_form.$submitted">\n                                <p ng-message="required">This field is required.</p>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="row top-margin-20">\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">STREET ADDRESS</label>\n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.address" name="street" required\n                                   ng-disabled="!isCustomerEditable()"/>\n                            <div ng-messages="customer_form.street.$error" ng-if="customer_form.street.$dirty || customer_form.$submitted">\n                                <p ng-message="required">This field is required.</p>\n                            </div>\n                        </div>\n                        <div class="form-group col-sm-6" ng-if="order.id || !order.customer.id || editCurrentCustomer">\n                            <label class="form-label">LOOKUP CITY OR SUBURB</label>\n                            <lookup result="search.physical_suburb" min-length="3" min-wait="100"\n                                    ng-model="order.customer.physical_address.suburb.name"\n                                    on-select="select_physical_suburb" type="suburb_lookup" name="physical_address_suburb"\n                                    autocomplete="off"></lookup>\n                        </div>\n                    </div>\n\n                    <div class="row top-margin-20">\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">CITY</label>\n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.suburb.name" name="suburb" required\n                                   ng-disabled="!isCustomerEditable()"/>\n                            <div ng-messages="customer_form.suburb.$error" ng-if="customer_form.suburb.$dirty || customer_form.$submitted">\n                                <p ng-message="required">This field is required.</p>\n                            </div>\n                        </div>\n                        <div class="form-group col-sm-4">\n                            <label class="form-label">STATE</label>\n                            <select class="form-control" ng-options="s.code as s.title for s in choices.states"\n                                    ng-model="order.customer.physical_address.suburb.post_code.state.code" name="state" required\n                                    ng-disabled="!isCustomerEditable()">\n                                <option value="">Select State</option>\n                            </select>\n                            <div ng-messages="customer_form.state.$error" ng-if="customer_form.state.$dirty || customer_form.$submitted">\n                                <p ng-message="required">This field is required.</p>\n                            </div>\n                        </div>\n                        <div class="form-group col-sm-2">\n                            <label class="form-label">POSTCODE</label>\n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.suburb.post_code.number" name="post_code" required ng-pattern="/^\\d{4}$/"\n                                   ng-disabled="!isCustomerEditable()"/>\n                            <div ng-messages="customer_form.post_code.$error" ng-if="customer_form.post_code.$dirty || customer_form.$submitted">\n                                <p ng-message="required">This field is required.</p>\n                                <p ng-message="pattern">Postcode must be 4 digits.</p>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="row top-margin-40">\n\n                        <uib-accordion class="red">\n\n                            <!-- Delivery -->\n\n                            <uib-accordion-group>\n                                <uib-accordion-heading>\n                                    <div>Add Delivery details (if different)</div>\n                                </uib-accordion-heading>\n\n                                <div class="row top-margin-20">\n                                    <div class="form-group col-sm-6">\n                                        <label class="form-label">NAME</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.delivery_address.name"\n                                               ng-disabled="!isCustomerEditable()"/>\n                                    </div>\n                                    <div class="form-group col-sm-6">\n                                        <label class="form-label">PHONE</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.phone_delivery"\n                                               ng-disabled="!isCustomerEditable()"/>\n                                    </div>\n                                </div>\n                                <div class="row top-margin-20">\n                                    <div class="form-group col-sm-6">\n                                        <label class="form-label">STREET ADDRESS</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.delivery_address.address"\n                                               name="delivery_street" ng-required="order.customer.delivery_address.name.length"\n                                               ng-disabled="!isCustomerEditable()"/>\n\n                                        <div ng-messages="customer_form.delivery_street.$error" ng-if="customer_form.delivery_street.$dirty || customer_form.$submitted">\n                                            <p ng-message="required">This field is required.</p>\n                                        </div>\n                                    </div>\n                                    <div class="form-group col-sm-6" ng-if="order.id || !order.customer.id || editCurrentCustomer">\n                                        <label class="form-label">LOOKUP CITY OR SUBURB</label>\n                                        <lookup result="search.delivery_suburb" min-length="3" min-wait="100"\n                                                ng-model="order.customer.delivery_address.suburb.name"\n                                                on-select="select_delivery_suburb" type="suburb_lookup"\n                                                name="delivery_address_suburb" autocomplete="off"></lookup>\n                                    </div>\n                                </div>\n\n                                <div class="row top-margin-20">\n                                    <div class="form-group col-sm-6">\n                                        <label class="form-label">CITY</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.delivery_address.suburb.name"\n                                               name="delivery_suburb" ng-required="order.customer.delivery_address.name.length"\n                                               ng-disabled="!isCustomerEditable()"/>\n\n                                        <div ng-messages="customer_form.delivery_suburb.$error" ng-if="customer_form.delivery_suburb.$dirty || customer_form.$submitted">\n                                            <p ng-message="required">This field is required.</p>\n                                        </div>\n                                    </div>\n                                    <div class="form-group col-sm-4">\n                                        <label class="form-label">STATE</label>\n                                        <select class="form-control" ng-options="s.code as s.title for s in choices.states"\n                                                ng-model="order.customer.delivery_address.suburb.post_code.state.code"\n                                                name="delivery_state" ng-required="order.customer.delivery_address.name.length"\n                                                ng-disabled="!isCustomerEditable()">\n                                            <option value="">Select State</option>\n                                        </select>\n\n\n                                        <div ng-messages="customer_form.delivery_state.$error" ng-if="customer_form.delivery_state.$dirty || customer_form.$submitted">\n                                            <p ng-message="required">This field is required.</p>\n                                        </div>\n                                    </div>\n                                    <div class="form-group col-sm-2">\n                                        <label class="form-label">POSTCODE</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.delivery_address.suburb.post_code.number"\n                                               name="delivery_post_code" ng-required="order.customer.delivery_address.name.length" ng-pattern="/^\\d{4}$/"\n                                               ng-disabled="!isCustomerEditable()"/>\n\n                                        <div ng-messages="customer_form.delivery_post_code.$error" ng-if="customer_form.delivery_post_code.$dirty || customer_form.$submitted">\n                                            <p ng-message="required">This field is required.</p>\n                                            <p ng-message="pattern">Postcode must be 4 digits.</p>\n                                        </div>\n                                    </div>\n                                </div>\n\n                            </uib-accordion-group>\n\n\n                            <!-- Invoice -->\n\n                            <uib-accordion-group>\n                                <uib-accordion-heading>\n                                    <div>Add Invoice details (if different)</div>\n                                </uib-accordion-heading>\n\n                                <div class="row top-margin-20">\n                                    <div class="form-group col-sm-6">\n                                        <label class="form-label">NAME</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.postal_address.name"\n                                               ng-disabled="!isCustomerEditable()"/>\n                                    </div>\n                                    <div class="form-group col-sm-6">\n                                        <label class="form-label">PHONE</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.phone_invoice"\n                                               ng-disabled="!isCustomerEditable()"/>\n                                    </div>\n                                </div>\n                                <div class="row top-margin-20">\n                                    <div class="form-group col-sm-6">\n                                        <label class="form-label">STREET ADDRESS</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.postal_address.address"\n                                               name="invoice_street" ng-required="order.customer.postal_address.name.length"\n                                               ng-disabled="!isCustomerEditable()"/>\n\n                                        <div ng-messages="customer_form.invoice_street.$error" ng-if="customer_form.invoice_street.$dirty || customer_form.$submitted">\n                                            <p ng-message="required">This field is required.</p>\n                                        </div>\n                                    </div>\n                                    <div class="form-group col-sm-6" ng-if="order.id || !order.customer.id || editCurrentCustomer">\n                                        <label class="form-label">LOOKUP CITY OR SUBURB</label>\n                                        <lookup result="search.invoice_suburb"\n                                                on-select="select_invoice_suburb" type="suburb_lookup"\n                                                ng-model="order.customer.postal_address.suburb.name"\n                                                name="invoice_address_suburb" autocomplete="off"></lookup>\n                                    </div>\n                                </div>\n\n                                <div class="row top-margin-20">\n                                    <div class="form-group col-sm-6">\n                                        <label class="form-label">CITY</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.postal_address.suburb.name"\n                                               name="invoice_suburb" ng-required="order.customer.postal_address.name.length"\n                                               ng-disabled="!isCustomerEditable()"/>\n\n                                        <div ng-messages="customer_form.invoice_suburb.$error" ng-if="customer_form.invoice_suburb.$dirty || customer_form.$submitted">\n                                            <p ng-message="required">This field is required.</p>\n                                        </div>\n                                    </div>\n                                    <div class="form-group col-sm-4">\n                                        <label class="form-label">STATE</label>\n                                        <select class="form-control" ng-options="s.code as s.title for s in choices.states"\n                                                ng-model="order.customer.postal_address.suburb.post_code.state.code"\n                                                name="invoice_state" ng-required="order.customer.postal_address.name.length"\n                                                ng-disabled="!isCustomerEditable()">\n                                            <option value="">Select State</option>\n                                        </select>\n\n                                        <div ng-messages="customer_form.invoice_state.$error" ng-if="customer_form.invoice_state.$dirty || customer_form.$submitted">\n                                            <p ng-message="required">This field is required.</p>\n                                        </div>\n                                    </div>\n                                    <div class="form-group col-sm-2">\n                                        <label class="form-label">POSTCODE</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.postal_address.suburb.post_code.number"\n                                               name="invoice_post_code" ng-required="order.customer.postal_address.name.length" ng-pattern="/^\\d{4}$/"\n                                               ng-disabled="!isCustomerEditable()"/>\n\n                                        <div ng-messages="customer_form.invoice_post_code.$error" ng-if="customer_form.invoice_post_code.$dirty || customer_form.$submitted">\n                                            <p ng-message="required">This field is required.</p>\n                                            <p ng-message="pattern">Postcode must be 4 digits.</p>\n                                        </div>\n                                    </div>\n                                </div>\n\n                            </uib-accordion-group>\n                        </uib-accordion>\n\n                    </div>\n\n                    <div class="form-group">\n                        <button type="submit" class="btn btn-primary"\n                                ng-click="proceedCustomerOrder(customer_form)">\n                            <span ng-if="!order.id">Create Customer Order</span>\n                            <span ng-if="order.id && order.order_type==\'Customer\'">Save and Proceed</span>\n                            <span ng-if="order.id && order.order_type!=\'Customer\'">Convert to Customer Order</span>\n                        </button>\n                    </div>\n             </fieldset>\n            </form>\n        </div>\n    </div>\n    <div class="row" ng-if="!permissions.can_create_edit_customer_details">\n        <div class="col-sm-10 col-sm-offset-1">\n            <h3>Customer Details</h3>\n\n            <form name="customer_readyonly_form" novalidate class="form top-margin-30">\n                <fieldset>\n                      <div class="row top-margin-20">\n                        <div class="form-group col-sm-6">\n                            <label class="form-label"> DEALERSHIP</label>\n        <input type="text" class="form-control" name="dealership"  value="{{ current_dealership().title }}" readonly="true">\n                    \n                        </div>\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">SHOW</label>\n\n                            <select class="form-control"\n                                    ng-model="order.show_id"\n                                    ng-disabled="true"\n                                    ng-options="show.id as show.title for show in choices.shows">\n                                <option value="">\n                                    Select a Show\n                                </option>\n                            </select>\n\n                        </div>\n                    </div>\n\n                    <!-- Customer details -->\n\n                    <div class="row top-margin-40">\n                        <div class="col-sm-6"><h4>Customer Details</h4></div>\n                    </div>\n\n                    <div class="row" ng-if="order.isEditable() || order.is_order_converted">\n                         \n                         \n                        <div class="form-group col-sm-6" ng-if="order.is_order_converted">\n                            <label class="form-label">\n                                SALES DATE - STOCK ORDER CONVERSION</label>\n                            <input type="text" class="form-control" ng-model="order.order_converted" name="order_converted" placeholder="dd/mm/yyyy" ng-required="order.is_order_converted" readOnly ="true" />\n                             \n                        </div>\n                    </div>\n\n                    <div class="row top-margin-20">\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">\n                                FIRST NAME</label>\n                            <input type="text" class="form-control" ng-model="order.customer.first_name" name="first_name" required ng-disabled="!isCustomerEditable()" readOnly ="true" />\n                             \n                        </div>\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">\n                                LAST NAME</label>\n                            <input type="text" class="form-control" ng-model="order.customer.last_name" name="last_name" required ng-disabled="!isCustomerEditable()" readOnly ="true"/>\n                            \n                        </div>\n                    </div>\n\n                    <div class="row top-margin-20">\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">\n                                EMAIL</label>\n                            <input type="text" class="form-control" ng-model="order.customer.email" name="email"\n                                    \n                                   ng-disabled="!isCustomerEditable()" readOnly ="true"/>\n                            \n                        </div>\n\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">OPT IN FOR MAILING LIST\n\n                            <label ng-if="order.customer.mailing_list"> Yes</label>        \n\n                            <label ng-if="!order.customer.mailing_list"> No</label>        \n                            \n                            </label>\n                        </div>\n                    </div>\n\n                    <div class="row top-margin-20">\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">\n                                PHONE NUMBER</label>\n                            <input type="text" class="form-control" ng-model="order.customer.phone1" name="phone_number"\n                                   \n                                   ng-disabled="!isCustomerEditable()" readOnly ="true"/>\n                            \n                        </div>\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">PARTNER\'S NAME</label>\n                            <input type="text" class="form-control" ng-model="order.customer.partner_name" name="partner_name" ng-disabled="!isCustomerEditable()" readOnly ="true"/>\n                        </div>\n\n                    </div>\n\n                    <div class="row top-margin-20">\n                      \n\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">TOW VEHICLE</label>\n                            <input type="text" class="form-control" ng-model="order.customer.tow_vehicle" name="tow_vehicle" required ng-disabled="!isCustomerEditable()" readOnly ="true"/>\n                            \n                        </div>\n\n                    </div>\n\n\n                     <div class="row top-margin-20">\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">\n                                WHERE DID YOU HEAR FROM US?</label>\n                                <select class="form-control"\n                                    ng-model="order.customer.source_of_awareness"\n                                    name="referral"\n                                    ng-options="source_of_awareness.id as source_of_awareness.title for source_of_awareness in choices.source_of_awareness" required\n                                    ng-disabled="true">\n                                <option value="">Select an option</option>\n                            </select>\n                 \n                <!-- current_source_of_awareness -->\n                \n                        </div>\n\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">\n                                METHOD OF CONTACT</label>\n                             <select class="form-control"\n                                    ng-model="order.customer.acquisition_source"\n                                    name="referral"\n                                    ng-options="acquisition_source.id as acquisition_source.title for acquisition_source in choices.acquisition_source" required\n                                    ng-disabled="true">\n                                <option value="">Select an option</option>\n                            </select>\n\n                        </div>\n                    </div>\n\n                   \n\n\n                    <!-- Address -->\n\n\n                    <div class="row top-margin-40">\n                        <div class="col-sm-6"><h4>Address</h4></div>\n                    </div>\n\n                    <div class="row top-margin-20">\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">REGISTERED OWNER</label>\n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.name"\n                                   name="registered_owner" required \n                                   ng-disabled="!isCustomerEditable()" readOnly ="true"/>\n                             \n                        </div>\n                    </div>\n\n                    <div class="row top-margin-20">\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">STREET ADDRESS</label>\n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.address" name="street" value="order.customer.physical_address.address" ng-disabled="!isCustomerEditable()" readOnly ="true"/>\n                            \n                        </div>\n                         \n                    </div>\n\n                    <div class="row top-margin-20">\n                        <div class="form-group col-sm-6">\n                            <label class="form-label">CITY</label>\n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.suburb.name" name="suburb" value="order.customer.physical_address.suburb.name" required ng-disabled="!isCustomerEditable()" readOnly ="true"/>\n                            \n                        </div>\n                        <div class="form-group col-sm-4">\n                            <label class="form-label">STATE</label>\n                            \n                            \n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.suburb.post_code.state.code" name="suburb" required ng-disabled="!isCustomerEditable()" value="order.customer.physical_address.suburb.post_code.state.code"  readOnly ="true"/>\n\n                            \n                        </div>\n                        <div class="form-group col-sm-2">\n                            <label class="form-label">POSTCODE</label>\n                            <input type="text" class="form-control" ng-model="order.customer.physical_address.suburb.post_code.number" name="post_code" required  ng-disabled="!isCustomerEditable()" readOnly ="true"/>\n                           \n                        </div>\n                    </div>\n\n                    <div class="row top-margin-40" ng-hide="true">\n\n                        <uib-accordion class="red">\n\n\n                            <!-- Delivery -->\n\n                            <uib-accordion-group>\n                                <uib-accordion-heading>\n                                    <div>Add Delivery details (if different)</div>\n                                </uib-accordion-heading>\n\n                                <div class="row top-margin-20">\n                                    <div class="form-group col-sm-6">\n                                        <label class="form-label">NAME</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.delivery_address.name"\n                                               ng-disabled="!isCustomerEditable()"/>\n                                    </div>\n                                    <div class="form-group col-sm-6">\n                                        <label class="form-label">PHONE</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.phone_delivery"\n                                               ng-disabled="!isCustomerEditable()"/>\n                                    </div>\n                                </div>\n                                <div class="row top-margin-20">\n                                    <div class="form-group col-sm-6">\n                                        <label class="form-label">STREET ADDRESS</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.delivery_address.address"\n                                               name="delivery_street" ng-required="order.customer.delivery_address.name.length"\n                                               ng-disabled="!isCustomerEditable()"/>\n\n                                        <div ng-messages="customer_form.delivery_street.$error" ng-if="customer_form.delivery_street.$dirty || customer_form.$submitted">\n                                            <p ng-message="required">This field is required.</p>\n                                        </div>\n                                    </div>\n                                    <div class="form-group col-sm-6" ng-if="order.id || !order.customer.id || editCurrentCustomer">\n                                        <label class="form-label">LOOKUP CITY OR SUBURB</label>\n                                        <lookup result="search.delivery_suburb" min-length="3" min-wait="100"\n                                                ng-model="order.customer.delivery_address.suburb.name"\n                                                on-select="select_delivery_suburb" type="suburb_lookup"\n                                                name="delivery_address_suburb" autocomplete="off"></lookup>\n                                    </div>\n                                </div>\n\n                                <div class="row top-margin-20">\n                                    <div class="form-group col-sm-6">\n                                        <label class="form-label">CITY</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.delivery_address.suburb.name"\n                                               name="delivery_suburb" ng-required="order.customer.delivery_address.name.length"\n                                               ng-disabled="!isCustomerEditable()"/>\n\n                                        <div ng-messages="customer_form.delivery_suburb.$error" ng-if="customer_form.delivery_suburb.$dirty || customer_form.$submitted">\n                                            <p ng-message="required">This field is required.</p>\n                                        </div>\n                                    </div>\n                                    <div class="form-group col-sm-4">\n                                        <label class="form-label">STATE</label>\n                                        <select class="form-control" ng-options="s.code as s.title for s in choices.states"\n                                                ng-model="order.customer.delivery_address.suburb.post_code.state.code"\n                                                name="delivery_state" ng-required="order.customer.delivery_address.name.length"\n                                                ng-disabled="!isCustomerEditable()">\n                                            <option value="">Select State</option>\n                                        </select>\n\n\n                                        <div ng-messages="customer_form.delivery_state.$error" ng-if="customer_form.delivery_state.$dirty || customer_form.$submitted">\n                                            <p ng-message="required">This field is required.</p>\n                                        </div>\n                                    </div>\n                                    <div class="form-group col-sm-2">\n                                        <label class="form-label">POSTCODE</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.delivery_address.suburb.post_code.number"\n                                               name="delivery_post_code" ng-required="order.customer.delivery_address.name.length" ng-pattern="/^\\d{4}$/"\n                                               ng-disabled="!isCustomerEditable()"/>\n\n                                        <div ng-messages="customer_form.delivery_post_code.$error" ng-if="customer_form.delivery_post_code.$dirty || customer_form.$submitted">\n                                            <p ng-message="required">This field is required.</p>\n                                            <p ng-message="pattern">Postcode must be 4 digits.</p>\n                                        </div>\n                                    </div>\n                                </div>\n\n                            </uib-accordion-group>\n\n\n                            <!-- Invoice -->\n\n                            <uib-accordion-group>\n                                <uib-accordion-heading>\n                                    <div>Add Invoice details (if different)</div>\n                                </uib-accordion-heading>\n\n                                <div class="row top-margin-20">\n                                    <div class="form-group col-sm-6">\n                                        <label class="form-label">NAME</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.postal_address.name"\n                                               ng-disabled="!isCustomerEditable()"/>\n                                    </div>\n                                    <div class="form-group col-sm-6">\n                                        <label class="form-label">PHONE</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.phone_invoice"\n                                               ng-disabled="!isCustomerEditable()"/>\n                                    </div>\n                                </div>\n                                <div class="row top-margin-20">\n                                    <div class="form-group col-sm-6">\n                                        <label class="form-label">STREET ADDRESS</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.postal_address.address"\n                                               name="invoice_street" ng-required="order.customer.postal_address.name.length"\n                                               ng-disabled="!isCustomerEditable()"/>\n\n                                        <div ng-messages="customer_form.invoice_street.$error" ng-if="customer_form.invoice_street.$dirty || customer_form.$submitted">\n                                            <p ng-message="required">This field is required.</p>\n                                        </div>\n                                    </div>\n                                    <div class="form-group col-sm-6" ng-if="order.id || !order.customer.id || editCurrentCustomer">\n                                        <label class="form-label">LOOKUP CITY OR SUBURB</label>\n                                        <lookup result="search.invoice_suburb"\n                                                on-select="select_invoice_suburb" type="suburb_lookup"\n                                                ng-model="order.customer.postal_address.suburb.name"\n                                                name="invoice_address_suburb" autocomplete="off"></lookup>\n                                    </div>\n                                </div>\n\n                                <div class="row top-margin-20">\n                                    <div class="form-group col-sm-6">\n                                        <label class="form-label">CITY</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.postal_address.suburb.name"\n                                               name="invoice_suburb" ng-required="order.customer.postal_address.name.length"\n                                               ng-disabled="!isCustomerEditable()"/>\n\n                                        <div ng-messages="customer_form.invoice_suburb.$error" ng-if="customer_form.invoice_suburb.$dirty || customer_form.$submitted">\n                                            <p ng-message="required">This field is required.</p>\n                                        </div>\n                                    </div>\n                                    <div class="form-group col-sm-4">\n                                        <label class="form-label">STATE</label>\n                                        <select class="form-control" ng-options="s.code as s.title for s in choices.states"\n                                                ng-model="order.customer.postal_address.suburb.post_code.state.code"\n                                                name="invoice_state" ng-required="order.customer.postal_address.name.length"\n                                                ng-disabled="!isCustomerEditable()">\n                                            <option value="">Select State</option>\n                                        </select>\n\n                                        <div ng-messages="customer_form.invoice_state.$error" ng-if="customer_form.invoice_state.$dirty || customer_form.$submitted">\n                                            <p ng-message="required">This field is required.</p>\n                                        </div>\n                                    </div>\n                                    <div class="form-group col-sm-2">\n                                        <label class="form-label">POSTCODE</label>\n                                        <input type="text" class="form-control"\n                                               ng-model="order.customer.postal_address.suburb.post_code.number"\n                                               name="invoice_post_code" ng-required="order.customer.postal_address.name.length" ng-pattern="/^\\d{4}$/"\n                                               ng-disabled="!isCustomerEditable()"/>\n\n                                        <div ng-messages="customer_form.invoice_post_code.$error" ng-if="customer_form.invoice_post_code.$dirty || customer_form.$submitted">\n                                            <p ng-message="required">This field is required.</p>\n                                            <p ng-message="pattern">Postcode must be 4 digits.</p>\n                                        </div>\n                                    </div>\n                                </div>\n\n                            </uib-accordion-group>\n                        </uib-accordion>\n\n                    </div>\n\n                    <div class="form-group" ng-hide="true">\n                        <button type="submit" class="btn btn-primary"\n                                ng-click="proceedCustomerOrder(customer_form)">\n                            <span ng-if="!order.id">Create Customer Order</span>\n                            <span ng-if="order.id && order.order_type==\'Customer\'">Save and Proceed</span>\n                            <span ng-if="order.id && order.order_type!=\'Customer\'">Convert to Customer Order</span>\n                        </button>\n                    </div>\n\n                </fieldset>\n            </form>\n        </div>\n    </div>\n</div>\n\n<!-- Not used as of 10/08/2016\n<div class="modal fade" id="lead-lookup">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span\n                        aria-hidden="true">&times;</span></button>\n                <h4 class="modal-title">Lookup a Lead</h4>\n            </div>\n            <div class="modal-body">\n                <form name="lead_lookup_form">\n                    <div class="form-group">\n                        <label class="control-label">Lookup by First Name or Last Name</label>\n                        <lookup result="search.lead_lookup" min-length="3" min-wait="100"\n                                type="lead_lookup" name="physical_address_suburb"\n                                autocomplete="off"></lookup>\n                    </div>\n                </form>\n\n                <div class="alert alert-warning" ng-if="clone.message">{{ clone.message }}</div>\n            </div>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-primary" ng-click="on_lead_lookup_select(lead_lookup_form)">Select</button>\n                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n            </div>\n        </div>\n    </div>\n</div-->\n';
},function(e,t){e.exports='<div class="row top-margin-40">\n    <div class="col-sm-12">\n        <div class="alert alert-warning">\n            {{ params.error }}\n        </div>\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="features">\n\n    <div class="row top-margin-40 series-info-header">\n        <div class="col-sm-6">\n            <a href="" ng-click="onOpenSeriesPhotos()">\n                <img ng-if="info.series_detail.photos.length" class="series-thumbnail"\n                     ng-src="{{ info.series_detail.photos[0].url }}"/></a>\n\n            <div class="series-caption">\n                <h2>{{ info.series_detail.title }}</h2>\n                <a ng-if="info.series_detail.photos.length > 1" href=""\n                   ng-click="onOpenSeriesPhotos()">View {{ info.series_detail.photos.length }}\n                    images</a><br>\n                <a ng-if="info.series_detail.plans.length" href=""\n                   ng-click="onOpenSeriesPlans()">View plans</a><br>\n            </div>\n        </div>\n        <div class="col-sm-6 pull-right">\n            <div ng-if="info.show_price">\n                Retail sales price: <span class="series-cost">{{ calculatePrice().price | currency }}</span>\n                <a href="" ng-click="info.show_price = !info.show_price">Hide</a>\n            </div>\n\n            <div ng-if="!info.show_price">\n                <button class="btn btn-default" ng-click="info.show_price = !info.show_price">Show Retail Price</button>\n            </div>\n\n            <div class="top-margin-20">\n                <button class="btn btn-default" ng-click="onOpenTotals()">Display Totals</button>\n                <button class="btn btn-default" ng-if="specials.length" ng-click="onOpenSpecials()">Special Offers and Packs</button>\n\n                <div class="btn-group" uib-dropdown>\n                    <button id="print-menu-button" type="button" class="btn btn-default" uib-dropdown-toggle>\n                        Print Menu <span class="caret"></span>\n                    </button>\n\n                    <ul id="print-menu" class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="print-menu-button">\n                        <li role="menuitem">\n                            <a ng-href="/orders/spec/{{ order.id }}/" ng-click="onPrintPdfClick($event);">Print Specs</a>\n                        </li>\n                        <li role="menuitem">\n                            <a ng-href="/orders/brochure/{{ order.id }}/" ng-click="onPrintPdfClick($event);">Print Brochure</a>\n                        </li>\n                        <li role="menuitem" ng-if="permissions.print_invoice">\n                            <a ng-href="/orders/invoice/{{ order.id }}/" ng-click="onPrintPdfClick($event);">Print Invoice</a>\n                        </li>\n                        <li role="menuitem" ng-if="permissions.print_for_autocad">\n                            <a ng-href="/orders/autocad/{{ order.id }}/" ng-click="onPrintPdfClick($event);">Print for AutoCAD (PDF)</a>\n                        </li>\n                        <li role="menuitem" ng-if="permissions.print_for_autocad">\n                            <a ng-href="/orders/autocad/{{ order.id }}/?is_jpg=1" ng-click="onPrintPdfClick($event);">Print for AutoCAD (JPG)</a>\n                        </li>\n                    </ul>\n                </div>\n\n                <br/>\n                <button class="btn btn-default" ng-click="onOpenTradeInComment()">\n                    <span class="glyphicon" ng-class="order.trade_in_comment ? \'glyphicon-ok\' : \'glyphicon-unchecked\'"></span>\n                    Trade-in comment\n                </button>\n                <button class="btn" ng-class="order.orderconditions.details ? (order.orderconditions.fulfilled ? \'btn-success\' : \'btn-warning\') : \'btn-default\'" ng-click="onOpenConditions()">\n                    <span class="glyphicon" ng-class="order.orderconditions.details ? \'glyphicon-ok\' : \'glyphicon-unchecked\'"></span>\n                    Subject To...\n                </button>\n                <button class="btn btn-default" ng-click="onOpenAfterMarketNote()">\n                    <span class="glyphicon" ng-class="order.aftermarketnote.note ? \'glyphicon-ok\' : \'glyphicon-unchecked\'"></span>\n                    After-market note\n                </button>\n            </div>\n        </div>\n    </div>\n\n    <!-- Specials -->\n    <div class="row top-margin-40 applied-specials" ng-if="hasAppliedShowSpecial()">\n        <label class="form-label">ADDED SPECIALS:</label>\n\n        <div class="applied-special row">\n            <div class="col-sm-4"><b>{{ order.show_special.name }}</b></div>\n            <div class="col-sm-offset-4 col-sm-2">\n                <div class="price-tag">\n                    <span class="glyphicon glyphicon-tag"></span>\n                    {{ (order.show_special.price || 0) | currency }}\n                </div>\n            </div>\n            <div class="col-sm-2">\n                <a ng-click="unapplyShowSpecial(order.show_special)"><i class="glyphicon glyphicon-remove"></i> Remove</a>\n            </div>\n        </div>\n    </div>\n\n    <div class="row top-margin-40" ng-if="internal.file_uploads | hasKeys">\n        <div class="alert alert-info">\n            <h4>File Uploads in progress:</h4>\n            <ul>\n                <li ng-repeat="(k, v) in internal.file_uploads"><b>{{ v.name }}</b>: {{ v.percentage }}%</li>\n            </ul>\n        </div>\n    </div>\n\n    <div class="row top-margin-40 selections-key">\n        <div class="col-sm-4"><b>Upgrades and Optional Extras</b></div>\n        <div class="col-sm-4" ng-if="order.isEditable()"><b>Key: </b>\n            <div class="new-selections-key-box"></div>\n            New selections for this customer\n        </div>\n    </div>\n\n    <div class="row top-margin-20">\n        <bar-spinner ng-if="loading.items"></bar-spinner>\n\n        <uib-accordion ng-if="!loading.items" class="features">\n            <uib-accordion-group ng-repeat="category in info.items">\n\n                <uib-accordion-heading>\n                    <div ng-class="{\'missing-selections\': getDepartmentsMissingSelection(category).length > 0}">\n                        <i class="glyphicon glyphicon-chevron-right"></i>\n                        <i class="glyphicon glyphicon-chevron-down"></i>\n                        {{ category.name }}\n                        <span ng-if="getDepartmentsMissingSelection(category).length">: {{ getDepartmentsMissingSelection(category).length }} Selection(s) To Be Made</span>\n                        <!--span ng-if="order.special_features[category.id].length > 0" class="pull-right glyphicon glyphicon-exclamation-sign" title="There are special features within this category."></span-->\n                    </div>\n                </uib-accordion-heading>\n\n                <div class="row">\n                    <div ng-repeat="department in category.departments"\n                         class="col-sm-6 item-group-panel"\n                         ng-if="department.selections.length || department.upgrades.length">\n\n                        <form>\n                            <div class="btn-group" uib-dropdown\n                                 ng-class="{\'dirty\':department.changed, \'needs-selection\':!order.items[department.id]}">\n\n                                <div id="single-button" type="button" class="btn btn-primary" uib-dropdown-toggle ng-disabled="!order.isEditable()">\n\n                                    <div ng-if="!hasSpecialFeatureForDepartment(category, department)" ng-click="onItemPhotoClick(order.items[department.id]); $event.stopPropagation();" class="item-thumbnail">\n                                        <i ng-if="order.items[department.id].photo" class="glyphicon glyphicon-camera"></i>\n                                    </div>\n\n                                    <div ng-if="order.items[department.id]" class="item-name" truncate truncate-title="order.items[department.id].public_description">\n                                        <span ng-if="hasSpecialFeatureForDepartment(category, department)" class="item-special-feature">Special feature</span>\n                                        <span ng-if="!hasSpecialFeatureForDepartment(category, department)">{{ order.items[department.id].public_description }}</span>\n                                    </div>\n\n                                    <div ng-if="!order.items[department.id]" class="item-name"><b>{{ department.name }}</b></div>\n\n                                    <div ng-if="isUpgrade(department, order.items[department.id]) && (+order.items[department.id].retail_price > 0)" class="price-tag">\n                                        <span class="glyphicon glyphicon-tag"></span>\n                                        <span ng-if="order.items[department.id].price_multiply">{{ order.items[department.id].price_multiply }} x </span>\n                                        {{ order.items[department.id].retail_price | currency }}\n                                    </div>\n\n                                    <span ng-if="!department.read_only && (department.selections.length > 1 || department.upgrades.length)" class="caret"></span>\n\n                                </div>\n\n                                <ul class="dropdown-menu" role="menu" aria-labelledby="single-button"\n                                    ng-if="!department.read_only && (department.selections.length > 1 || department.upgrades.length || (department.selections.length == 1 && !order.items[department.id]))">\n\n                                    <li role="menuitem" ng-repeat="item in department.selections">\n                                        <a href="javascript:void(0);" ng-click="onItemSelect(department, item)">\n\n                                            <span ng-if="item.photo" class="pull-left" ng-click="onItemPhotoClick(item); $event.stopPropagation();">\n                                                <i class="glyphicon glyphicon-camera item-thumbnail"></i>\n                                            </span>\n\n                                            <div truncate truncate-title="item.public_description">{{ item.public_description }}</div>\n                                        </a>\n                                    </li>\n\n                                    <li ng-if="department.upgrades.length" class="divider"></li>\n\n                                    <li role="menuitem" ng-repeat="item in department.upgrades">\n                                        <a href="javascript:void(0);" ng-click="onItemSelect(department, item)">\n\n                                            <span class="pull-right">\n                                                <span class="glyphicon glyphicon-tag"></span>\n                                                {{ item.retail_price | currency }}\n                                            </span>\n\n                                            <span ng-if="item.photo" class="pull-left"\n                                                  ng-click="onItemPhotoClick(item); $event.stopPropagation();">\n                                                <i class="glyphicon glyphicon-camera item-thumbnail"></i>\n                                            </span>\n\n                                            <div truncate truncate-title="item.public_description">{{ item.public_description }}</div>\n                                        </a>\n                                    </li>\n\n                                </ul>\n                            </div>\n\n                        </form>\n                    </div>\n\n                    <div ng-repeat="item in getSelectedOptions(category)" class="col-sm-6 item-group-panel">\n                        <div class="btn-group dirty" uib-dropdown>\n                            <div id="single-button" type="button" class="btn btn-primary" uib-dropdown-toggle ng-class="{\'has-special\': item.special_name}" ng-disabled="!order.isEditable()">\n\n                                <span ng-if="!item.special_name && order.isEditable()" class="pull-right option-remove-icon" ng-click="onOptionSelect(item); $event.stopPropagation();">\n                                    <i class="glyphicon glyphicon-remove"></i>\n                                </span>\n\n                                <div ng-click="onItemPhotoClick(item); $event.stopPropagation();"\n                                     class="item-thumbnail">\n                                    <i ng-if="item.photo" class="glyphicon glyphicon-camera"></i>\n                                </div>\n                                <div class="item-name" truncate truncate-title="item.public_description">\n                                    {{ item.public_description }}\n                                    <div ng-if="item.special_name" class="item-special">{{ item.special_name }}</div>\n                                </div>\n                                <div class="price-tag">\n                                    <span class="glyphicon glyphicon-tag"></span>\n                                    {{ item.retail_price | currency }}\n                                </div>\n\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="row top-margin-30" ng-if="hasCategoryOptions(category)">\n                    <div class="form-group col-sm-3">\n                        <button type="submit" class="btn btn-primary form-control" ng-click="onOpenOptions(category)" ng-if="order.isEditable()">\n                            + Add Optional Extra\n                        </button>\n                    </div>\n                </div>\n            </uib-accordion-group>\n        </uib-accordion>\n    </div>\n\n    <div id="options" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span\n                            aria-hidden="true">&times;</span></button>\n                    <h4 class="modal-title">Options</h4>\n                </div>\n                <div class="modal-body">\n\n                    <div ng-repeat="department in optionsByDepartment">\n                        <h4>{{ department.name }}</h4>\n\n                        <div ng-repeat="item in department.options">\n                            <div class="option-panel item-panel" ng-click="onOptionSelect(item)" ng-class="item.available ? \'\' : \'disabled\'">\n                                <div ng-click="onItemPhotoClick(item); $event.stopPropagation();" class="item-thumbnail">\n                                    <i ng-if="item.photo" class="glyphicon glyphicon-camera"></i>\n                                </div>\n                                <div class="item-name">{{ item.public_description }}</div>\n                                <div class="price-tag"><span class="glyphicon glyphicon-tag"></span>\n                                    {{ item.retail_price | currency }}\n                                </div>\n                                <i ng-if="!isItemSelected(item, department)" class="glyphicon glyphicon-plus indicator"></i>\n                                <i ng-if="isItemSelected(item, department)" class="glyphicon glyphicon-ok indicator"></i>\n                            </div>\n                        </div>\n\n                    </div>\n\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n\n    <div id="totals" class="modal fade">\n        <div class="modal-dialog wide">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span\n                            aria-hidden="true">&times;</span></button>\n                    <h4 class="modal-title">Totals</h4>\n                </div>\n                <div class="modal-body">\n                    <div class="totals-modal">\n\n                        <table class="table">\n                            <thead>\n                            <tr>\n                                <th></th>\n                                <th ng-if="permissions.view_order_cost_price">Manufacturing Cost</th>\n                                <th ng-if="permissions.view_order_cost_price">Your Margin</th>\n                                <th ng-if="permissions.view_order_trade_price">Wholesale</th>\n                                <th ng-if="permissions.view_order_trade_price">Margin</th>\n                                <th>Retail</th>\n                            </tr>\n                            </thead>\n                            <tbody>\n                            <tr>\n                                <td><h4>Adjustments</h4><i ng-if="permissions.modify_order_retail_price || order.permissions.modify_retail_prices_finalized">Please enter adjustments in these fields ></i></td>\n                                <td ng-if="permissions.view_order_cost_price" ng-disabled="!isModelEditable()">\n                                    <input ng-if="permissions.modify_order_cost_price" class="form-control" type="number" ng-model="order.price_adjustments.cost" ng-change="order.price_changed = true" />\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ order.price_adjustments.wholesale | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price" ng-disabled="!isModelEditable()">\n                                    <div ng-if="permissions.modify_order_trade_price">\n                                        <div class="row">\n                                            <input class="form-control" type="number" ng-model="order.price_adjustments.wholesale" ng-change="order.price_changed = true" />\n                                        </div>\n                                        <div class="row">\n                                            <input class="form-control" type="text" ng-model="order.price_adjustments.wholesale_comment" placeholder="Comment" ng-change="order.price_changed = true" />\n                                            <div ng-if="order.price_adjustments.wholesale && !order.price_adjustments.wholesale_comment">\n                                                <span id="wholesale_comment-error" class="error">A comment is required if a value is entered.</span>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ order.price_adjustments.retail | currency }}\n                                </td>\n                                <td>\n                                    <input ng-if="permissions.modify_order_retail_price || order.permissions.modify_retail_prices_finalized" class="form-control" type="number" ng-model="order.price_adjustments.retail" ng-change="order.price_changed = true" />\n                                    <div class="top-margin-10" ng-if="!(permissions.modify_order_retail_price|| order.permissions.modify_retail_prices_finalized)">{{ order.price_adjustments.retail | currency }}</div>\n                                </td>\n                            </tr>\n                            <tr ng-if="permissions.view_order_trade_price">\n                                <td>Dealer Load Price</td>\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\n                                <td>\n                                    <input ng-if="order.permissions.modify_order_other_prices" class="form-control" type="number" ng-model="order.dealer_load" ng-change="order.price_changed = true" />\n                                    <span ng-if="!order.permissions.modify_order_other_prices">{{ order.dealer_load | currency }}</span>\n                                </td>\n                                <td>\n                                    {{ (-order.dealer_load) | currency }}\n                                </td>\n                                <td>&nbsp;</td>\n                            </tr>\n                            <tr ng-if="permissions.view_order_trade_price">\n                                <td>Trade-in w/back</td>\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\n                                <td>\n                                    <input ng-if="order.permissions.modify_order_other_prices" class="form-control" type="number" ng-model="order.trade_in_write_back" ng-change="order.price_changed = true" />\n                                    <span ng-if="!order.permissions.modify_order_other_prices">{{ order.trade_in_write_back | currency }}</span>\n                                </td>\n                                <td>\n                                    {{ (-order.trade_in_write_back) | currency }}\n                                </td>\n                                <td>&nbsp;</td>\n                            </tr>\n\n                            <tr ng-if="permissions.view_order_trade_price">\n                                <td>After Sales</td>\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\n                                <td ng-if="permissions.view_order_cost_price">&nbsp;</td>\n                                <td>\n                                    <input ng-if="order.permissions.modify_order_other_prices" class="form-control" type="number" ng-model="order.after_sales.wholesale" ng-change="order.price_changed = true" />\n                                    <span ng-if="!order.permissions.modify_order_other_prices">{{ order.after_sales.wholesale | currency }}</span>\n                                </td>\n                                <td>\n                                    {{ order.after_sales.retail-order.after_sales.wholesale | currency }}\n                                </td>\n                                <td>\n                                    <input ng-if="order.permissions.modify_order_other_prices" class="form-control" type="number" ng-model="order.after_sales.retail" ng-change="order.price_changed = true" />\n                                    <span ng-if="!order.permissions.modify_order_other_prices">{{ order.after_sales.retail | currency }}</span>\n                                </td>\n                            </tr>\n                            <tr ng-if="permissions.view_order_trade_price" >\n                                <td>Description</td>\n                                <td colspan="999">\n                                    <input class="form-control comments" type="text" ng-model="order.after_sales.description" ng-change="order.price_changed = true" />\n                                </td>\n                            </tr>\n\n                            <tr>\n                                <td>Basic Caravan Prices</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ totals.manufacture.caravan | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (totals.wholesale.caravan - totals.manufacture.caravan) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ totals.wholesale.caravan | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (totals.retail.caravan - totals.wholesale.caravan) | currency }}\n                                </td>\n                                <td>\n                                    {{ totals.retail.caravan | currency }}\n                                </td>\n                            </tr>\n                            <tr ng-hide="options_upgrades_expanded">\n                                <td>Options & Upgrades (<a ng-click="options_upgrades_expanded=true">show</a>)</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ totals.manufacture.options + totals.manufacture.upgrades | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (totals.wholesale.options - totals.manufacture.options) + (totals.wholesale.upgrades - totals.manufacture.upgrades) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ totals.wholesale.options + totals.wholesale.upgrades | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (totals.retail.options - totals.wholesale.options) + (totals.retail.upgrades - totals.wholesale.upgrades) | currency }}\n                                </td>\n                                <td>\n                                    {{ totals.retail.options + totals.retail.upgrades | currency }}\n                                </td>\n                            </tr>\n                            <tr class="totals-item totals-item-header" ng-show="options_upgrades_expanded">\n                                <td>Options & Upgrades (<a ng-click="options_upgrades_expanded=false">hide</a>)</td>\n                                <td colspan="5"></td>\n                            </tr>\n                            <tr class="totals-item totals-item-entry" ng-repeat="item in totals.options_upgrades track by $index" ng-show="options_upgrades_expanded">\n                                <td>{{ item.name }}</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ item.manufacture | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (item.wholesale - item.manufacture) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ item.wholesale | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (item.retail - item.wholesale) | currency }}\n                                </td>\n                                <td>\n                                    {{ item.retail | currency }}\n                                </td>\n                            </tr>\n                            <tr class="totals-item totals-item-totals" ng-show="options_upgrades_expanded">\n                                <td>Option & Upgrades Total</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ totals.manufacture.options + totals.manufacture.upgrades | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (totals.wholesale.options - totals.manufacture.options) + (totals.wholesale.upgrades - totals.manufacture.upgrades) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ totals.wholesale.options + totals.wholesale.upgrades | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (totals.retail.options - totals.wholesale.options) + (totals.retail.upgrades - totals.wholesale.upgrades) | currency }}\n                                </td>\n                                <td>\n                                    {{ totals.retail.options + totals.retail.upgrades | currency }}\n                                </td>\n                            </tr>\n                            <tr ng-hide="special_features_expanded">\n                                <td>Special Features (<a ng-click="special_features_expanded=true">show</a>)</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ totals.manufacture.special_features | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (totals.wholesale.special_features - totals.manufacture.special_features) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ totals.wholesale.special_features | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (totals.retail.special_features - totals.wholesale.special_features) | currency }}\n                                </td>\n                                <td>\n                                    {{ totals.retail.special_features | currency }}\n                                </td>\n                            </tr>\n                            <tr class="totals-item totals-item-header" ng-show="special_features_expanded">\n                                <td>Special Features (<a ng-click="special_features_expanded=false">hide</a>)</td>\n                                <td colspan="5"></td>\n                            </tr>\n                            <tr class="totals-item totals-item-entry" ng-repeat="item in totals.special_features track by $index" ng-show="special_features_expanded">\n                                <td>{{ item.name }}</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ item.manufacture | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (item.wholesale - item.manufacture) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ item.wholesale | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (item.retail - item.wholesale) | currency }}\n                                </td>\n                                <td>\n                                    {{ item.retail | currency }}\n                                </td>\n                            </tr>\n                            <tr class="totals-item totals-item-totals" ng-show="special_features_expanded">\n                                <td>Special Features Total</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ totals.manufacture.special_features | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (totals.wholesale.special_features - totals.manufacture.special_features) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ totals.wholesale.special_features | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (totals.retail.special_features - totals.wholesale.special_features) | currency }}\n                                </td>\n                                <td>\n                                    {{ totals.retail.special_features | currency }}\n                                </td>\n                            </tr>\n                            <tr ng-if="hasAppliedShowSpecial()">\n                                <td>Show Special</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                </td>\n                                <td>\n                                    {{ order.show_special.price | currency }}\n                                </td>\n                            </tr>\n                            <tr id="totals--grand-totals">\n                                <td>Grand Totals</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ totals.manufacture.totalNoAdjustment + order.price_adjustments.cost | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale) - (totals.manufacture.totalNoAdjustment + order.price_adjustments.cost) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale + order.dealer_load + order.trade_in_write_back + order.after_sales.wholesale| currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (totals.retail.totalNoAdjustment + order.after_sales.retail + order.price_adjustments.retail) - (totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale) - order.after_sales.wholesale - order.dealer_load - order.trade_in_write_back | currency }}\n                                </td>\n                                <td>\n                                    {{ totals.retail.totalNoAdjustment + order.after_sales.retail + order.price_adjustments.retail | currency }}\n                                </td>\n                            </tr>\n                            <tr>\n                                <td>Total Excluding GST</td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ (totals.manufacture.totalNoAdjustment + order.price_adjustments.cost) / (1 + GST_PERCENT) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_cost_price">\n                                    {{ ((totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale) - (totals.manufacture.totalNoAdjustment + order.price_adjustments.cost)) / (1 + GST_PERCENT) | currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ (totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale + order.dealer_load + order.after_sales.wholesale + order.trade_in_write_back) / (1 + GST_PERCENT)| currency }}\n                                </td>\n                                <td ng-if="permissions.view_order_trade_price">\n                                    {{ ((totals.retail.totalNoAdjustment + order.after_sales.retail + order.price_adjustments.retail) - (totals.wholesale.totalNoAdjustment + order.price_adjustments.wholesale) - order.after_sales.wholesale - order.dealer_load - order.trade_in_write_back) / (1 + GST_PERCENT) | currency }}\n                                </td>\n                                <td>\n                                    {{ (totals.retail.totalNoAdjustment + order.after_sales.retail + order.price_adjustments.retail) / (1 + GST_PERCENT) | currency }}\n                                </td>\n                            </tr>\n                            <tr ng-if="order.permissions.modify_order_other_prices" >\n                                <td>Other comments</td>\n                                <td colspan="999">\n                                    <input class="form-control comments" type="text" ng-model="order.price_comment" ng-change="order.price_changed = true" />\n                                </td>\n                            </tr>\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n                <div class="modal-footer">\n                    <button ng-if="canOrderPricesBeSaved()" class="btn btn-primary" data-dismiss="modal" ng-click="saveOrder()">Save Prices</button>\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="photos" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3><b>{{ view_header }}</b></h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span\n                            aria-hidden="true">&times;</span></button>\n                </div>\n                <div class="modal-body">\n                    <ul ng-if="view_photos.length" rn-carousel rn-carousel-controls class="image">\n                        <li ng-repeat="image in view_photos">\n                            <div class="layer"><img ng-src="{{ image.url }}"/></div>\n                        </li>\n                    </ul>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="rules" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Rules when choosing {{ info.rules[0].item.public_description }}</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span\n                            aria-hidden="true">&times;</span></button>\n                </div>\n                <form name="rules_form" novalidate ng-submit="acceptRules(rules_form, rules_plan_upload)">\n                    <div class="modal-body">\n                        <div ng-repeat="rule in info.rules">\n                            <h3>Rule: {{ rule.title }}</h3>\n                            <div ng-if="rule.type_code==\'ADD_EXTRAS\'" class="alert alert-info">\n                                <h4>The following extras will be automatically added:</h4>\n                                <ul>\n                                    <li ng-repeat="item in rule.items">{{ item.public_description }}</li>\n                                </ul>\n                            </div>\n                            <div ng-if="rule.type_code==\'MAKE_SELECTION\'" class="alert alert-info">\n                                <h4>Please select from the following:</h4>\n                                <select name="make_selection" class="form-control" ng-model="rule.selection"\n                                        ng-options="{item:item} as item.public_description for item in rule.items" required>\n                                    <option value="">-- Please select --</option>\n                                </select>\n                                <div ng-messages="rules_form.make_selection.$error" ng-if="rules_form.$submitted && rules_form.$invalid">\n                                    <p ng-message="required">Please make a selection</p>\n                                </div>\n                            </div>\n                            <div ng-if="rule.type_code==\'WARNING\'" class="alert alert-warning">\n                                {{ rule.text }}\n                            </div>\n                            <div ng-if="rule.type_code==\'PRICE_MULTIPLY\'" class="alert alert-info" ng-init="items = priceMultiplyItems(rule.item, rule.items)">\n                                <h4>The price of this item will be multiplied by:</h4>\n                                <ul><li ng-repeat="item in items.applicableItems">\n                                    {{ item.quantity }} x {{ item.public_description }}\n                                </li></ul>\n                                <b>Total cost based on current selections: </b>{{ items.totalPrice | currency }}<br><br>\n                                <h4>Price also depends on the following items, when selected:</h4>\n                                <ul><li ng-repeat="item in items.otherItems">\n                                    {{ item.quantity }} x {{ item.public_description }}\n                                </li></ul>\n                            </div>\n                            <div ng-if="rule.type_code==\'CUSTOMER_ENTRY\'" class="alert alert-info">\n                                <h4>Please specify additional information:</h4>\n                                <textarea class="form-control" name="customer_entry" ng-model="rule.customer_entry" required></textarea>\n                            </div>\n                            <div ng-if="rule.type_code==\'PRODUCTION_NOTE\'" class="alert alert-info">\n                                <h4>The following will be added as a production note on the order:</h4>\n                                <p>{{ rule.text }}</p>\n                            </div>\n                            <div ng-if="rule.type_code==\'MARK_PLAN\'" class="alert alert-info">\n                                <p>\n                                    <h4>Upload a new plan for this item:</h4>\n                                    <button class="btn btn-primary" ngf-select ng-model="rule.file_upload" name="mark_plan"\n                                            ngf-max-size="20MB" required>\n                                        Choose Plan to Upload\n                                    </button>\n                                    <span class=\'file-upload-filename\' ng-if="rule.file_upload">{{ rule.file_upload.name }}</span>\n                                    <div ng-messages="rules_form.mark_plan.$error"\n                                         ng-if="rules_form.$submitted && rules_form.$invalid">\n                                        <p ng-message="required">Please select a file to upload</p>\n                                    </div>\n                                </p>\n                                <br>\n                                <p>\n                                <h4>Describe the location for the new item:</h4>\n                                <textarea class="form-control" name="mark_plan_notes" ng-model="rule.file_upload_notes"\n                                          required></textarea>\n\n                                <div ng-messages="rules_form.mark_plan_notes.$error"\n                                     ng-if="rules_form.$submitted && rules_form.$invalid">\n                                    <p ng-message="required">Please describe the item\'s location</p>\n                                </div>\n                                </p>\n                            </div>\n                            <div ng-if="rule.type_code==\'FORCE_SELECTION\'" class="alert alert-info">\n                                <h4>The following items will be automatically selected:</h4>\n                                <ul>\n                                    <li ng-repeat="item in rule.items">{{ item.public_description }}</li>\n                                </ul>\n                            </div>\n                        </div>\n\n                    </div>\n                    <div class="modal-footer">\n                        <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancelRules()">\n                            Cancel\n                        </button>\n                        <button type="submit" class="btn btn-primary">Accept</button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    </div>\n\n    <div id="specials" class="modal fade specials">\n        <div class="modal-dialog medium">\n            <div class="modal-content">\n                <div class="modal-body">\n                    <div ng-repeat="special in specials">\n                        <hr ng-if="$index > 0" />\n                        <div class="row">\n                            <div class="col-sm-12">\n                                <h1>{{ special.name }}</h1>\n                            </div>\n                        </div>\n\n                        <div class="row">\n                            <div class="col-sm-3">\n                                <h2>Offer:</h2>\n                            </div>\n                            <div class="col-sm-6">\n                                <h2>Availability:</h2>\n                            </div>\n                        </div>\n\n                        <div class="row">\n                            <div class="col-sm-3">\n                                <h3>\n                                    {{ special.description }} <i ng-if="special.applied" class="applied-special glyphicon glyphicon-ok"></i>\n                                </h3>\n                            </div>\n                            <div class="col-sm-6">\n                                <p>{{ special.availability_description }}</p>\n                                <small ng-if="special.tac_url"><a href="{{ special.tac_url }}" target="_blank">Terms and Conditions</a></small>\n                            </div>\n                        </div>\n\n                        <div ng-if="special.price !== undefined && special.price >= 0">\n                            <div class="row">\n                                <div class="col-sm-offset-3 col-sm-2">\n                                    <h2>Cost:</h2>\n                                </div>\n                                <div ng-if="special.normal_price != special.price && special.price > 0" class="col-sm-2">\n                                    <h2>Normal price:</h2>\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-sm-offset-3 col-sm-2">\n                                    <strong ng-if="special.price != 0">{{ special.price | currency}}</strong>\n                                    <strong ng-if="special.price == 0">FREE</strong>\n                                </div>\n                                <div ng-if="special.normal_price != special.price && special.price > 0" class="col-sm-2">\n                                    <strong>{{ special.normal_price | currency }}</strong>\n                                </div>\n                            </div>\n                        </div>\n\n                        <div class="buttons">\n                            <button ng-if="!special.applied" class="btn btn-primary apply" ng-click="applyShowSpecial(special)" ng-disabled="!info.items" ng-attr-title="{{ info.items?\'\':\'Loading series items...\' }}">Apply this special</button>\n                            <button ng-if="special.applied" class="btn btn-primary apply" ng-click="unapplyShowSpecial(special)" ng-disabled="!info.items" ng-attr-title="{{ info.items?\'\':\'Loading series items...\' }}">Unapply this special</button>\n                        </div>\n                    </div>\n                </div>\n\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                    <span aria-hidden="true">&times;</span>\n                </button>\n            </div>\n        </div>\n    </div>\n\n\n    <div id="order_conditions" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Subject to conditions:</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <textarea rows="10" cols="65" placeholder="Enter the specific conditions for this order..."\n                              class="form-control"\n                              ng-model="order.orderconditions.details" ></textarea>\n                    <div>\n                        <label>\n                            <input type="checkbox" ng-model="order.orderconditions.fulfilled" ng-disabled="!order.orderconditions.details.length"/>\n                            These conditions are met.\n                        </label>\n                    </div>\n                </div>\n                <div class="modal-footer">\n                    <button ng-if="order.order_stage_details.code != \'ORDER_FINALIZED\' && order.order_stage_details.code != \'ORDER\'" type="button" class="btn btn-primary" ng-click="saveOrder()"data-dismiss="modal">Save</button>\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="after_market_note" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>After-Market notes</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <textarea rows="10" cols="65" placeholder="Enter your after-market notes here..."\n                              class="form-control"\n                              ng-model="order.aftermarketnote.note"></textarea>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary" ng-click="saveOrder()"data-dismiss="modal">Save</button>\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="trade_in_comment" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Trade-in comments</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <textarea rows="10" cols="65" placeholder="Enter your trade-in comments here..."\n                              class="form-control"\n                              ng-model="order.trade_in_comment"></textarea>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary" ng-click="saveOrder()"data-dismiss="modal">Save</button>\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n';
},function(e,t){e.exports='<p ng-message="required">This field is required</p>'},function(e,t){e.exports='<form name="modelseries_form" class="form">\n    <div class="row top-margin-40">\n        <div class="col-sm-10 col-sm-offset-1">\n            <div class="row">\n                <div class="col-sm-6 divider dashed-divider-vertical">\n                    <h3>Select from base model and series</h3>\n\n\n                   \n\n\n                    <div class="form-group top-margin-20">\n                        <label class="form-label">MODEL</label>\n                        <select class="form-control" ng-disabled="!isModelEditable()"\n                                ng-model="order.modelSelection"\n                                ng-change="onModelChange()"\n                                ng-options="model.id as model.title for model in choices.models">\n                            <option value="">Select Model</option>\n                        </select>\n                    </div>\n\n                    <div class="form-group top-margin-20">\n                        <label class="form-label">SERIES</label>\n                        <select class="form-control" ng-disabled="!isModelEditable()"\n                                ng-model="order.seriesSelection"\n                                ng-change="onSeriesChange()"\n                                ng-options="series.id as series.title for series in choices.series">\n                            <option value="">Select Series</option>\n                        </select>\n                    </div>\n\n                     <div class="form-group top-margin-20">\n                        <label class="form-label">DESIRED DELIVERY MONTHS</label>\n                        <select class="form-control" \n                                ng-model="order.delivery_date"\n                                ng-change="onDeliveryChange()"\n                                ng-options="date.value as date.title for date in choices.available_delivery_months">\n                                <option value=""> Select Date </option> \n                                \n                    </select>\n                    </div>\n\n                   \n\n                    <div class="row top-margin-40">\n                        <div class="col-sm-12">\n                            <button class="btn btn-primary" ng-click="proceed()" ng-if="isModelEditable()">Continue with this Series</button>\n                        </div>\n                    </div>\n\n                    <span>OR</span>\n                </div>\n\n                <div class="col-sm-6 divider">\n                    <h3>Select a previous customer/stock model</h3>\n\n                    <div class="form-group top-margin-20">\n                        <label class="form-label">CUSTOMER NAME OR CHASSIS NUMBER</label>\n                        <lookup result="order_lookup_result" placeholder="Search by Customer Name or Chassis Number"\n                                on-select="onOrderLookupSelect" ng-disabled="!isModelEditable()"\n                                url="orders/search-orders" get-extra-data="orderLookupData" min-length="2"\n                                min-wait="100"></lookup>\n                    </div>\n\n                    <div class="row top-margin-40">\n                        <div class="col-sm-12">\n                            <button class="btn btn-primary" ng-click="assignSelectedOrderAndProceed()" ng-if="isModelEditable()">Continue with items from selected order</button>\n                        </div>\n                     \n                </div>\n            </div>\n\n        </div>\n    </div>\n\n    <div ng-if="modelseries_form.$submitted && (!order.validModel() || !order.validSeries())" class="row top-margin-20">\n        <div class="col-sm-12">\n            <div class="alert alert-warning">\n                Please select a model and series to proceed.\n            </div>\n        </div>\n    </div>\n</form>\n'},function(e,t){e.exports='<top-bar>\n    <h4>{{ current_dealership().title }}</h4>\n    <h2>\n        <span ng-if="!order.id">New </span>\n        {{ order.order_stage_details ? order.order_stage_details.label : \' Quote\' }}\n        {{ order.id }}<span ng-if="order.chassis">, Chassis # {{ order.chassis }}</span>\n        {{ order.order_stage_details.code == \'CANCELLED\' ? \' (Cancelled)\' : \'\' }}\n    </h2>\n\n    <div class="pull-right">\n        <div class="row text-right">\n            <button ng-if="canOrderApprovalBeRequested()" class="btn btn-primary pull-right header-right-button" ng-click="requestOrderApproval()" ng-disabled="!info.items">Request to Place Order</button>\n\n            <button ng-if="canOrderBePlaced()" class="btn btn-primary pull-right header-right-button" ng-click="confirmPlaceOrder()" ng-disabled="!info.items">Place Order</button>\n            <button ng-if="canOrderApprovalBeRejected()" class="btn btn-primary pull-right header-right-button" ng-click="rejectOrderApproval()" ng-disabled="!info.items">Reject Order</button>\n            <button ng-if="canOrderBeCancelled()" class="btn btn-primary pull-right header-right-button" ng-click="confirmCancelOrder()" ng-disabled="!info.items">Cancel Order</button>\n\n            <button ng-if="canOrderBeFinalized()" class="btn btn-primary pull-right header-right-button" ng-click="finalizeOrder()" ng-disabled="!info.items">Lock Order</button>\n\n            <button ng-if="canOrderBeSaved()" class="btn btn-primary pull-right header-right-button" ng-click="saveOrder()" ng-disabled="!info.items">Save {{ order.order_stage_details.label }}</button>\n            <div class="spinner-container"><bar-spinner ng-if="loading.order"></bar-spinner></div>\n        </div>\n        <div class="row text-right top-margin-10">\n            <button ng-if="canCreateOrderForSameCustomer()" class="btn btn-primary pull-right header-right-button" ng-click="newOrderForCustomer()">Start a new Quote for this customer</button>\n        </div>\n    </div>\n\n    <div class="row top-bar-info">\n        <div class="col-sm-2" ng-if="current_dealership()">\n            <h5>Customer</h5>\n            <h4 ng-if="!order.customer">(STOCK)</h4>\n            <h4 ng-if="order.customer">{{ order.customer.first_name }} {{ order.customer.last_name }}</h4>\n        </div>\n        <div class="col-sm-2" ng-if="order.model && order.series">\n            <h5>Model</h5>\n            <h4>{{ order.series_code }}</h4>\n        </div>\n        <div class="col-sm-2" ng-if="order.model && order.series">\n            <h5>Retail Sale price</h5>\n            <h4 name="order_retailprice" ng-if="info.show_price">{{ calculatePrice().price | currency }}</h4>\n            <a href="" ng-click="info.show_price = !info.show_price">\n                <span ng-if="info.show_price">Hide </span>\n                <span ng-if="!info.show_price">Show </span>price\n            </a>\n        </div>\n        <div class="col-sm-1" ng-if="order.model && order.series">\n            <h5>Stage</h5>\n            <h4 name="order_stage">{{ order.order_stage_details.label }}{{ order.is_expired? " (Expired)" : "" }}{{ order.order_stage_details.code == \'CANCELLED\' ? \' (Cancelled)\' : \'\' }}</h4>\n        </div>\n        <div class="col-sm-1" ng-if="order.appretail_opportunity_no">\n            <h5>AppRetail Opportunity</h5>\n            <h4 name="opp_number">{{ order.appretail_opportunity_no }} </h4>\n        </div>\n    </div>\n    <div class="row top-bar-info">\n        <div class="col-sm-4" ng-if="order.model && order.series">\n            <h5>Production Month</h5>\n            <h4>{{ order.production_month?order.production_month:"N/A" }}</h4>\n        </div>\n        <div class="col-sm-4" ng-if="order.model && order.series" ng-hide="true">\n            <h5>Production Date</h5>\n            <h4>{{ order.production_start_date?order.production_start_date:"N/A" }}</h4>\n        </div>\n    </div>\n\n    <div class="row top-bar-info alert alert-danger" ng-if="order.salesforce_sync_error">\n        <div class="col-sm-6">\n            There was an issue on the last sync with Salesforce. Please try again.\n        </div>\n        <div class="col-sm-2">\n            <button ng-click="updateSalesforce()">Update Salesforce</button>\n        </div>\n    </div>\n</top-bar>\n\n<div>\n    <tabs data="tabData" type="tabs" />\n    <a id="message-anchor"></a>\n    <ui-view></ui-view>\n</div>\n\n<div id="cancel_order" class="modal fade">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n                <h3>Cancelling order</h3>\n            </div>\n            <div class="modal-body">\n                <textarea rows="10" cols="65" placeholder="Please enter the reason for cancellation..."\n                          maxlength="2000"\n                          class="form-control"\n                          ng-model="cancelReason"></textarea>\n            </div>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancelOrder()">Cancel Order</button>\n                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n            </div>\n        </div>\n    </div>\n</div>\n\n\n<div id="place_order" class="modal fade">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n                <h4>Confirm Order Placement</h4>\n            </div>\n            <div class="modal-body">\n                <div>\n                    <p>\n                        By selecting <strong>Place Order</strong> you acknowledge that this order becomes irrevocable for a stock unit or will attract $1000 cancellation fee if it is a customer order.\n                    </p>\n                    <p>\n                        If any customer order has passed the lockdown date then that order also becomes irrevocable.\n                    </p>\n                </div>\n            </div>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-default" data-dismiss="modal">Decline</button>\n                <button type="button" class="btn btn-primary" ng-click="placeOrder()" data-dismiss="modal">Place Order</button>\n            </div>\n        </div>\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="status" xmlns="http://www.w3.org/1999/html">\n    <div class="status-spinner"><bar-spinner ng-if="cert_loading" /></div>\n \n    <div ng-if="message" class="alert {{ message.type }}">\n         <div ng-repeat="text in message.message_list">{{ text }}</div> \n    </div>\n\n<div ng-if="message" class="alert {{ message.type }}">\n    <div ng-repeat="text in message.message_list">{{ text }}</div>\n    \n</div>\n\n<div id="status">\n \n \n <CENTER><h3 class="top-margin-40">CERTIFICATES FOR # {{ order.chassis }} </h3> </CENTER>\n \n    <div class="row top-margin-20">\n        <div class="row">\n        <form name="order_certificate_form" ng-submit="updateDoc(order_certificate_form, certificate.file_upload, certificate_type)">\n           <div class="col-sm-2">\n           <label class="form-label">&nbsp;</label>\n            </div>\n            <div class="col-sm-2">\n                <select class="form-control" ng-model="certificate_type" name="certificate_type" ng-change="populateText()">\n                <option value="" selected disabled hidden>Certificate Type</option>\n                <option value="plumbing" >Plumbing</option>\n                <option value="electrical">Electrical</option>">\n                <option value="weighbridge">Weighbridge</option>">\n                <option value="qualitycontrol">Quality Control</option>">\n                <option value="others">Others</option>">\n            </select>\n            </div>\n            \n            <div class="col-sm-2" ng-show="checkcertvalue()">\n                <input type="text" class="form-control" ng-model="certificate_note" name="certificate_note">\n            </div>\n            <div class="col-sm-2">\n                <label class="form-label"></label>\n                <label ng-if="certificate.file_upload">\n                    Selected: {{ certificate.file_upload.name }}\n                </label>\n            </div>\n                <div class="col-sm-2">\n                <button class="form-control btn btn-default" ngf-select\n                        ng-model="certificate.file_upload"\n                        name="certificate">\n                    Select File\n                </button>\n            </div>\n            <div class="col-sm-2">\n                <button type="submit" class="btn btn-primary form-control">Submit</button>\n            </div>\n        </form>\n    </div>\n</div>\n\n    <div class="row header-top">\n        <div class="col-sm-2">Cert Id</div>\n        <div class="col-sm-3">Certificate Title</div>\n        <div class="col-sm-3">File Name</div>\n        <div class="col-sm-2">View</div>\n        <div class="col-sm-2">Delete</div>\n    </div>\n\n\n            <div class="row" ng-repeat="doc in status_docs">\n                        <div class="col-sm-2"> {{ doc.id }} </div>\n                        <div class="col-sm-3"> {{ doc.title }} </div>\n                        <div class="col-sm-3"> {{ doc.file }} </div>\n                        <div class="col-sm-2"><a target="_blank" href="{{ doc.url }}" > Download <a/></div>\n                        <div class="col-sm-2" ng-if="canDeleteCertificates()">\n                            <a href="" ng-click="deleteDoc(doc.id, \'order_certificate_form\')">Delete</a>\n\n                        </div>\n            </div>\n\n\n               \n            </div>\n\n\n\n\n\n'},function(e,t){e.exports=""},function(e,t){e.exports='<div ng-if="message" class="alert {{ message.type }}">\n    <div ng-repeat="text in message.message_list">{{ text }}</div>\n</div>\n\n<div class="container">\n    <div class="row">\n        <div class="col-sm-10 col-sm-offset-1">\n\n            <form name="customer_form" novalidate class="top-margin-40">\n\n                <div class="row">\n                    <div class="form-group col-sm-6">\n                        <label class="form-label">SHOW</label>\n                        <select class="form-control"\n                                ng-model="order.show_id"\n                                ng-options="show.id as show.title for show in choices.shows">\n                            <option value="">\n                                Select a Show\n                            </option>\n                        </select>\n                    </div>\n                    <div class="form-group col-sm-6">\n                        <label class="form-label">DEALERSHIP</label>\n                        <select class="form-control"\n                                name="dealership"\n                                ng-model="order.dealership"\n                                ng-options="dealer.id as dealer.title for dealer in choices.dealerships" required>\n                            <option value="">\n                                {{ order.isEditable() ? \'Select a dealership\' : order.dealership_name }}\n                            </option>\n                        </select>\n                        <div ng-messages="customer_form.dealership.$error" ng-if="customer_form.dealership.$dirty || customer_form.$submitted">\n                            <p ng-message="required">This field is required.</p>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="row top-margin-40">\n                    <div class="col-sm-6"><h4>Customer Details</h4></div>\n                </div>\n\n                <div class="row">\n                    <div class="col-sm-6">\n                        <label class="form-label">LOOKUP EXISTING CUSTOMER</label>\n                        <lookup result="search.customer" min-length="3" min-wait="100"\n                                ng-model="order.customer"\n                                on-select="select_customer" type="customer_lookup" name="customer"\n                                autocomplete="off"></lookup>\n                    </div>\n                </div>\n\n                <div class="row top-margin-20">\n                    <div class="form-group col-sm-6">\n                        <label class="form-label">\n                            FIRST NAME</label>\n                        <input type="text" class="form-control" ng-model="order.customer.first_name" name="first_name" required\n                               ng-disabled="order.customer.id && !editCurrentCustomer"/>\n                        <div ng-messages="customer_form.first_name.$error" ng-if="customer_form.first_name.$dirty || customer_form.$submitted">\n                            <p ng-message="required">This field is required.</p>\n                        </div>\n                    </div>\n                    <div class="form-group col-sm-6">\n                        <label class="form-label">\n                            LAST NAME</label>\n                        <input type="text" class="form-control" ng-model="order.customer.last_name" name="last_name" required\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\n                        <div ng-messages="customer_form.last_name.$error" ng-if="customer_form.last_name.$dirty || customer_form.$submitted">\n                            <p ng-message="required">This field is required.</p>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="row top-margin-20">\n                    <div class="form-group col-sm-6">\n                        <label class="form-label">\n                            EMAIL</label>\n                        <input type="text" class="form-control" ng-model="order.customer.email" name="email"\n                               ng-required="!(order.customer.email.length || order.customer.phone1.length)"\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\n                        <div ng-messages="customer_form.email.$error" ng-if="customer_form.email.$dirty || customer_form.$submitted">\n                            <p ng-message="required">Either the phone number or the email address is required.</p>\n                        </div>\n                    </div>\n\n                    <div class="form-group col-sm-6">\n                        <label class="form-label">OPT IN FOR MAILING LIST\n                            <input type="checkbox" class="form-control form-control-small" ng-model="order.customer.mailing_list" name="mailling_list"\n                                   ng-disabled="order.customer.id && !editCurrentCustomer" />\n                        </label>\n                    </div>\n                </div>\n\n                <div class="row top-margin-20">\n                    <div class="form-group col-sm-6">\n                        <label class="form-label">\n                            PHONE NUMBER</label>\n                        <input type="text" class="form-control" ng-model="order.customer.phone1" name="phone_number"\n                               ng-required="!(order.customer.email.length || order.customer.phone1.length)"\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\n                        <div ng-messages="customer_form.phone_number.$error" ng-if="customer_form.phone_number.$dirty || customer_form.$submitted">\n                            <p ng-message="required">Either the phone number or the email address is required.</p>\n                        </div>\n                    </div>\n                    <div class="form-group col-sm-6">\n                        <label class="form-label">PARTNER\'S NAME</label>\n                        <input type="text" class="form-control" ng-model="order.customer.partner_name" name="partner_name"\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\n                    </div>\n\n                </div>\n\n                <div class="row top-margin-20">\n                    <div class="form-group col-sm-6">\n                        <label class="form-label">TOW VEHICLE</label>\n                        <input type="text" class="form-control" ng-model="order.customer.tow_vehicle" name="tow_vehicle" required\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\n                        <div ng-messages="customer_form.tow_vehicle.$error" ng-if="customer_form.tow_vehicle.$dirty || customer_form.$submitted">\n                            <p ng-message="required">This field is required.</p>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="row top-margin-20">\n                    <div class="form-group col-sm-6">\n                        <label class="form-label">\n                            WHERE DID YOU HEAR FROM US?</label>\n                        <select class="form-control"\n                                ng-model="order.customer.source_of_awareness"\n                                name="referral"\n                                ng-options="source_of_awareness.id as source_of_awareness.title for source_of_awareness in choices.source_of_awareness" required\n                                ng-disabled="order.customer.id && !editCurrentCustomer">\n                            <option value="">Select an option</option>\n                        </select>\n                        <div ng-messages="customer_form.referral.$error" ng-if="customer_form.referral.$dirty || customer_form.$submitted">\n                            <p ng-message="required">This field is required.</p>\n                        </div>\n                    </div>\n                    <div class="form-group col-sm-6">\n                        <label class="form-label">\n                            METHOD OF CONTACT?</label>\n                        <select class="form-control"\n                                ng-model="order.customer.acquisition_source"\n                                name="referral"\n                                ng-options="acquisition_source.id as acquisition_source.title for acquisition_source in choices.acquisition_source" required\n                                ng-disabled="order.customer.id && !editCurrentCustomer">\n                            <option value="">Select an option</option>\n                        </select>\n                        <div ng-messages="customer_form.referral.$error" ng-if="customer_form.referral.$dirty || customer_form.$submitted">\n                            <p ng-message="required">This field is required.</p>\n                        </div>\n                    </div>\n                </div>\n\n                <div ng-if="order.customer.id" class="row">\n                    <div class="col-sm-offset-6 col-sm-3">\n                        <button type="button" class="btn btn-primary" ng-click="clearCustomer()">Create new customer</button>\n                    </div>\n                    <div class="col-sm-3">\n                        <button type="button" class="btn btn-primary" ng-click="editCustomerFields()">Edit customer details</button>\n                    </div>\n                </div>\n\n\n                <!-- Address -->\n\n\n                <div class="row top-margin-40">\n                    <div class="col-sm-6"><h4>Address</h4></div>\n                </div>\n\n                <div class="row top-margin-20">\n                    <div class="form-group col-sm-6">\n                        <label class="form-label">REGISTERED OWNER</label>\n                        <input type="text" class="form-control" ng-model="order.customer.physical_address.name"\n                               name="registered_owner" required\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\n                        <div ng-messages="customer_form.registered_owner.$error" ng-if="customer_form.registered_owner.$dirty || customer_form.$submitted">\n                            <p ng-message="required">This field is required.</p>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="row top-margin-20">\n                    <div class="form-group col-sm-6">\n                        <label class="form-label">STREET ADDRESS</label>\n                        <input type="text" class="form-control" ng-model="order.customer.physical_address.address" name="street" required\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\n                        <div ng-messages="customer_form.street.$error" ng-if="customer_form.street.$dirty || customer_form.$submitted">\n                            <p ng-message="required">This field is required.</p>\n                        </div>\n                    </div>\n                    <div class="form-group col-sm-6" ng-if="!order.customer.id || editCurrentCustomer">\n                        <label class="form-label">LOOKUP CITY OR SUBURB</label>\n                        <lookup result="search.physical_suburb" min-length="3" min-wait="100"\n                                ng-model="order.customer.physical_address.suburb.name"\n                                on-select="select_physical_suburb" type="suburb_lookup" name="physical_address_suburb"\n                                autocomplete="off"></lookup>\n                    </div>\n                </div>\n\n                <div class="row top-margin-20">\n                    <div class="form-group col-sm-6">\n                        <label class="form-label">CITY</label>\n                        <input type="text" class="form-control" ng-model="order.customer.physical_address.suburb.name" name="suburb" required\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\n                        <div ng-messages="customer_form.suburb.$error" ng-if="customer_form.suburb.$dirty || customer_form.$submitted">\n                            <p ng-message="required">This field is required.</p>\n                        </div>\n                    </div>\n                    <div class="form-group col-sm-4">\n                        <label class="form-label">STATE</label>\n                        <select class="form-control" ng-options="s.code as s.title for s in choices.states"\n                                ng-model="order.customer.physical_address.suburb.post_code.state.code" name="state" required\n                                ng-disabled="order.customer.id && !editCurrentCustomer">\n                            <option value="">Select State</option>\n                        </select>\n                        <div ng-messages="customer_form.state.$error" ng-if="customer_form.state.$dirty || customer_form.$submitted">\n                            <p ng-message="required">This field is required.</p>\n                        </div>\n                    </div>\n                    <div class="form-group col-sm-2">\n                        <label class="form-label">POSTCODE</label>\n                        <input type="text" class="form-control" ng-model="order.customer.physical_address.suburb.post_code.number" name="post_code" required ng-pattern="/^\\d{4}$/"\n                               ng-disabled="order.customer.id && !editCurrentCustomer" />\n                        <div ng-messages="customer_form.post_code.$error" ng-if="customer_form.post_code.$dirty || customer_form.$submitted">\n                            <p ng-message="required">This field is required.</p>\n                            <p ng-message="pattern">Postcode must be 4 digits.</p>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="form-group col-sm-6 col-sm-offset-3 top-margin-40">\n                    <label class="control-label"></label>\n\n                    <div class="col-sm-4 pull-right">\n                        <button type="submit" class="btn btn-primary form-control"\n                                ng-click="customerProceed(customer_form)">Continue\n                        </button>\n                    </div>\n                </div>\n            </form>\n\n        </div>\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="container model-select">\n    <div class="row">\n        <div class="col-sm-12">\n            <h2>Select a model</h2>\n\n            <div class="model-panel" ng-repeat="model in choices.model_series|filter:hasModelAvailableSeries" ng-click="onModelClick(model)">\n                <div class="model-logo">\n                    <img ng-src="{{ model.logo }}" class="series-image"/>\n                </div>\n            </div>\n\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="container series-photos">\n    <div class="row">\n        <div class="col-sm-12">\n            <h2><span class="series-code">{{ current.series.code }}</span> {{ current.series.name }}</h2>\n        </div>\n    </div>\n    <div class="row" ng-repeat="photo in current.series.photos">\n        <div class="col-sm-12">\n            <img ng-src="{{ photo.url }}" class="series-photo" width="600px" />\n        </div>\n    </div>\n\n    <button class="btn btn-primary" ng-click="onSeriesSelect()">Select Series</button>\n    <div ng-if="errors.series_select" class="top-margin-30 alert alert-danger">{{ errors.series_select }}</div>\n</div>\n'},function(e,t){e.exports='<div class="container series-select">\n    <div class="row">\n        <div class="col-sm-12">\n            <h2>Select a series</h2>\n\n            <div class="model-banner"><img ng-src="{{ current.model.logo }}" class="model-logo"/></div>\n\n            <div class="series-panel" ng-repeat="series in current.model.series|filter:isSeriesAvailableForDealership">\n                <div ng-if="series.photos.length">\n                    <img ng-src="{{ series.photos[0].url }}" class="series-image"/>\n                </div>\n                <h4><span class="series-code">{{ series.code }}</span> {{ series.name }}</h4>\n                <div class=\'row\'>\n                    <button class=\'col-sm-6\' ng-click="onViewSeriesPhotoClick(series)">View Series photos</button>\n                    <button class=\'col-sm-6\' ng-click="onStartQuoteClick(series)">Start a quote</button>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="showroom">\n    <ui-view></ui-view>\n</div>\n'},function(e,t){e.exports='<div ng-if="message" class="alert {{ message.type }}">\n    <div ng-repeat="text in message.message_list">{{ text }}</div>\n    \n</div>\n\n<div id="special_features">\n    <!-- <label ><b>{{ order.model }} </b></label>\n    <p> Is Dealership User<label>{{ permissions.user_details }}</label> -->\n        \n        <div ng-if=checkdisplayview()>  \n        \n\n    <div class="row top-row" ng-if="permissions.set_custom_series">\n        <div class="col-sm-5 col-sm-offset-1">\n            <label for="custom_series_name">Custom series name:</label>\n            <input id="custom_series_name" ng-model="order.custom_series_name" />\n        </div>\n        <div class="col-sm-5">\n            <label for="custom_series_code">Custom series code:</label>\n            <input id="custom_series_code" ng-model="order.custom_series_code" />\n        </div>\n    </div>\n\n    <table>\n        <tr>\n            <th>Customer Description</th>\n            <th ng-if="permissions.modify_special_features_wholesale" class="price-header">$ Wholesale</th>\n            <th class="price-header">$ Retail</th>\n            <th class="attachment-header">Attachment</th>\n            <th class="button-header">Remove</th>\n            <th class="button-header">Approved</th>\n        </tr>\n\n    <tr ng-repeat-start="feature in order.special_features" ng-class-odd="\'odd\'" ng-class-even="\'even\'">\n            <td>\n                <input type="text" class="form-control" placeholder="e.g. ..." ng-disabled="!order.isEditable()"\n                    ng-change="onFeatureDetailChange(feature)"\n                    ng-model="feature.customer_description"/>\n            </td>\n\n            <td ng-if="permissions.modify_special_features_wholesale">\n                <input ng-disabled="order.customer_plans_approved"\n                    type="text" class="form-control"  maxlength="8"\n                    ng-change="onFeatureDetailChange(feature)"\n                    ng-model="feature.wholesale_price" />\n            </td>\n\n            <td>\n                <input type="text" class="form-control" maxlength="8"\n                    ng-change="onFeatureDetailChange(feature)"\n                    ng-model="feature.retail_price" ng-disabled="!order.isEditable()" />\n            </td>\n\n            <td>\n                <div class="form-group attachment">\n                    <div ng-if="feature.new_document || feature.document">\n                        <label>\n                            Specification doc:\n                        </label>\n                        <a ng-if="!feature.new_document" href="{{ feature.document.url }}" target="_blank">{{ feature.document.name }}</a>\n                        <span ng-if="feature.new_document">{{ feature.new_document.name }}</span>\n                        <button class="form-control btn btn-default" ng-if="order.isEditable()"\n                            ng-click="removeFeatureDocument(feature)">\n                            Remove Document\n                        </button>\n                    </div>\n                    <div ng-if="!feature.new_document && !feature.document">\n                        <button class="form-control btn btn-default" ngf-select ng-disabled="!order.isEditable()"\n                            ng-model="feature.new_document">\n                            Add Document\n                        </button>\n                    </div>\n                </div>\n            </td>\n\n            <td>\n                <button type="text" class="form-control btn btn-primary remove-special-feature" ng-disabled="!order.isEditable()"\n                        ng-click="removeSpecialFeature($index)">\n                    <span class="glyphicon glyphicon-minus"></span>\n                </button>\n            </td>\n\n            <td class="approval-state">\n                <span ng-if="feature.approved !== null"\n                      class="status glyphicon {{ feature.approved ? \'glyphicon-ok-sign\' : \'glyphicon-remove-sign\' }}"\n                      ng-class="permissions.approve_special_features ? \'clickable\' : \'\'"\n                      ng-click="permissions.approve_special_features ? feature.approved = null : \'\'"></span>\n\n                <span ng-if="!permissions.approve_special_features && feature.approved === null" class="status glyphicon glyphicon-question-sign"></span>\n\n                <div ng-if="permissions.approve_special_features && feature.approved === null">\n                    <button type="button" class="btn btn-xs btn-success" ng-click="feature.approved = true">\n                        <span class="glyphicon glyphicon-ok-sign"></span>\n                    </button>\n                    <button type="button" class="btn btn-xs btn-danger" ng-click="feature.approved = false">\n                        <span class="glyphicon glyphicon-remove-sign"></span>\n                    </button>\n                </div>\n            </td>\n        </tr>\n\n        <tr ng-if="feature.approved === false" ng-class-odd="\'odd\'" ng-class-even="\'even\'">\n            <td colspan="999">\n                <input class="form-control error" ng-model="feature.reject_reason" ng-readonly="!permissions.approve_special_features" placeholder="Enter reason for rejection.."/>\n            </td>\n        </tr>\n\n        <tr ng-if="permissions.modify_special_features" ng-class-odd="\'odd\'" ng-class-even="\'even\'">\n            <td class="label">Work Centre:</td>\n            <td colspan="3">\n                <label>  {{ getCategory(feature) }}  \n                    \n                 </label>\n                <select class="form-control"\n                    ng-model="feature.selectedCategory"\n                    ng-change="onSpecialFeatureCategorySelect(feature)"\n                    ng-options="c as c.title for c in choices.categories track by c.id">\n\n                    <option value="">(None)</option>\n                </select>\n            </td>\n            <td colspan="999"></td>\n        </tr>\n\n        <tr ng-if="permissions.modify_special_features" ng-class-odd="\'odd\'" ng-class-even="\'even\'">\n            <td class="label">Replaces Item:</td>\n            <td colspan="3">\n                <label>     Item : {{  replaceItem }} \n                </label>\n                <select class="form-control"\n                    ng-model="feature.selectedDepartment"\n                    ng-change="onSpecialFeatureDepartmentSelect(feature)"\n                    ng-options="d as d.title disable when d.id == null for d in feature.departmentList track by d.id">\n\n                    <option value="">(None)</option>\n                </select>\n            </td>\n            <td colspan="999"></td>\n        </tr>\n\n        <tr ng-repeat-end ng-if="permissions.modify_special_features" ng-class-odd="\'odd\'" ng-class-even="\'even\'">\n            <td class="label">Factory Description / Production Note:</td>\n            <td colspan="3">\n                <input class="form-control" type="text" ng-model="feature.factory_description" />\n            </td>\n            <td colspan="999"></td>\n        </tr>\n\n        <tr class="spacer"><td></td></tr>\n\n        <tr ng-if="order.isEditable()">\n            <td colspan="{{ permissions.modify_special_features_wholesale ? \'4\' : \'3\' }}">&nbsp;</td>\n            <td>\n                <button type="text" class="form-control btn btn-info add-special-feature" ng-click="addSpecialFeature()">\n                    <span class="glyphicon glyphicon-plus"></span>\n                </button>\n            </td>\n        </div>\n\n    </table>\n</div>\n\n</div>\n</div>\n\n\n\n\n';
},function(e,t){e.exports='<div class="row task-row" ng-if="permission">\n    <div class="col-sm-2">{{ title }}</div>\n    <div ng-if="stage" class="col-sm-2 stage-badge {{ statusClass(stage) }}">{{ stage.status }}<i ng-if="stage.status==\'Complete\'" class="glyphicon glyphicon-ok"></i><i ng-if="stage.status==\'Rejected\'" class="glyphicon glyphicon-remove"></i></div>\n    <div ng-if="!stage" class="col-sm-2"><i>Not yet required</i></div>\n    <div class="col-sm-6"><div ng-transclude></div></div>\n    <div class="col-sm-2"><span ng-if="stage.submitted_on">{{ stage.submitted_on | date : AppSettings.FORMAT_DATE_JS }}</span><br><span ng-if="stage.submitted_by">{{ stage.submitted_by }}</span></div>\n</div>\n'},function(e,t){e.exports='<div class="status" xmlns="http://www.w3.org/1999/html">\n    <div class="status-spinner"><bar-spinner ng-if="loading" /></div>\n \n    <div ng-if="message" class="alert {{ message.type }}">\n         <div ng-repeat="text in message.message_list">{{ text }}</div> \n    </div>\n \n    <div>\n        <div class="row">\n            <div class="col-sm-6">\n                <label>Dealer Sales Representative:</label> {{ order.dealer_sales_rep_name }}\n                <br />\n                <button class="btn btn-default" ng-if="canChangeSalesRep()" ng-click="onOpenUpdateSalesRep()" type="button">Change Sales Representative</button>\n            </div>\n            <div class="col-sm-6">\n                <label>Customer Manager:</label> {{ order.customer_manager_name }}\n                <br />\n                <button class="btn btn-default" ng-click="onOpenUpdateCustomerManager()" type="button">Change Customer Manager</button>\n            </div>\n        </div>\n    </div>\n\n\n    <div class="row header-top">\n        <div class="col-sm-2">Stage / Task</div>\n        <div class="col-sm-2">Status</div>\n        <div class="col-sm-6">Data and Documents</div>\n        <div class="col-sm-2">Submitted</div>\n    </div>\n\n    <div class="status-container">\n        <div class="row task-row sub-header" ng-if="status.permissions.any_quote">\n            <div class="col-sm-12">\n                <h4>\n                    <i class="glyphicon glyphicon-flag"\n                       ng-class="{\'section-complete\':sectionComplete(status.quote)}"></i>\n                    Quote\n                </h4>\n            </div>\n        </div>\n\n        <status-row title="Customer Details Captured" stage="status.quote.customer_details_captured" permission="status.permissions.view_status_customer_details_captured"></status-row>\n        <status-row title="Selections Completed" stage="status.quote.caravan_details_saved" permission="status.permissions.view_status_caravan_details_saved"></status-row>\n        <status-row title="Order Placement Requested" stage="status.quote.caravan_order_requested" permission="status.permissions.view_status_caravan_order_requested"></status-row>\n        <status-row title="Deposit Paid" stage="status.approval.deposit_paid" permission="status.permissions.view_status_deposit_paid">\n            <form ng-if="status.approval.deposit_paid"\n                  name="deposit_form"\n                  ng-submit="updateDeposit(deposit_form, status.approval.deposit_paid.data)">\n                <div class="form-group col-md-6">\n                    <label class="form-label">$ DEPOSIT AMOUNT</label>\n                    <input type="number" class="form-control" ng-model="status.approval.deposit_paid.data"\n                           name="deposit_amount" required ng-disabled="!status.approval.deposit_paid.permission"/>\n                </div>\n                <div class="col-md-6" ng-if="status.approval.deposit_paid.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Confirm Payment</button>\n                </div>\n            </form>\n        </status-row>\n        <status-row title="Order Placed" stage="status.quote.caravan_ordered" permission="status.permissions.view_status_caravan_ordered">\n            <span ng-if="status.quote.caravan_ordered.schedule_date">\n                The order is currently scheduled for {{ status.quote.caravan_ordered.schedule_date | date: AppSettings.FORMAT_DATE_MONTH_JS }}.\n            </span>\n        </status-row>\n        <status-row title="Special features reviewed" stage="status.approval.special_features_reviewed" permission="status.permissions.view_status_special_features_reviewed">\n            <div ng-if="status.approval.special_features_reviewed && status.approval.special_features_reviewed.status == \'Requires Action\' && status.approval.special_features_reviewed.permission">\n                <a ui-sref="order.special_features">Review special features</a>\n            </div>\n        </status-row>\n\n        <status-row title="Order Locked" stage="status.quote.caravan_order_finalized_at" permission="status.permissions.view_status_caravan_finalized">\n            <div ng-if="status.quote.caravan_order_finalized_at.cancelled_at">\n                The order lock has been cancelled on {{ status.quote.caravan_order_finalized_at.cancelled_at | date: AppSettings.FORMAT_DATETIME_JS }} by {{ status.quote.caravan_order_finalized_at.cancelled_by }}.<br>\n                Reason: {{ status.quote.caravan_order_finalized_at.cancel_reason }}\n            </div>\n            <div ng-if="status.quote.caravan_order_finalized_at.status == \'Complete\' && status.quote.caravan_order_finalized_at.permission">\n                <div class="form-group col-md-6 col-md-offset-3">\n                    <button type="button" ng-click="cancelFinalization()" class="btn btn-primary form-control">Cancel Order Lock</button>\n                    <span ng-if="status.quote.caravan_order_finalized_at.auto_finalization">\n                     This order has been auto locked.\n                    </span>\n                </div>\n            </div>\n        </status-row>\n\n        <div class="row task-row sub-header" ng-if="status.permissions.any_order_awaiting_approval">\n            <div class="col-sm-12">\n                <h4>\n                    <i class="glyphicon glyphicon-flag"\n                       ng-class="{\'section-complete\':status.approval.marked_as_approved.status === \'Complete\'}"></i>\n                    Order Awaiting Approval\n                </h4>\n            </div>\n        </div>\n\n        <status-row title="Chassis Number Appointed" stage="status.approval.chassis_appointed" permission="status.permissions.view_status_chassis_number_appointed">\n            <form ng-if="status.approval.chassis_appointed" name="chassis_number_form"\n                  ng-submit="updateChassis()">\n                <div class="form-group col-md-6">\n                    <label class="form-label">CHASSIS NUMBER</label>\n                    <input type="text" class="form-control" ng-model="status.approval.chassis_appointed.data"\n                           name="chassis_number" required ng-disabled="!status.approval.chassis_appointed.permission && !status.approval.chassis_appointed.override_permission"\n                           ng-readonly="!editingChassis"\n                           focus-me="{{ editingChassis }}" />\n\n                </div>\n                <div class="form-group col-md-6" ng-if="status.approval.chassis_appointed.permission && !status.approval.chassis_appointed.data">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Assign Chassis Number</button>\n                </div>\n\n                <div class="col-sm-12"></div>\n\n                <div class="form-group col-md-6" ng-if="status.approval.chassis_appointed.override_permission">\n                    <button ng-if="!editingChassis" type="button" ng-click="enableChassisEdition()" class="btn btn-primary form-control">Manually Set Chassis Number</button>\n                    <button ng-if="editingChassis" type="button" ng-click="setChassis()" class="btn btn-primary form-control">Confirm</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Drafter Appointed" stage="status.approval.drafter_appointed" permission="status.permissions.view_status_drafter_appointed">\n            <form ng-if="status.approval.drafter_appointed" name="drafter_form"\n                  ng-submit="updateDrafter(drafter_form, status.approval.drafter_appointed.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">DRAFTER</label>\n                    <select type="date" class="form-control" ng-model="status.approval.drafter_appointed.data"\n                            ng-options="u[0] as u[1] for u in status.approval.drafter_appointed.choices"\n                            name="drafter" required ng-disabled="!status.approval.drafter_appointed.permission"></select>\n                </div>\n                <div class="col-md-4" ng-if="status.approval.drafter_appointed.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Appoint</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Customer Plans & Specs Produced" stage="status.approval.customer_plans_produced" permission="status.permissions.view_status_customer_plans_specs_produced">\n            <form name="customer_plans_form"\n                  ng-submit="updateDoc(customer_plans_form, status.approval.customer_plans_produced.file_upload, \'customer\')">\n                <div class="form-group col-md-4" ng-if="status.approval.customer_plans_produced.permission">\n                    <label class="form-label">CUSTOMER PLANS</label>\n                    <label ng-if="status.approval.customer_plans_produced.file_upload.name">\n                        Selected: {{ status.approval.customer_plans_produced.file_upload.name }}\n                    </label>\n                    <button class="form-control btn btn-default" ngf-select\n                            ng-model="status.approval.customer_plans_produced.file_upload"\n                            name="customer_plan" required>\n                        Select Plan\n                    </button>\n                    <button type="submit" class="btn btn-primary form-control">Upload</button>\n                </div>\n                <div class="col-md-8" ng-if="status.approval.customer_plans_produced">\n                    <label class="form-label">UPLOADED</label>\n                    <div class="view-specifications" ng-if="permissions.print_for_autocad">\n                        <a href="javascript:void(0);" ng-click="onPrintAutocad()">View Specifications</a>\n                    </div>\n                    <div ng-repeat="plan in status.approval.customer_plans_produced.data">\n                        <b>{{ plan.file }}</b>\n                        <span><a target="_blank" href="{{ plan.url }}">View</a>&nbsp;<a  ng-if="status.approval.customer_plans_produced.permission" href="" ng-click="deleteDoc(plan.id, \'customer\')">Delete</a></span>\n                    </div>\n                </div>\n            </form>\n        </status-row>\n\n        <!-- TODO: Client wants this removed but has indicated they may bring it back -->\n        <!--\n            <status-row class="hide" title="Customer plan approval" stage="status.approval.customer_plan_reviewed" permission="status.permissions.view_status_customer_plan_approval">\n                <div ng-if="status.approval.customer_plan_reviewed">\n                    <div ng-if="status.approval.customer_plan_reviewed.status == \'Requires Action\' && status.approval.customer_plan_reviewed.permission">\n                        <div class="checkbox">\n                            <label>\n                                <input type="checkbox" ng-model="status.approval.customer_plan_reviewed.customer_plan_disclaimer_checked" />\n                                <i>I acknowledge that once the plan is approved, no changes can be made and production will be as per the current plan. NAC will not take responsibility for any loss due to any future change.</i>\n                            </label>\n                        </div>\n                        <div class="checkbox">\n                            <label>\n                                <input type="checkbox" ng-model="status.approval.customer_plan_reviewed.weight_estimate_disclaimer_checked" />\n                                <i>I understand that the weights and dimensions provided are an estimate only and that the final weights and dimensions will depend on the customer\'s final specifications</i>\n                            </label>\n                        </div>\n\n                        <div class="form-group col-md-6">\n                            <button type="button" ng-click="confirmRejectCustomerPlan()" class="btn btn-primary form-control">\n                                Reject Customer Plan\n                            </button>\n                        </div>\n                        <div class="form-group col-md-6">\n                            <button type="button" ng-click="approveCustomerPlan()" class="btn btn-primary form-control btn-success"\n                                    ng-disabled="!status.approval.customer_plan_reviewed.customer_plan_disclaimer_checked || !status.approval.customer_plan_reviewed.weight_estimate_disclaimer_checked">\n                                Approve Customer Plan\n                            </button>\n                        </div>\n                    </div>\n\n                    <div ng-if="status.approval.customer_plan_reviewed.status == \'Rejected\'">\n                        Reject reason: {{ status.approval.customer_plan_reviewed.reject_reason }}\n                    </div>\n                </div>\n            </status-row>\n        -->\n\n        <status-row title="Factory Plans Produced" stage="status.approval.factory_plans_produced" permission="status.permissions.view_status_factory_plans_produced">\n            <form name="factory_plans_form"\n                  ng-submit="updateDoc(factory_plans_form, status.approval.factory_plans_produced.file_upload, \'factory\')">\n\n                <div class="form-group col-md-4" ng-if="status.approval.factory_plans_produced.permission">\n                    <label class="form-label">FACTORY PLANS</label>\n                    <label ng-if="status.approval.factory_plans_produced.file_upload.name">\n                        Selected: {{ status.approval.factory_plans_produced.file_upload.name }}\n                    </label>\n                    <button class="form-control btn btn-default" ngf-select\n                            ng-model="status.approval.factory_plans_produced.file_upload"\n                            name="factory_plan" required>\n                        Select Plan\n                    </button>\n                    <button type="submit" class="btn btn-primary form-control">Upload</button>\n                </div>\n                <div class="col-md-8" ng-if="status.approval.factory_plans_produced">\n                    <label class="form-label">UPLOADED</label>\n                    <div ng-repeat="plan in status.approval.factory_plans_produced.data">\n                        <b>{{ plan.file }}</b>\n                        <span ng-if="plan.file"><a target="_blank" href="{{ plan.url }}">View</a>&nbsp;<a ng-if="status.approval.factory_plans_produced.permission" href="" ng-click="deleteDoc(plan.id, \'factory\')">Delete</a></span>\n                    </div>\n                </div>\n                <div class="col-md-8 col-md-offset-4" ng-if="status.approval.factory_plans_produced && (status.approval.factory_plans_produced.status != \'Complete\' || !status.approval.factory_plans_produced.data[0].file)">\n                    <label>\n                        <input type="checkbox" ng-model="status.approval.factory_plans_produced.data[0].is_separated" ng-change="updateSeparateDoc(status.approval.factory_plans_produced.data[0], \'factory\')"/>\n                        Plans attached separately\n                    </label>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Chassis Plans Produced" stage="status.approval.chassis_plans_produced" permission="status.permissions.view_status_chassis_plans_produced">\n            <form name="chassis_plans_form"\n                  ng-submit="updateDoc(chassis_plans_form, status.approval.chassis_plans_produced.file_upload, \'chassis\')">\n                <div class="form-group col-md-4" ng-if="status.approval.chassis_plans_produced.permission">\n                    <label class="form-label">CHASSIS PLANS</label>\n                    <label ng-if="status.approval.chassis_plans_produced.file_upload.name">\n                        Selected: {{ status.approval.chassis_plans_produced.file_upload.name }}\n                    </label>\n                    <button class="form-control btn btn-default" ngf-select\n                            ng-model="status.approval.chassis_plans_produced.file_upload"\n                            name="chassis_plan" required>\n                        Select Plan\n                    </button>\n                    <button type="submit" class="btn btn-primary form-control">Upload</button>\n                </div>\n                <div class="col-md-8" ng-if="status.approval.chassis_plans_produced">\n                    <label class="form-label">UPLOADED</label>\n                    <div ng-repeat="plan in status.approval.chassis_plans_produced.data">\n                        <b>{{ plan.file }}</b>\n                        <span ng-if="plan.file"><a target="_blank" href="{{ plan.url }}">View</a>&nbsp;<a ng-if="status.approval.chassis_plans_produced.permission" href="" ng-click="deleteDoc(plan.id, \'chassis\')">Delete</a></span>\n                        <p>\n                         \n                    </div>\n                </div>\n                <div class="col-md-8 col-md-offset-4" ng-if="status.approval.chassis_plans_produced && (status.approval.chassis_plans_produced.status != \'Complete\' || !status.approval.chassis_plans_produced.data[0].file)">\n                    <label>\n                        <input type="checkbox" ng-model="status.approval.chassis_plans_produced.data[0].is_separated" ng-change="updateSeparateDoc(status.approval.chassis_plans_produced.data[0], \'chassis\')"/>\n                        Plans attached separately\n                    </label>\n                   \n\n                </div>\n            </form>\n        </status-row>\n<!-- status.permissions.can_delete_certificates -->\n         <status-row title="Verified By Senior Designer" stage="status.approval.senior_designer_verfied_date" permission="status.permissions.view_status_senior_designer_verfied_date">\n           \n            <form ng-if="status.approval.senior_designer_verfied_date" name="senior_designer_verfied_date_form"\n                  ng-submit="updateSeniorDesigner(senior_designer_verfied_date_form,senior_designer_date_control)">\n                \n                <div class="form-group col-md-8">\n                    <label class="form-label">Senior Designer Verfied Date</label>\n                    \n<input type="date" class="form-control" ng-model="senior_designer_date_control"  ng-disabled="!status.permissions.can_update_senior_designer_verfied_date">\n                </div>\n\n\n                <div class="col-md-4" ng-if="status.permissions.can_update_senior_designer_verfied_date">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n\n            </form>\n        </status-row>\n\n        \n        <status-row title="Purchase Order Raised " stage="status.approval.purchase_order_raised_date" permission="status.permissions.view_status_purchase_order_raised_date">\n            \n            <form ng-if="status.approval.purchase_order_raised_date" name="purchase_order_raised_date_form"\n                  ng-submit="updatePurchaseOrderRaised(purchase_order_raised_date_form, purchase_order_date_control)">\n                \n                <div class="form-group col-md-8">\n                    <label class="form-label">Purchase Order Raised</label>\n                    <input type="date" class="form-control" ng-model="purchase_order_date_control"  ng-disabled="!status.permissions.can_update_senior_designer_verfied_date">         \n\n                </div>\n                <div class="col-md-4" ng-if="status.permissions.can_update_purchase_order_raised_date">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n       \n\n\n        <div class="row task-row sub-header" ng-if="status.permissions.any_delivery">\n            <div class="col-sm-12">\n                <h4>\n                    <i class="glyphicon glyphicon-flag"\n                       ng-class="{\'section-complete\':sectionComplete(status.delivery)}"></i>\n                    Production \n                </h4>\n            </div>\n        </div>\n\n        <status-row title="VIN Number Assigned" stage="status.delivery.vin_number" permission="status.permissions.view_status_vin_number">\n            <form ng-if="status.delivery.vin_number" name="vin_number_form"\n                  ng-submit="updateVinNumber(vin_number_form, status.delivery.vin_number.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">VIN</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.vin_number.data"\n                           name="vin_number" required ng-disabled="!status.delivery.vin_number.permission"\n                           ng-pattern="/^.{11}\\d{6}$/" />\n                    <span class="error" ng-show="vin_number_form.vin_number.$error.pattern">VIN Number must be AAAAAAAAAAANNNNNN</span>\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.vin_number.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n        <!-- New Code -->\n        <status-row title="Actual Production Date" stage="status.delivery.actual_production_date" permission=" status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.actual_production_date" name="actual_production_date_form"\n                   ng-submit="updateActualProductionDate(actual_production_date_form,production_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Actual Production Date</label>\n\n                  <br>\n                     <input type="date" class="form-control" ng-model="production_date_control" >\n\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n                </form>\n                <form name="del_actual_production_date_form"  ng-submit="deleteActualProdDate(del_actual_production_date_form,status.delivery.actual_production_date.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n                </div>\n                </form>\n        </status-row>\n\n       <!--  <status-row title=" Production Comments " stage="status.delivery.actual_production_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.actual_production_comments" name="actual_production_comments_form"\n                  ng-submit="updateActualProductionComments(actual_production_comments_form, status.delivery.actual_production_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">  Production Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.actual_production_comments.data"\n                           name="actual_production_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row> -->\n\n        <!-- Chassis Section -->\n         <status-row title="Chassis Section Date" stage="status.delivery.chassis_section" permission="status.permissions.view_status_qc_date_planned">\n            \n            <form ng-if="status.delivery.chassis_section" name="chassis_section"\n                  ng-submit="updateChassisSectionDate(chassis_section, chassis_date_control)">\n                \n                <div class="form-group col-md-8">\n                <label class="form-label"> Chassis Section Date</label>\n                 <input type="date" class="form-control" ng-model="chassis_date_control" name="chassis_date_id" \n                    id="chassis_date_id" >\n                    </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n\n            </form>\n\n                <form  name="del_chassis_section" ng-submit="deleteChassisSection(del_chassis_section,status.delivery.chassis_section.data)"  >\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n                </div>\n                </form>\n        </status-row>\n\n        <status-row title="Chassis Section Comments" stage="status.delivery.chassis_section_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.chassis_section_comments" name="chassis_section_comments"\n                  ng-submit="updateChassisSectionComments(chassis_section_comments, status.delivery.chassis_section_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Chassis Section Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.chassis_section_comments.data"\n                           name="chassis_section_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n<!-- Building Section -->\n         <status-row title="Building Section Date" stage="status.delivery.building" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.building" name="building"\n                  ng-submit="updateBuildingDate(building, building_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Building Date</label>\n                <input type="date" class="form-control" ng-model="building_date_control" name="build_date_id" \n                    id="build_date_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n\n            <form name="del_building_section" ng-submit="deleteBuildingSection(del_building_section,status.delivery.building.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n                </div>\n            </form>\n                \n        </status-row>\n\n        <status-row title="Building Comments" stage="status.delivery.building_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.building_comments" name="building_comments"\n                  ng-submit="updateBuildingComments(building_comments, status.delivery.building_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Building Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.building_comments.data"\n                           name="building_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n\n\n<!-- Pre-Wire Section -->\n         <status-row title="Pre-Wire Section Date" stage="status.delivery.prewire_section" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.prewire_section" name="prewire_section"\n                  ng-submit="updatePrewireDate(prewire_section, prewire_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Pre-Wire Date</label>\n\n        <input type="date" class="form-control" ng-model="prewire_date_control" name="prewire_date_id" \n                    id="prewire_date_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n\n              <form name="del_prewire_section" ng-submit="deletePrewireSection(del_prewire_section,status.delivery.prewire_section.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n                </div>\n                </form>\n        </status-row>\n\n        <status-row title="Prewire Comments" stage="status.delivery.prewire_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.prewire_comments" name="prewire_comments"\n                  ng-submit="updatePrewireComments(prewire_comments, status.delivery.prewire_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Prewire Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.prewire_comments.data"\n                           name="prewire_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n<!-- Plumbing Date -->\n         <status-row title="Plumbing Section Date" stage="status.delivery.plumbing_date" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.plumbing_date" name="plumbing_date"\n                  ng-submit="updatePlumbingDate(plumbing_date, plumbing_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Plumbing Date</label>\n                    <input type="date" class="form-control" ng-model="plumbing_date_control" name="plumbing_date_id" id="plumbing_date_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n\n              <form name="del_plumbing_date" ng-submit="deletePlumbingDate(del_plumbing_date,status.delivery.plumbing_date.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n                </div>\n                </form>\n        </status-row>\n\n        <status-row title="Plumbing Comments" stage="status.delivery.plumbing_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.plumbing_comments" name="plumbing_comments"\n                  ng-submit="updatePlumbingComments(plumbing_comments, status.delivery.plumbing_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Plumbing Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.plumbing_comments.data"\n                           name="plumbing_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n\n\n<!-- Aluminium Section -->\n         <status-row title="Aluminium / Fit Off" stage="status.delivery.aluminium" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.aluminium" name="aluminium"\n                  ng-submit="updateAluminiumDate(aluminium, aluminium_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Aluminium / Fit Off</label>\n                    <input type="date" class="form-control" ng-model="aluminium_date_control" name="aluminium_date_id" id="aluminium_date_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n            <form name="del_aluminium_section" ng-submit="deleteAluminiumSection(del_aluminium_section,status.delivery.aluminium.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n        </status-row>\n\n        <status-row title="Aluminium / Fit Off Comments" stage="status.delivery.aluminium_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.aluminium_comments" name="aluminium_comments"\n                  ng-submit="updateAluminiumComments(aluminium_comments, status.delivery.aluminium_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Aluminium Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.aluminium_comments.data"\n                           name="aluminium_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n<!-- Finishing Section -->\n         <status-row title="Finishing Date" stage="status.delivery.finishing" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.finishing" name="finishing"\n                  ng-submit="updateFinishingDate(finishing, finishing_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Finishing Date</label>\n                    <input type="date" class="form-control" ng-model="finishing_date_control" name="finishing_date_id" id="finishing_date_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n            <form name="del_finishing" ng-submit="deleteFinishing(del_finishing,status.delivery.finishing.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n        </status-row>\n\n        <status-row title="Finishing Comments" stage="status.delivery.finishing_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.finishing_comments" name="finishing_comments"\n                  ng-submit="updateFinishingComments(finishing_comments, status.delivery.finishing_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Finishing Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.finishing_comments.data"\n                           name="finishing_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n<!-- Detailing Section -->\n        <status-row title="Detailing Canopy Date" stage="status.delivery.detailing_date" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.detailing_date" name="detailing_date"\n                  ng-submit="updateDetailingDate(detailing_date,detailing_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Detailing Canopy Date</label>\n                    <input type="date" class="form-control" ng-model="detailing_date_control" name="detailing_date_id" id="detailing_date_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n            <form name="del_detailing_date" ng-submit="deleteDetailingDate(del_detailing_date,status.delivery.detailing_date.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n        </status-row>\n\n        <status-row title="Detailing Canopy Comments" stage="status.delivery.detailing_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.detailing_comments" name="detailing_comments"\n                  ng-submit="updateDetalingComments(detailing_comments, status.delivery.detailing_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Detailing Canopy Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.detailing_comments.data"\n                           name="detailing_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n<!-- Water Testing Section -->\n        <status-row title="Water Testing Date" stage="status.delivery.watertest_date" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.watertest_date" name="watertest_date"\n                  ng-submit="updateWatertestDate(watertest_date, watertest_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Water Test Date</label>\n                    <input type="date" class="form-control" ng-model="watertest_date_control" name="watertest_date_id" id="watertest_date_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n            <form name="del_watertest_date" ng-submit="deleteWatertestDate(del_watertest_date,status.delivery.watertest_date.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n        </status-row>\n\n\n\n        <status-row title="Water Test Comments" stage="status.delivery.watertest_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.watertest_comments" name="watertest_comments"\n                  ng-submit="updateWatertestComments(watertest_comments, status.delivery.watertest_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> Water Test Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.watertest_comments.data"\n                           name="watertest_comments" ng-disabled="!status.delivery.qc_date_actual.permission"    />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n        \n<!-- Weights Section -->\n        <status-row title="Weights" stage="status.delivery.weights" permission="status.permissions.view_status_weights">\n            <div class="row" ng-if="status.delivery.weights.permission">\n                <div class="form-group">\n                    <div class="row">\n                        <div class="col-md-4"><label>TARE:</label> {{ status.delivery.weights.data.weight_tare }}{{ status.delivery.weights.data.weight_tare == null ? \'\' : \' kg\' }}</div>\n                        <div class="col-md-4"><label>ATM:</label> {{ status.delivery.weights.data.weight_atm }}{{ status.delivery.weights.data.weight_atm == null ? \'\' : \' kg\' }}</div>\n                        <div class="col-md-4"><label>TOW BALL:</label> {{ status.delivery.weights.data.weight_tow_ball }}{{ status.delivery.weights.data.weight_tow_ball == null ? \'\' : \' kg\' }}</div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-4"><label>WOB:</label> {{ status.delivery.weights.data.weight_tare - status.delivery.weights.data.weight_tow_ball }} kg</div>\n                        <div class="col-md-4"><label>GTM:</label> {{ status.delivery.weights.data.weight_atm - status.delivery.weights.data.weight_tow_ball }} kg</div>\n                        <div class="col-md-4"><label>TYRES:</label> {{ status.delivery.weights.data.weight_tyres }}</div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-4"><label>CHASSIS GTM:</label> {{ status.delivery.weights.data.weight_chassis_gtm }}{{ status.delivery.weights.data.weight_chassis_gtm == null ? \'\' : \' kg\' }}</div>\n                        <div class="col-md-4"><label>GAS COMP:</label> {{ status.delivery.weights.data.weight_gas_comp }}</div>\n                        <div class="col-md-4"><label>PAYLOAD:</label> {{ status.delivery.weights.data.weight_payload }}{{ status.delivery.weights.data.weight_payload == null ? \'\' : \' kg\' }}</div>\n                    </div>\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.weights.permission">\n                    <button type="button" class="btn btn-primary form-control" ng-click="openWeightsModal()">Set Weights</button>\n                </div>\n            </div>\n        </status-row>\n        <!-- planned QC -->\n        <!--     <status-row title="Planned QC Date" stage="status.delivery.qc_date_planned" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.qc_date_planned" name="qc_date_planned_form"\n                  ng-submit="updatePlannedQcDate(qc_date_planned_form, status.delivery.qc_date_planned.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Planned QC Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.qc_date_planned.data"\n                           name="qc_date_planned" ng-disabled="!status.delivery.qc_date_planned.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row>\n        -->\n        <!-- The below QC section is removed as per client instruction and merged with Final QC -->\n        <!-- <status-row title="QC Date" stage="status.delivery.qc_date_actual" permission="status.permissions.view_status_qc_date_actual">\n            <form ng-if="status.delivery.qc_date_actual" name="qc_date_actual_form"\n                  ng-submit="updateActualQcDate(qc_date_actual_form, status.delivery.qc_date_actual.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">QC Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.qc_date_actual.data"\n                           name="qc_date_actual" ng-disabled="!status.delivery.qc_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_actual.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n            <form name="del_qc_date_actual" ng-submit="deleteActualQC(del_qc_date_actual,status.delivery.qc_date_actual.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n        </status-row>\n\n        <status-row title=" QC Comments " stage="status.delivery.qc_comments" permission="status.permissions.view_status_qc_date_actual">\n            <form ng-if="status.delivery.qc_comments" name="qc_comments_form"\n                  ng-submit="updateQCComments(qc_comments_form, status.delivery.qc_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">  QC Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.qc_comments.data"\n                           name="qc_comments" ng-disabled="!status.delivery.qc_date_actual.permission"\n                             />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_actual.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row> -->\n\n     <!--    <status-row title="Planned Water Test  Date" stage="status.delivery.planned_watertest_date" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.planned_watertest_date" name="planned_watertest_date_form"\n                  ng-submit="updatePlannedWatertestDate(planned_watertest_date_form, status.delivery.planned_watertest_date.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Planned Water Test Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.planned_watertest_date.data"\n                           name="planned_watertest_date" ng-disabled="!status.delivery.qc_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row> -->\n    \n      <!--  <status-row title="Actual Water Test  Date" stage="status.delivery.actual_watertest_date" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.actual_watertest_date" name="actual_watertest_date_form"\n                  ng-submit="updateActualWatertestDate(actual_watertest_date_form, status.delivery.actual_watertest_date.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Actual Water Test Date</label>\n                    <input type="text" class="form-control" ng-model="status.delivery.actual_watertest_date.data"\n                           name="actual_watertest_date" ng-disabled="!status.delivery.qc_date_actual.permission"\n                           placeholder="dd/mm/yyyy" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title=" Water Test Comments " stage="status.delivery.watertest_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.watertest_comments" name="watertest_comments_form"\n                  ng-submit="updateWatertestComments(watertest_comments_form, status.delivery.watertest_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">  Water Testing Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.watertest_comments.data"\n                           name="watertest_comments" ng-disabled="!status.delivery.qc_date_actual.permission"\n                             />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_actual.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update </button>\n                </div>\n            </form>\n        </status-row>\n\n       -->\n\n         <status-row title="QC Date" stage="status.delivery.final_qc_date" permission="status.permissions.view_status_qc_date_actual">\n            <form ng-if="status.delivery.final_qc_date" name="final_qc_date_form"\n                  ng-submit="updateFinalQcDate(final_qc_date_form, final_qc_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label"> QC Date</label>\n                  <input type="date" class="form-control" ng-model="final_qc_date_control" name="final_qc_date_id" id="final_qc_date_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_actual.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n            <form name="del_final_qc_date" ng-submit="deleteFinalQC(del_final_qc_date,status.delivery.final_qc_date.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n            \n        </status-row>\n\n        <status-row title=" QC Comments " stage="status.delivery.final_qc_comments" permission="status.permissions.view_status_qc_date_actual">\n            <form ng-if="status.delivery.final_qc_comments" name="final_qc_comments_form"\n                  ng-submit="updateFinalQcComments(final_qc_comments_form, status.delivery.final_qc_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">   QC Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.final_qc_comments.data"\n                           name="final_qc_comments" ng-disabled="!status.delivery.final_qc_comments.permission"\n                             />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.final_qc_comments.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update  </button>\n                </div>\n            </form>\n        </status-row>\n\n        \n        <status-row title="Off-Line Date" stage="status.delivery.dispatch_date_planned" permission=" status.permissions.view_status_dispatch_date_planned">\n            <form ng-if="status.delivery.dispatch_date_planned" name="dispatch_date_planned_form"\n                  ng-submit="updatePlannedDispatchDate(dispatch_date_planned_form, dispatch_date_planned_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Off-Line Date</label>\n            <input type="date" class="form-control" ng-model="dispatch_date_planned_control" name="dispatch_date_planned_id" id="dispatch_date_planned_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.dispatch_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Collection Date" stage="status.delivery.collection_date" permission=" status.permissions.view_status_dispatch_date_planned">\n            <form ng-if="status.delivery.dispatch_date_planned" name="collection_date_planned_form"\n                  ng-submit="updateCollectionDate(collection_date_planned_form,collection_date_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Collection Date</label>\n            <input type="date" class="form-control" ng-model="collection_date_control" name="collection_date_id" id="collection_date_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.dispatch_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Collection Comments" stage="status.delivery.collection_comments" permission=" status.permissions.view_status_dispatch_date_planned">\n            <form ng-if="status.delivery.dispatch_date_planned" name="collection_comments_planned_form"\n                  ng-submit="updateCollectionComments(collection_comments_planned_form, status.delivery.collection_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Collection Date Comments</label>\n            <input type="text" class="form-control" ng-model="status.delivery.collection_comments.data"\n                           name="collection_comments" ng-disabled="!status.delivery.dispatch_date_planned.permission"\n                           placeholder="Enter Comments" />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.dispatch_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update</button>\n                </div>\n            </form>\n        </status-row>\n\n\n        <status-row title="Actual Dispatch Date" stage="status.delivery.dispatch_date_actual" permission=" status.permissions.view_status_dispatch_date_planned">\n            <form ng-if="status.delivery.dispatch_date_actual" name="dispatch_date_actual_form"\n                  ng-submit="updateActualDispatchDate(dispatch_date_actual_form, dispatch_date_actual_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Actual Dispatch Date</label>\n                    <input type="date" class="form-control" ng-model="dispatch_date_actual_control" name="dispatch_date_actual_id" id="dispatch_date_actual_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.dispatch_date_actual.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n\n            \n            <form name="del_dispatch_date_actual" ng-submit="deleteActualDispatchDate(del_dispatch_date_actual,status.delivery.dispatch_date_actual.data)">\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Delete</button>\n            </div>\n            </form>\n        </status-row>\n\n        <status-row title=" Dispatch Comments " stage="status.delivery.dispatch_comments" permission="status.permissions.view_status_qc_date_planned">\n            <form ng-if="status.delivery.dispatch_comments" name="dispatch_comments_form"\n                  ng-submit="updateDispatchComments(dispatch_comments_form, status.delivery.dispatch_comments.data)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">  Dispatch Comments </label>\n                    <input type="text" class="form-control" ng-model="status.delivery.dispatch_comments.data"\n                           name="dispatch_comments" ng-disabled="!status.delivery.dispatch_date_actual.permission"\n                             />\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.qc_date_planned.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Update  </button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Upload Driver Handover Form" stage="status.approval.handover_to_driver_form" permission="status.permissions.view_status_handover_to_driver_form">\n            <div class="row">\n                <form name="handover_to_driver_form"\n                      ng-submit="updateDoc(handover_to_driver_form, status.approval.handover_to_driver_form.file_upload, \'handover_to_driver_form\')">\n                    <div class="form-group col-md-4" ng-if="status.approval.handover_to_driver_form.permission">\n                        <label class="form-label">Handover Form</label>\n                        <label ng-if="status.approval.handover_to_driver_form.file_upload.name">\n                            Selected: {{ status.approval.handover_to_driver_form.file_upload.name }}\n                        </label>\n                        <button class="form-control btn btn-default" ngf-select\n                                ng-model="status.approval.handover_to_driver_form.file_upload"\n                                name="handover_to_driver" required>\n                            Select Form\n                        </button>\n                        <button type="submit" class="btn btn-primary form-control">Upload</button>\n                    </div>\n                    <div class="col-md-8" ng-if="status.approval.handover_to_driver_form">\n                        <label class="form-label">UPLOADED</label>\n                        <div ng-repeat="doc in status.approval.handover_to_driver_form.data">\n                            <b>{{ doc.file }}</b>\n                            <span ng-if="doc.file"><a target="_blank" href="{{ doc.url }}">View</a>&nbsp;<a  ng-if="status.approval.handover_to_driver_form.permission" href="" ng-click="deleteDoc(doc.id, \'handover_to_driver_form\')">Delete</a></span>\n                        </div>\n                    </div>\n                    <div class="col-md-8 col-md-offset-4" ng-if="status.approval.handover_to_driver_form && (status.approval.handover_to_driver_form.status != \'Complete\' || !status.approval.handover_to_driver_form.data[0].file)">\n                        <label>\n                            <input type="checkbox" ng-model="status.approval.handover_to_driver_form.data[0].is_separated" ng-change="updateSeparateDoc(status.approval.handover_to_driver_form.data[0], \'handover_to_driver_form\')"/>\n                            Handover form attached separately\n                        </label>\n                    </div>\n                </form>\n            </div>\n            <div class="row" ng-if="status.approval.handover_to_driver_form.status == \'Complete\'">\n                <div class="col-md-6" ng-if="status.approval.handover_to_driver_form">\n                    <label>Recorded in Salesforce:</label>\n                </div>\n                <div class="col-md-6">\n                    {{ status.approval.handover_to_driver_form.extra_data.salesforce_handover_recorded_at | date :AppSettings.FORMAT_DATETIME_JS }}\n                </div>\n            </div>\n        </status-row>\n\n        <status-row title="Van Received at Dealership" stage="status.delivery.received_date_dealership" permission="status.permissions.view_status_received_date_dealership">\n            <form ng-if="status.delivery.received_date_dealership" name="received_date_dealership_form"\n                  ng-submit="updateDealershipReceivedDate(received_date_dealership_form, received_date_dealership_control)">\n                <div class="form-group col-md-8">\n                    <label class="form-label">Van Received at Dealership</label>\n                    <input type="date" class="form-control" ng-model="received_date_dealership_control" name="received_date_dealership_id" id="received_date_dealership_id" >\n                </div>\n                <div class="col-md-4" ng-if="status.delivery.received_date_dealership.permission">\n                    <label class="form-label">&nbsp;</label>\n                    <button type="submit" class="btn btn-primary form-control">Set Date</button>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Upload Driver Handover To Dealership Form" stage="status.approval.handover_to_dealership_form" permission="status.permissions.view_status_handover_to_dealership_form">\n            <form name="handover_to_dealership_form"\n                  ng-submit="updateDoc(handover_to_dealership_form, status.approval.handover_to_dealership_form.file_upload, \'handover_to_dealership_form\')">\n                <div class="form-group col-md-4" ng-if="status.approval.handover_to_dealership_form.permission">\n                    <label class="form-label">Handover Form</label>\n                    <label ng-if="status.approval.handover_to_dealership_form.file_upload.name">\n                        Selected: {{ status.approval.handover_to_dealership_form.file_upload.name }}\n                    </label>\n                    <button class="form-control btn btn-default" ngf-select\n                            ng-model="status.approval.handover_to_dealership_form.file_upload"\n                            name="handover_to_dealership" required>\n                        Select Form\n                    </button>\n                    <button type="submit" class="btn btn-primary form-control">Upload</button>\n                </div>\n                <div class="col-md-8" ng-if="status.approval.handover_to_dealership_form">\n                    <label class="form-label">UPLOADED</label>\n                    <div ng-repeat="doc in status.approval.handover_to_dealership_form.data">\n                        <b>{{ doc.file }}</b>\n                        <span ng-if="doc.file"><a target="_blank" href="{{ doc.url }}">View</a>&nbsp;<a  ng-if="status.approval.handover_to_dealership_form.permission" href="" ng-click="deleteDoc(doc.id, \'handover_to_dealership_form\')">Delete</a></span>\n                    </div>\n                </div>\n                <div class="col-md-8 col-md-offset-4" ng-if="status.approval.handover_to_dealership_form && (status.approval.handover_to_dealership_form.status != \'Complete\' || !status.approval.handover_to_dealership_form.data[0].file)">\n                    <label>\n                        <input type="checkbox" ng-model="status.approval.handover_to_dealership_form.data[0].is_separated" ng-change="updateSeparateDoc(status.approval.handover_to_dealership_form.data[0], \'handover_to_dealership_form\')"/>\n                        Handover form attached separately\n                    </label>\n                </div>\n            </form>\n        </status-row>\n\n        <status-row title="Customer Delivery Date" stage="status.delivery.delivery_date_customer" permission="status.permissions.view_status_delivery_date_customer">\n            <div class="row">\n                <form ng-if="status.delivery.delivery_date_customer" name="delivery_date_customer_form"\n                      ng-submit="updateCustomerDeliveryDate(delivery_date_customer_form, delivery_date_customer_control)">\n                    <div class="form-group col-md-8">\n                       \n                        <label class="form-label">Customer Delivery Date</label>\n\n                <input type="date" class="form-control" ng-model="delivery_date_customer_control" name="delivery_date_customer_id" id="delivery_date_customer_id" ng-disabled="!status.delivery.delivery_date_customer.permission">\n\n\n                    </div>\n                    <div class="col-md-4" ng-if="status.delivery.delivery_date_customer.permission" >\n                        <label class="form-label">&nbsp;</label>\n                        <button type="submit" class="btn btn-primary form-control">Set Date\n                        </button>\n                    </div>\n                </form>\n\n            </div>\n            <div class="row" ng-if="status.delivery.delivery_date_customer.status == \'Complete\'">\n                <div class="col-md-6">\n                    <label>Recorded in Salesforce:</label>\n                </div>\n                <div class="col-md-6">\n                    {{ status.delivery.delivery_date_customer.data.salesforce_delivery_recorded_at | date :AppSettings.FORMAT_DATETIME_JS }}\n                </div>\n            </div>\n        </status-row>\n    </div>\n\n    <h3 class="top-margin-40">Order History</h3>\n\n    <div class="row top-margin-20" ng-if="status.history.permission">\n        <form name="order_history_note_form" ng-submit="updateHistory(order_history_note_form, history)">\n            <div class="form-group col-md-6">\n                <label class="form-label">Manually add notes and/or relevant files for this order</label>\n                <textarea class="form-control" ng-model="history.note" name="history_note"></textarea>\n            </div>\n            <div class="form-group col-md-4">\n                <label class="form-label"></label>\n                <label ng-if="history.file_upload">\n                    Selected: {{ history.file_upload.name }}\n                </label>\n                <button class="form-control btn btn-default" ngf-select\n                        ng-model="history.file_upload"\n                        name="contract">\n                    Select File\n                </button>\n            </div>\n            <div class="col-md-2"> <!-- ng-if="status.history.add.permission" -->\n                <label class="form-label">&nbsp;</label>\n                <button type="submit" class="btn btn-primary form-control">Submit</button>\n            </div>\n        </form>\n    </div>\n\n    <div class="history-container">\n        <div class="row header-top top-margin-40">\n            <div class="col-sm-3">Date & Time</div>\n            <div class="col-sm-3">User</div>\n            <div class="col-sm-3">Action</div>\n            <div class="col-sm-3">Action Details</div>\n\n        </div>\n\n        <div class="row" ng-repeat="history in status_history" permission="status.permissions.view_status_qc_date_actual" >\n            <div class="col-sm-3">{{ history.update_on | date :AppSettings.FORMAT_DATETIME_JS}}</div>\n            <div class="col-sm-3">{{ history.update_by }}</div>\n            <div class="col-sm-3">{{ history.action}}</div>\n\n<!--            <div class="col-sm-2" ng-if="history.action ==\'Customer Changed\'">-->\n<!--              {{order.order_converted}}-->\n<!--            </div>-->\n<!--            <div class="col-sm-2" ng-if="history.action !=\'Customer Changed\'">-->\n<!--              &#45;&#45;-->\n<!--            </div>-->\n\n\n\n\n\n\n            <div class="col-sm-3"><div ng-repeat="note in history.notes" ng-bind-html="note">\n\n            </div>\n              <div ng-if="history.action ==\'Customer Changed\'">\n                sales date :{{order.order_converted}}\n              </div>\n            </div>\n\n\n        </div>\n    </div>\n\n\n    <div id="update_customer_manager" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Change Customer Manager</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <div>\n                        <label>Select new Customer Manager:</label>\n                        <select ng-options="u.id as u.title for u in customer_manager_list" ng-model="new_customer_manager_id"></select>\n                    </div>\n                    <button class="btn btn-primary" data-dismiss="modal" ng-click="updateCustomerManager()">Update</button>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n\n    <div id="update_sales_rep" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Change Sales Representative</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <div>\n                        <label>Select new Sales Representative:</label>\n                        <select ng-options="u.id as u.title for u in sales_rep_list" ng-model="new_sales_rep_id"></select>\n                    </div>\n                    <button class="btn btn-primary" data-dismiss="modal" ng-click="updateSalesRep()">Update</button>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="customer_plan_reject_reason" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Rejection reason</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <textarea rows="10" cols="65" placeholder="Enter here the reason why the customer plan is being rejected..."\n                              class="form-control"\n                              ng-model="customer_plan_reject_reason"></textarea>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="processRejectCustomerPlan()">Reject</button>\n                    &nbsp;\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="order_finalization_cancel_reason" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Cancellation reason</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <textarea rows="10" cols="65" placeholder="Enter here the reason why the order finalisation is cancelled..."\n                              class="form-control"\n                              ng-model="order_finalization_cancel_reason"></textarea>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="processCancelFinalization()" ng-disabled="!order_finalization_cancel_reason">Cancel Order Lock</button>\n                    &nbsp;\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="delivery_weights" class="modal fade">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Weights</h3>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                    </button>\n                </div>\n\n                <form name="save_weight_form" ng-submit="saveWeights()">\n                    <div class="modal-body">\n                        <div class="row">\n                            <div class="col-md-4">\n                                TARE:<br>\n                                <input class="form-control" type="number" name="weight_tare" ng-model="status.delivery.new_weights.data.weight_tare" ng-min="0" /> kg\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tare.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tare.$error.number">Must be a number</span>\n                            </div>\n                            <div class="col-md-4">\n                                ATM:<br>\n                                <input class="form-control" type="number" name="weight_atm" ng-model="status.delivery.new_weights.data.weight_atm" ng-min="0" /> kg\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_atm.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_atm.$error.number">Must be a number</span>\n                            </div>\n                            <div class="col-md-4">\n                                TOW BALL:<br>\n                                <input class="form-control" type="number" name="weight_tow_ball" ng-model="status.delivery.new_weights.data.weight_tow_ball" ng-min="0" /> kg\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tow_ball.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tow_ball.$error.number">Must be a number</span>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="col-md-4">WOB:<br> {{ status.delivery.new_weights.data.weight_tare - status.delivery.new_weights.data.weight_tow_ball }}  kg</div>\n                            <div class="col-md-4">GTM:<br> {{ status.delivery.new_weights.data.weight_atm - status.delivery.new_weights.data.weight_tow_ball }} kg</div>\n                            <div class="col-md-4">\n                                TYRES:<br>\n                                <input class="form-control" type="text" name="weight_tyres" ng-model="status.delivery.new_weights.data.weight_tyres" ng-min="0" />\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tyres.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_tyres.$error.number">Must be a number</span>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="col-md-4">\n                                CHASSIS GTM:<br>\n                                <input class="form-control" type="number" name="weight_chassis_gtm" ng-model="status.delivery.new_weights.data.weight_chassis_gtm" ng-min="0" /> kg\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_chassis_gtm.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_chassis_gtm.$error.number">Must be a number</span>\n                            </div>\n                            <div class="col-md-4">\n                                GAS COMP:<br>\n                                <input class="form-control" type="number" name="weight_gas_comp" ng-model="status.delivery.new_weights.data.weight_gas_comp" ng-pattern="/^\\d{8}$/" />\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_gas_comp.$error.pattern">Must be 8 digits</span>\n                            </div>\n                            <div class="col-md-4">\n                                PAYLOAD:<br>\n                                <input class="form-control" type="number" name="weight_payload" ng-model="status.delivery.new_weights.data.weight_payload" ng-min="0" /> kg\n                                <br>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_payload.$error.min">Must be positive</span>\n                                <span class="alert-danger" ng-show="save_weight_form.weight_payload.$error.number">Must be a number</span>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="modal-footer">\n                        <button type="submit" class="btn btn-default" ng-disabled="!save_weight_form.$valid">Save Weights</button>\n                        &nbsp;\n                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    </div>\n</div>';
},function(e,t){e.exports='<form name="weightsize_form" novalidate class="form">\n    <div class="row top-margin-40">\n        <div class="col-sm-10 col-sm-offset-1">\n            <h2>Avg Measurements -- Estimates Only</h2>\n            <h5>The measurements displayed below are representing the STOCK version of this product and are not specific to the order (with all of the added options).</h5>\t\n            <div class="row">\n                <div class="col-sm-2 th">\n                    Travel Length : \n                </div>\n                <div class="col-sm-2 th">\n                    Max External Travel Height: \n                </div>\n                <div class="col-sm-2 th">\n                    Max Internal Living Height: \n                </div>\n                <div class="col-sm-2 th">\n                    Max Travel Width:\n                </div>\n                <div class="col-sm-2 th">\n                    Avg. Tare weight:\n                     \n                </div>\n                <div class="col-sm-2 th">\n                    Avg. Tow Ball weight:\n                    \n                </div>\n            </div>\n            <div class="row">\n                <div class="col-sm-2">\n                    {{ info.series_detail.length_aframe }} mm\n                </div>\n                <div class="col-sm-2">\n                    {{ info.series_detail.length_bumper }} mm\n                </div>\n                \n                <div class="col-sm-2">\n                    {{ info.series_detail.height_ac }} mm\n                </div>\n                <div class="col-sm-2">\n                    {{ info.series_detail.width_awning }} mm\n                </div>\n                <div class="col-sm-2">\n                     {{ info.series_detail.avg_tare_weight }} kg\n                </div>\n                <div class="col-sm-2">\n                    {{ info.series_detail.avg_ball_weight }} kg\n                </div>\n            </div>\n\n        <div class="row top-margin-40">\n                <div class="col-sm-3">\n                    <button class="btn btn-primary form-control" type="submit" ng-click="proceed(weightsize_form)" ng-if="order.isEditable()">Save and proceed\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n</form>'}]);